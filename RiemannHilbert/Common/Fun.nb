(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    324689,       9341]
NotebookOptionsPosition[    317507,       9090]
NotebookOutlinePosition[    317917,       9108]
CellTagsIndexPosition[    317874,       9105]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
\[Copyright] Sheehan Olver, 2010, subject to BSD license.\
\>", "Text",
 CellChangeTimes->{{3.484041900204331*^9, 3.484041953655856*^9}}],

Cell[CellGroupData[{

Cell["Package setup", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", "$CommonPackage", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4842066990990553`*^9, 3.4842067064172373`*^9}, {
   3.4842068918461*^9, 3.484206896898924*^9}, {3.484206938940242*^9, 
   3.484206948456107*^9}, {3.484207013735791*^9, 3.484207016525519*^9}, {
   3.484207083174301*^9, 3.484207128384593*^9}, {3.484207260357958*^9, 
   3.4842072638205643`*^9}, {3.484207440220334*^9, 3.48420750006673*^9}, {
   3.484207538616802*^9, 3.484207567247468*^9}, {3.484207601318513*^9, 
   3.484207627086529*^9}, {3.484209203311123*^9, 3.484209260028742*^9}, {
   3.4842093828821173`*^9, 3.484209393550514*^9}, {3.484210016775586*^9, 
   3.4842100183487167`*^9}, {3.484210217236568*^9, 3.484210231348795*^9}, {
   3.4842148069013968`*^9, 3.484214823147004*^9}, {3.484214967589952*^9, 
   3.484214967903604*^9}, {3.484215071295384*^9, 3.4842151001027107`*^9}, {
   3.484215287915853*^9, 3.4842152959568787`*^9}, 3.4842237795571833`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Documentation", "Section",
 CellChangeTimes->{{3.483861021528007*^9, 3.483861023591382*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Fun", "::", "usage"}], "=", 
     "\"\<\nDecides between IFun and LFun, and allows Line[{a,b,c}]\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IFun", "::", "usage"}], "=", "\"\<IFun[\!\(\*
StyleBox[\"f\",
FontSlant->\"Italic\"]\),d,n] constructs an \!\(\*
StyleBox[\"n\",
FontSlant->\"Italic\"]\)-th order Chebyshev approximation of \!\(\*
StyleBox[\"f\",
FontSlant->\"Italic\"]\) over the domain d, which is either a Line or Arc\!\(\*
StyleBox[\".\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)IFun\!\(\*
StyleBox[\"[\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"f\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)d\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)chooses n adaptively. \!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)IFun\!\(\*
StyleBox[\"[\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"f\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)d\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)InterpolationPrecision\[Rule]tol] chooses n \
adaptively, so that the last two Chebyshev coefficients are less than tol. If \
f is a constructed IFun, then f[x] evaluates the approximation at the point \
x. Operations that can be applied to an IFun include standard mathematical \
functions (Abs, Sin, Exp, etc.) and operators Integrate (returning the \
indefinite integral) and Derivative[k].\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "IFun", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"InterpolationPrecision", "\[Rule]", "$MachineTolerance"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LFun", "::", "usage"}], "=", "\"\<LFun[\!\(\*
StyleBox[\"f\",
FontSlant->\"Italic\"]\),d,n] constructs an \!\(\*
StyleBox[\"n\",
FontSlant->\"Italic\"]\)-th order Laurent approximation of \!\(\*
StyleBox[\"f\",
FontSlant->\"Italic\"]\) over the domain d, which is either a Circle or the \
real line Line[{-\[Infinity],\[Infinity]}]\!\(\*
StyleBox[\".\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"  \",
FontSlant->\"Italic\"]\)If f is a constructed LFun, then\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"f\",
FontSlant->\"Italic\"]\)[x] evaluates the approximation at the point x. \
Operations that can be applied to an LFun include standard mathematical \
functions (Abs,Sin,Exp,etc.) and operators Integrate (returning the \
indefinite integral) and Derivative[k].\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "LFun", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"InterpolationPrecision", "\[Rule]", "$MachineTolerance"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DomainPlot", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<DomainPlot[ifun] plots the domain of ifun. DomainPlot[list] plots \
the union of the domains of a list of IFuns\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "DomainPlot", "]"}], "=", 
     RowBox[{"Options", "[", "Graphics", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Arc", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Arc[z0,r,{t0,t1}] represents the arc centred at z0 of radius r from \
argument t0 to t1.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Ellipse", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Ellipse[{a_,b_},r] represents the Bernstein ellipse arond the \
interval (a,b).\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DomainIntegrate", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<DomainIntegrate[ifun] returns the definite integral of the function \
ifun over its domain.\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DCT", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<DCT[ifun] returns the Chebyshev coefficients of an IFun.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReduceDimension", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Reduces the length of an IFun by one.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReduceDimensionIntegrate", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<ReduceDimensionIntegrate[ifun] returns the \
ReduceDimension[Integrate[ifun]].\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LaurentCoefficients", "::", "usage"}], "=", 
     "\"\<Gives the Laurent coefficients of an LFun over a circle.\>\""}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Domain", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Domain[ifun] returns the domain of an IFun.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Values", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Values[ifun] returns the values of an IFun at Points[ifun].\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Points", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Points[ifun] returns the the mapped Chebyshev\[Dash]Lobatto points. \
 Points[d,n] returns n mapped Chebyshev\[Dash]Lobatto points over a domain d.\
\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeftEndpoint", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<LeftEndpoint[d] returns the left endpoint of the domain d. If d is \
an IFun, then it is equivalent to LeftEndpoint[Domain[d]].\>\""}], " ", ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightEndpoint", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<RightEndpoint[d] returns the right endpoint of the domain d. If d \
is an IFun, then it is equivalent to RightEndpoint[Domain[d]].\>\""}], " ", 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Stretch", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Stretch is a possible parameter for Line used in determining the \
conformal map.\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Centre", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Centre is a possible parameter for Line used in determining the \
conformal map.\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MapToInterval", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<MapToInterval[d,x] maps the point x via the conformal map that maps \
the domain d to the unit interval. If d is an IFun, then it is equivalent to \
MapToInterval[Domain[d],x].\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MapToIntervalD", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<MapToIntervalD[d,x] is the derivative of MapToInterval[d,x].\>\""}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MapFromInterval", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<MapFromInterval[d,x] maps the point x via the conformal map that \
maps the unit interval to the domain d. If d is an IFun, then it is \
equivalent to MapFromInterval[Domain[d],x].\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MapFromIntervalD", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<MapFromIntervalD[d,x] is the derivative of \
MapFromInterval[d,x].\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ComplexMapToCircle", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<MapToInterval[d,x] maps the point x via the conformal map that maps \
the domain d to the unit interval. If d is an IFun, then it is equivalent to \
MapToInterval[Domain[d],x].\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ComplexMapToInterval", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<MapToInterval[d,x] maps the point x via the conformal map that maps \
the domain d to the unit interval. If d is an IFun, then it is equivalent to \
MapToInterval[Domain[d],x].\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ComplexMapToIntervalD", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<MapToIntervalD[d,x] is the derivative of MapToInterval[d,x].\>\""}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ComplexMapFromInterval", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<MapFromInterval[d,x] maps the point x via the conformal map that \
maps the unit interval to the domain d. If d is an IFun, then it is \
equivalent to MapFromInterval[Domain[d],x].\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ComplexMapFromIntervalD", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<MapFromIntervalD[d,x] is the derivative of \
MapFromInterval[d,x].\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"UnitInterval", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<The unit interval Line[{-1.,1.}].\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"UnitCircle", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<The unit circle Circle[0.,1.].\>\""}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToUnitInterval", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<ToUnitInterval[ifun] maps ifun to an IFun defined over the unit \
interval.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToUnitCircle", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<ToUnitCircle[lfun] maps lfun to an LFun defined over the unit \
circle.\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DomainQ", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Test whether something is a domain (Line, Arc or Circle).\>\""}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BoundedDomainQ", "::", "usage"}], "=", 
     "\"\<Test whether a domain is bounded.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroAtInfinityFun", "::", "usage"}], "=", 
     "\"\<Constructs a Fun with the default value of zero at infinity\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IdentityAtInfinityFun", "::", "usage"}], "=", 
     "\"\<Constructs a Fun with the default value of the identity matrix at \
infinity\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroAtInfinityIFun", "::", "usage"}], "=", 
     "\"\<Constructs a Fun with the default value of zero at infinity\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IdentityAtInfinityIFun", "::", "usage"}], "=", 
     "\"\<Constructs a Fun with the default value of the identity matrix at \
infinity\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroAtInfinityLFun", "::", "usage"}], "=", 
     "\"\<Constructs a LFun with the default value of zero at infinity\>\""}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FunListDot", "::", "usage"}], "=", 
     "\"\<FunListDot[{f1,f2,...,fn},{g1,g2,...,gn}] returns \
{f1.g1,f2.g2,...,fn.gn}\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DCTPlot", "::", "usage"}], "=", 
     "\"\<LogPlots the norm of the Chebyshev coefficients of an IFun\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FFTPlot", "::", "usage"}], "=", 
     "\"\<LogPlots the norm of the Fourier coefficients of an LFun\>\""}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ComplexRoots", "::", "usage"}], "=", 
     "\"\<Returns all roots\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Curve", "::", "usage"}], "=", 
     "\"\<Turns an IFun into a domain\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SelectWithPoint", "::", "usage"}], "=", 
     "\"\<Select from a list of Funs the Fun which contains a point\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Endpoints", "::", "usage"}], "=", 
     "\"\<Returns all endpoints of a list of funs\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FiniteEndpoints", "::", "usage"}], "=", 
     "\"\<Returns all finite endpoints of a list of funs\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LegendreTransform", "::", "usage"}], "=", 
     "\"\<Computes Legendre Coefficients\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EvaluateMatrix", "::", "usage"}], "=", 
     "\"\<Matrix for evaluating at a point\>\""}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQA2IQfWNZEcuHLy8d/Yr32oJoxkO6ziB6lu0PFxAdZl33
9xOQrrl8w/MzkL4n9DMARKcEzAoG0cqnMuNB9ILoBVUgeoqoXeesr0B9kie7
QHTC3HN+c4C0FM+xABDtUcGUdAZINzEvSgHRZ7SeCp4F0hfqBMVB9JR9Yr4g
+oB4rT+IlpqlOufA95eOIccvzAPRhksfX8j6BXTv9l+XQPT9B6dbbv5+6cjD
GtoOosP+XXN4DKTZ+B6B6U1rK2TT/7x0XChgowSi95yLNqhhe+VoUb7SEET/
io9wtuB45RiZHewCot+vfny7E0gXLOW9C6J9Db7Mmgmk+TKWzAPRxbpm+2YB
6ZdzloDprJynpzdyvnJczhJ1DkRXWGq82QWkX89qfwuiQxh9Hu0B0laC6x6D
6Ki/N403cr1yvBB6wQREW2WFyG/jfuWo1e2lAKJNnpetk+B75XipePEWEP0m
12+vJJCWqpu9H0RbSUx2KwXSTGfa3EG01KptD7T4Xzn2nAx4CKL1jl6d0QKk
1a5HzQLRACO+/6I=
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["General", "Section",
 CellChangeTimes->{{3.483352377593004*^9, 3.483352378751315*^9}}],

Cell[BoxData[{
 RowBox[{"NotListOrPatternQ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"NotListOrPatternOrFunQ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ConstantQ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"HalfFirst", ";"}], "\[IndentingNewLine]", 
 RowBox[{"DoubleFirst", ";"}], "\[IndentingNewLine]", 
 RowBox[{"HalfFirstAndLast", ";"}], "\[IndentingNewLine]", 
 RowBox[{"DoubleFirstAndLast", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToChebyshevUSeries", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToChebyshevTSeries", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotListOrPatternQ", "[", "f_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"!", 
      RowBox[{"ListQ", "[", "f", "]"}]}], ")"}], "&&", 
    RowBox[{"!", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Head", "[", "f", "]"}], "===", "Pattern"}], ")"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Head", "[", "f", "]"}], "===", "Blank"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotListOrPatternOrFunQ", "[", "f_", "]"}], ":=", 
   RowBox[{
    RowBox[{"NotListOrPatternQ", "[", "f", "]"}], "&&", 
    RowBox[{"!", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Head", "[", "f", "]"}], "===", "IFun"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConstantQ", "[", "f_", "]"}], ":=", 
    RowBox[{
     RowBox[{"f", "//", "N"}], "//", "NumberQ"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HalfFirst", "[", 
    RowBox[{"{", 
     RowBox[{"m1_", ",", "m___"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m1", "/", "2"}], ",", "m"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DoubleFirst", "[", 
    RowBox[{"{", 
     RowBox[{"m1_", ",", "m___"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "m1"}], ",", "m"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HalfFirstAndLast", "[", 
    RowBox[{"{", 
     RowBox[{"m1_", ",", "m___", ",", "m2_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m1", "/", "2"}], ",", "m", ",", 
     RowBox[{"m2", "/", "2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DoubleFirstAndLast", "[", 
    RowBox[{"{", 
     RowBox[{"m1_", ",", "m___", ",", "m2_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m1", " ", "2"}], ",", "m", ",", 
     RowBox[{"m2", " ", "2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToChebyshevUSeries", "[", 
    RowBox[{"ts", ":", 
     RowBox[{"{", "_", "}"}]}], "]"}], ":=", "ts"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToChebyshevUSeries", "[", "ts_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"DoubleFirst", "[", "ts", "]"}], "/", " ", "2"}], "-", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ts", "//", "Rest"}], "//", "Rest"}], ")"}], "/", " ", "2"}],
       ",", 
      RowBox[{"Length", "[", "ts", "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToChebyshevTSeries", "[", 
    RowBox[{"us", ":", 
     RowBox[{"{", "_", "}"}]}], "]"}], ":=", "us"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToChebyshevTSeries", "[", 
    RowBox[{"us", ":", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ".", "us"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToChebyshevTSeries", "[", "us_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ds", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ds", "=", 
       RowBox[{"ZeroVector", "[", 
        RowBox[{"Length", "[", "us", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ds", "\[LeftDoubleBracket]", 
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
       RowBox[{"2", " ", 
        RowBox[{"us", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ds", "\[LeftDoubleBracket]", 
        RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], "=", 
       RowBox[{"2", " ", 
        RowBox[{"us", "\[LeftDoubleBracket]", 
         RowBox[{"-", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "ds", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{
            "us", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
           "+", 
           RowBox[{"ds", "\[LeftDoubleBracket]", 
            RowBox[{"k", "+", "2"}], "\[RightDoubleBracket]"}]}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "3"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Length", "[", "us", "]"}]}], "+", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ds", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "=", 
       RowBox[{
        RowBox[{"us", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "+", 
        RowBox[{
         RowBox[{"ds", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
          "/", "2"}]}]}], ";", "\[IndentingNewLine]", "ds"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483352394907866*^9, 3.483352395779393*^9}, {
  3.483357434362524*^9, 3.4833574422870207`*^9}, {3.483357568037533*^9, 
  3.4833575700741243`*^9}, {3.483422204954905*^9, 3.483422211876823*^9}, {
  3.483424269072785*^9, 3.4834242704950457`*^9}, {3.483767811801839*^9, 
  3.483767812313388*^9}, {3.483767899999218*^9, 3.483767902288438*^9}, {
  3.483885314617345*^9, 3.483885315572406*^9}, {3.4838853653698597`*^9, 
  3.483885365722148*^9}, {3.484210264210148*^9, 3.484210268660849*^9}, {
  3.4842128360177803`*^9, 3.484212931337041*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["FFT", "Section",
 CellChangeTimes->{{3.441357071539606*^9, 3.441357071818021*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LeftEvenPoints", "::", "usage"}], "=", 
   "\"\<Evenly spaced points on the unit interval.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NLeftEvenPoints", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FFT", "::", "usage"}], "=", "\[IndentingNewLine]", 
   "\"\<Returns a ShiftList of Laurent coefficients of a LFun or its value \
list.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InverseFFT", "::", "usage"}], "=", "\[IndentingNewLine]", 
    "\"\<Returns values that a ShiftList of Laurent coefficients would take \
on the unit circle.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftEvenPoints", "[", "n_", "]"}], ":=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}], "/", "n"}], ",", 
     RowBox[{"2", "/", "n"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftEvenPoints", "[", 
    RowBox[{"n_", ",", "a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"a", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", "-", "a"}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", " ", 
        RowBox[{"LeftEvenPoints", "[", "n", "]"}]}], ")"}], "/", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NLeftEvenPoints", "[", "v__", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{"LeftEvenPoints", "[", "v", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FFT", "[", 
    RowBox[{"f", ":", 
     RowBox[{"{", 
      RowBox[{"__", "?", "ScalarQ"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "cc", ",", "n", ",", "scale", ",", "k"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"scale", "=", 
       RowBox[{"First", "[", 
        RowBox[{"Fourier", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "&"}], ")"}], "/@", 
          RowBox[{"LeftEvenPoints", "[", "n", "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cc", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"-", 
          RowBox[{"Reverse", "[", 
           RowBox[{"AlternatingVector", "[", "n", "]"}], "]"}]}], "scale"], 
        RowBox[{"(", 
         RowBox[{"f", "//", "Fourier"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "[", "0", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", "n"}], " ", 
        RowBox[{
        "cc", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "[", "k_", "]"}], "/;", 
        RowBox[{"k", "<", "0"}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", "n"}], " ", 
        RowBox[{"cc", "\[LeftDoubleBracket]", 
         RowBox[{"1", "-", "k"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "[", "k_", "]"}], "/;", 
        RowBox[{"k", ">", "0"}]}], ":=", 
       RowBox[{"cc", "\[LeftDoubleBracket]", 
        RowBox[{"-", "k"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "n", "]"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"ShiftList", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"c", "[", "k", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{
               RowBox[{"-", "n"}], "/", "2"}], ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"c", "[", "k", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", 
              RowBox[{
               RowBox[{"n", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], "]"}],
         ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"ShiftList", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"c", "[", "k", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"n", "-", "1"}], ")"}]}], "/", "2"}], ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"c", "[", "k", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], "}"}]}], 
           "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InverseFFT", "[", 
     RowBox[{"c", ":", 
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"__", "?", "ScalarQ"}], "}"}], ",", "_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"scale", ",", "cc", ",", "cf", ",", "j", ",", "n"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"scale", "=", 
        RowBox[{"First", "[", 
         RowBox[{"Fourier", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "&"}], ")"}], "/@", 
           RowBox[{"LeftEvenPoints", "[", "n", "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Reverse", "[", 
           RowBox[{"AlternatingVector", "[", "n", "]"}], "]"}]}], "scale", 
         " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"EvenQ", "[", "n", "]"}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"RotateLeft", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"c", "//", "ToList"}], "//", "Reverse"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "2"}], ")"}], "/", "2"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"RotateLeft", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"ShiftList", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "n"}], " ", 
                   RowBox[{"OneVector", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], "]"}]}], ",", 
                  
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "n"}], "}"}], ",", 
                    RowBox[{"OneVector", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], "]"}]}], 
                   "]"}]}], "]"}], "c"}], "//", "ToList"}], "//", "Reverse"}],
              ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "//", 
        "InverseFourier"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FFT", "[", 
    RowBox[{"f", ":", 
     RowBox[{"{", 
      RowBox[{"__", "?", "ArrayQ"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"FFT", ",", 
      RowBox[{"ToArrayOfLists", "[", "f", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"-", "2"}], "}"}]}], "]"}], "//", "ToShiftListOfArrays"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InverseFFT", "[", 
    RowBox[{"sl", ":", 
     RowBox[{"ShiftList", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"__", "?", "ArrayQ"}], "}"}], ",", "_"}], "]"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ArrayMap", "[", 
     RowBox[{"InverseFFT", ",", 
      RowBox[{"ToArrayOfShiftLists", "[", "sl", "]"}]}], "]"}], "//", 
    "ToListOfArrays"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"End", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.435056241566793*^9, 3.435056350052891*^9}, {
   3.435056535623126*^9, 3.435056538113364*^9}, {3.435056573033658*^9, 
   3.435056582365445*^9}, {3.435057679171302*^9, 3.435057685421669*^9}, {
   3.44040578113349*^9, 3.4404057824408007`*^9}, {3.440412002917552*^9, 
   3.4404120034994907`*^9}, 3.440414105823352*^9, {3.441357076057954*^9, 
   3.441357132235038*^9}, {3.441357171922768*^9, 3.4413571783776217`*^9}, {
   3.441357279833214*^9, 3.441357360687614*^9}, {3.441357804658161*^9, 
   3.441357956247365*^9}, {3.441357999983923*^9, 3.4413580003714237`*^9}, {
   3.441358873655678*^9, 3.441358877273247*^9}, 3.441358907444021*^9, {
   3.4413653776262903`*^9, 3.441365400703656*^9}, {3.441366384770411*^9, 
   3.441366396131343*^9}, {3.4413664357481527`*^9, 3.441366438132869*^9}, {
   3.441366497255168*^9, 3.441366515000355*^9}, {3.441366618361785*^9, 
   3.441366705209648*^9}, {3.441367285937665*^9, 3.441367286330566*^9}, {
   3.4413725961611223`*^9, 3.4413725963438883`*^9}, {3.448131629306525*^9, 
   3.448131629612286*^9}, {3.4540553955417843`*^9, 3.4540554287824574`*^9}, {
   3.4833505162198772`*^9, 3.483350516664802*^9}, {3.484212941600482*^9, 
   3.4842130021894083`*^9}, {3.484213132818316*^9, 3.484213259550993*^9}, 
   3.486901570007874*^9, {3.486901652118548*^9, 3.486901698245307*^9}, {
   3.486902011594962*^9, 3.486902025580319*^9}, {3.486902464352783*^9, 
   3.4869025741779947`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["DCT", "Section",
 CellChangeTimes->{{3.483350433232121*^9, 3.483350433590794*^9}}],

Cell[BoxData[{
 RowBox[{"ChebyshevPoints", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ChebyshevLobattoPoints", ";"}], "\[IndentingNewLine]", 
 RowBox[{"NChebyshevPoints", ";"}], "\[IndentingNewLine]", 
 RowBox[{"NChebyshevLobattoPoints", ";"}], "\[IndentingNewLine]", 
 RowBox[{"InverseDCT", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"0", ",", 
     RowBox[{"a_:", "-", "1"}], ",", 
     RowBox[{"b_:", "1"}]}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"n_", ",", 
     RowBox[{"a_:", "-", "1"}], ",", 
     RowBox[{"b_:", "1"}]}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"b", "+", "a"}], "2"], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"b", "-", "a"}], "2"], 
     RowBox[{"Cos", "[", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Range", "[", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], " ", "-", "1"}], 
        RowBox[{"2", " ", "n"}]], "Pi"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChebyshevLobattoPoints", "[", 
    RowBox[{"n_", ",", 
     RowBox[{"a_:", "-", "1"}], ",", 
     RowBox[{"b_:", "1"}]}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"b", "+", "a"}], "2"], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"b", "-", "a"}], "2"], 
     RowBox[{"Cos", "[", 
      RowBox[{"Pi", " ", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "0", ",", 
          RowBox[{"-", "1"}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NChebyshevPoints", "[", "v__", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{"ChebyshevPoints", "[", "v", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NChebyshevLobattoPoints", "[", "v__", "]"}], ":=", 
    RowBox[{"N", "[", 
     RowBox[{"ChebyshevLobattoPoints", "[", "v", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DCT", "[", 
    RowBox[{"f", ":", 
     RowBox[{"{", 
      RowBox[{"__", "?", "ScalarQ"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"AlternatingVector", "[", 
     RowBox[{"Length", "[", "f", "]"}], "]"}], " ", 
    RowBox[{"HalfFirstAndLast", "[", 
     RowBox[{
      RowBox[{"FourierDCT", "[", 
       RowBox[{"f", ",", "1"}], "]"}], 
      RowBox[{"Sqrt", "[", 
       RowBox[{"2", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "f", "]"}], "-", "1"}], ")"}]}], "]"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InverseDCT", "[", 
    RowBox[{"f", ":", 
     RowBox[{"{", 
      RowBox[{"__", "?", "ScalarQ"}], "}"}]}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Length", "[", "f", "]"}], "-", "1"}], "2"], 
     RowBox[{"AlternatingVector", "[", 
      RowBox[{"Length", "[", "f", "]"}], "]"}], " ", 
     RowBox[{"DoubleFirstAndLast", "[", 
      RowBox[{"DCT", "[", 
       RowBox[{"DoubleFirstAndLast", "[", "f", "]"}], "]"}], "]"}]}], "//", 
    "Reverse"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DCT", "[", 
    RowBox[{"f", ":", 
     RowBox[{"{", 
      RowBox[{"__", "?", "VectorQ"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DCT", "/@", 
     RowBox[{"ToArrayOfLists", "[", "f", "]"}]}], "//", "ToListOfArrays"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DCT", "[", 
    RowBox[{"f", ":", 
     RowBox[{"{", 
      RowBox[{"__", "?", "MatrixQ"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MatrixMap", "[", 
     RowBox[{"DCT", ",", 
      RowBox[{"ToArrayOfLists", "[", "f", "]"}]}], "]"}], "//", 
    "ToListOfArrays"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InverseDCT", "[", 
    RowBox[{"f", ":", 
     RowBox[{"{", 
      RowBox[{"__", "?", "VectorQ"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"InverseDCT", "/@", 
     RowBox[{"ToArrayOfLists", "[", "f", "]"}]}], "//", "ToListOfArrays"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InverseDCT", "[", 
     RowBox[{"f", ":", 
      RowBox[{"{", 
       RowBox[{"__", "?", "MatrixQ"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"MatrixMap", "[", 
      RowBox[{"InverseDCT", ",", 
       RowBox[{"ToArrayOfLists", "[", "f", "]"}]}], "]"}], "//", 
     "ToListOfArrays"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChebyshevLobattoBarycentricInterpolation", "[", 
    RowBox[{"f_List", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w", ",", "j", ",", "p", ",", "k", ",", "n"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"k", "=", 
       RowBox[{"Length", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"NChebyshevLobattoPoints", "[", "k", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"w", "[", "1", "]"}], "=", 
       RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"w", "[", "j_", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"j", "+", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"w", "[", "k", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"k", "+", "1"}], ")"}]}], " ", 
        RowBox[{"1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"n", ",", 
          RowBox[{"N", "[", 
           RowBox[{"Chop", "[", 
            RowBox[{"x", ",", "$MachineEpsilon"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"f", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"n", ",", 
            RowBox[{"N", "[", 
             RowBox[{"Chop", "[", 
              RowBox[{"x", ",", "$MachineEpsilon"}], "]"}], "]"}]}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
         "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
        FractionBox[
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "k"], 
          RowBox[{
           RowBox[{
            RowBox[{"w", "[", "j", "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"x", "-", 
              RowBox[{
              "n", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
             ")"}]}], 
           RowBox[{
           "f", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "k"], 
          RowBox[{
           RowBox[{"w", "[", "j", "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"x", "-", 
             RowBox[{
             "n", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
            ")"}]}]}]]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483350464447597*^9, 3.483350508284875*^9}, {
  3.483350605527183*^9, 3.483350640671523*^9}, {3.4833507536227913`*^9, 
  3.483350754281556*^9}, {3.483417504674593*^9, 3.483417521050956*^9}, {
  3.4834175638845997`*^9, 3.483417577514761*^9}, {3.4837678964865007`*^9, 
  3.4837678988913813`*^9}, {3.484213004334585*^9, 3.4842130082610083`*^9}, {
  3.48421326160255*^9, 3.4842132977791567`*^9}, {3.486901322396015*^9, 
  3.486901506322155*^9}, {3.486901538353606*^9, 3.4869015391584377`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Maps", "Section",
 CellChangeTimes->{{3.450607604978359*^9, 3.45060760554779*^9}, {
  3.4506077194378567`*^9, 3.450607721159247*^9}, {3.483344899483354*^9, 
  3.4833449031305943`*^9}, {3.483350772075301*^9, 3.483350772824995*^9}}],

Cell[CellGroupData[{

Cell["Standard", "Subsection",
 CellChangeTimes->{{3.483350783145068*^9, 3.4833507840325537`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CircleToInterval", "::", "usage"}], "=", 
   "\"\<CircleToInterval[z] conformally maps the unit circle to the unit \
interval.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToTopCircle", "::", "usage"}], "=", 
   "\"\<IntervalToTopCircle[x] maps the unit interval to the top half of the \
circle.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToBottomCircle", "::", "usage"}], "=", 
   "\"\<IntervalToBottomCircle[x] maps the unit interval to the bottom half \
of the circle.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"IntervalToOuterCircle", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IntervalToInnerCircle", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IntervalToInnerCircleD", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IntervalToOuterCircleD", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IntervalToTopCircleD", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntervalToBottomCircleD", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"IntervalToRealLine", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RealLineToInterval", ";"}], "\[IndentingNewLine]", 
 RowBox[{"CircleToPeriodicInterval", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RealLineToPeriodicInterval", ";"}], "\[IndentingNewLine]", 
 RowBox[{"PeriodicIntervalToRealLine", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IntervalToPositivePeriodicInterval", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IntervalToNegativePeriodicInterval", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IntervalToHalfLine", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HalfLineToInterval", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InfinityInDomainQ", "::", "usage"}], "=", 
   "\"\<InfinityInDomainQ[d] tests if a domain is unbounded.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightEndpointInfinityQ", "::", "usage"}], "=", 
   "\"\<RightEndpointInfinityQ[d] tests if a domain's right endpoint is \
unbounded.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftEndpointInfinityQ", "::", "usage"}], "=", 
   "\"\<LeftEndpointInfinityQ[d] tests if a domain's left endpoint is \
unbounded.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReverseOrientation", "::", "usage"}], "=", 
    "\"\<ReverseOrientation[ifun] gives ifun with the orientation reversed.\>\
\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftContourArg", "::", "usage"}], "=", 
   "\"\<LeftContourArg[d] gives the angle in the complex plane of the left \
endpoint of a domain d.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightContourArg", "::", "usage"}], "=", 
    "\"\<RightContourArg[d] gives the angle in the complex plane of the right \
endpoint of a domain d.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DomainMemberQ", "::", "usage"}], "=", 
    "\"\<DomainMemberQ[d,z] tests whether z is numerically on the domain d.\>\
\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCircleFunQ", "::", "usage"}], "=", 
   "\"\<Tests whether an object is an LFun whose domain is the unit circle.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitIntervalFunQ", "::", "usage"}], "=", 
   "\"\<Tests whether an object is an IFun whose domain is the unit interval.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntervalFunQ", "::", "usage"}], "=", 
    "\"\<Tests whether an object is an IFun whose domain is an \
interval.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircle", "::", "usage"}], "=", 
   "\"\<MapToCircle[d,z] maps z via the conformal map from the domain d to \
the unit circle.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "::", "usage"}], "=", 
   "\"\<MapToCircle[d,z] maps z via the conformal map from the unit circle to \
the domain d.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircleD", "::", "usage"}], "=", 
   "\"\<MapToCircleD[d,z] is the derivative of MapToCircle[d,z].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapFromCircleD", "::", "usage"}], "=", 
    "\"\<MapFromCircleD[d,z] is the derivative of MapFromCircle[d,z].\>\""}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RealLine", "::", "usage"}], "=", 
   "\"\<The real line Line[{-\[Infinity],\[Infinity]}]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToIntervalSeriesAtInfinity", "::", "usage"}], "=", 
    "\"\<Gives the coefficient of the asymptotic series at \
\[Infinity].\>\""}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CircleToInterval", "[", "z_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"z", "+", 
      FractionBox["1", "z"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"IntervalToTopCircle", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToTopCircle", "[", "x_", "]"}], ":=", 
   RowBox[{"x", "+", 
    RowBox[{"I", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "-", "x"}], "]"}], 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"IntervalToBottomCircle", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToBottomCircle", "[", "x_", "]"}], ":=", 
   RowBox[{"x", "-", 
    RowBox[{"I", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "-", "x"}], "]"}], 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"IntervalToOuterCircle", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToOuterCircle", "[", "t_", "]"}], ":=", 
   RowBox[{"t", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"t", "-", "1"}], "]"}], 
     RowBox[{"Sqrt", "[", 
      RowBox[{"t", "+", "1"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"IntervalToInnerCircle", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToInnerCircle", "[", "t_", "]"}], ":=", 
   RowBox[{"t", "-", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"t", "-", "1"}], "]"}], 
     RowBox[{"Sqrt", "[", 
      RowBox[{"t", "+", "1"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntervalToInnerCircle", "[", 
     RowBox[{"t_", "?", "InfinityQ"}], "]"}], ":=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToInnerCircleD", "[", "x_", "]"}], ":=", 
   RowBox[{"1", "-", 
    FractionBox["x", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}]], " ", 
      SqrtBox[
       RowBox[{"1", "+", "x"}]]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToOuterCircleD", "[", "x_", "]"}], ":=", 
   RowBox[{"1", "+", 
    FractionBox["x", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}]], " ", 
      SqrtBox[
       RowBox[{"1", "+", "x"}]]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToTopCircleD", "[", "x_", "]"}], ":=", 
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "x"}], 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntervalToBottomCircleD", "[", "x_", "]"}], ":=", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "x"}], 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["x", "2"]}]]]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToRealLine", "[", "x_", "]"}], ":=", 
   FractionBox["x", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RealLineToInterval", "[", "u_", "]"}], ":=", 
   FractionBox["u", 
    SqrtBox[
     RowBox[{"1", "+", 
      SuperscriptBox["u", "2"]}]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CircleToPeriodicInterval", "[", "z_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{"Log", "[", "z", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RealLineToPeriodicInterval", "[", "x_", "]"}], ":=", 
   RowBox[{"CircleToPeriodicInterval", "[", 
    RowBox[{"RealLineToCircle", "[", "x", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PeriodicIntervalToRealLine", "[", "t_", "]"}], ":=", 
   RowBox[{"CircleToRealLine", "[", 
    RowBox[{"Exp", "[", 
     RowBox[{"I", " ", "t"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToPositivePeriodicInterval", "[", "x_", "]"}], ":=", 
   RowBox[{"ArcCos", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToNegativePeriodicInterval", "[", "x_", "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"ArcCos", "[", "x", "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0G8s1HEAx/Hf5C6Js4Zl7SZSTWxpmfWgLr5pbWqL0rAymWaFwo6OB5ez
HGb98b8/XDQVYc3151pdG5OTS46WJcW07o58lXK5uxCn7+f34LPX0/c+/ilZ
x1OdOI4LYYPNe9y5Ig0lk4EWIfzoOeoKp3MneS9H5gZBzrw5GBqLU6i5i5Kj
ddG/oHSmdR7WaH/wFmxY7A7qoaRdHdkHl1PvGKCjPe0D9BEOVhUyn8wtqqD5
rKBlXEdJRGKwBooN2/7G91KyU9DDJTAPHul1hm1x+R7Q3//CvIz5Xu5mg4Wq
my55zFz1Xne4KvH1gvs6fbyha6vvJihXVPjCxkem6AJm/+zSMVhSZMhSvqHE
rgvIhoHSjRXQa1rNW9unbS4fYr33klugvHu4CwoPWXmHlXF/NExr2NQCLHsQ
6oD9STtWoVr2eM1zpj4i3xmOhVZqBZ8oWchR886FL3c0fKbkfG3mU2gYyFBK
Jyi5mrG1BN5Ir+m5bqRE67R+EL5el72lnDnYYuSVK96ZSifZ7xYbr8h+rXDt
LCWj+qhi2J/ZWAaN4QlXYL2ozSFiTl+M5TyYtSMBimfMjiFhKZR5n4jXMMXV
okQocacu1nlKDtiz3WCN7FT9CjMspoF3puP0t9tWSg5LV7/D3XqTBXZW2Wyw
wfRVUsf87fRzPwzpnoqEorfJUbBOKTbW2ygpnthlgk3plUIVM9mc4wdNw0Fp
A8y74jO34L8vMS/O2SnRCQtewksnVU2VzLzqV/ehPtZvJH2J9Wxf4V1+ODcG
k0Y9x+F/poW4Gg==
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Half Line", "Subsection",
 CellChangeTimes->{{3.483345722880857*^9, 3.483345726944024*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"IntervalToHalfLine", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToHalfLine", "[", 
    RowBox[{"_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "~", "NEqual", "~", "1."}], "&"}], ")"}]}], "]"}], ":=", 
   "\[Infinity]"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalToHalfLine", "[", 
    RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
   RowBox[{"-", "1."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntervalToHalfLine", "[", "x_", "]"}], ":=", 
    FractionBox[
     RowBox[{"x", "+", "1"}], 
     RowBox[{"1", "-", "x"}]]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"HalfLineToInterval", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HalfLineToInterval", "[", 
    RowBox[{"y_", "?", "InfinityQ"}], "]"}], ":=", "1."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HalfLineToInterval", "[", "y_", "]"}], "/;", 
    RowBox[{"y", "\[Equal]", 
     RowBox[{"-", "1"}]}]}], ":=", "\[Infinity]"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HalfLineToInterval", "[", "y_", "]"}], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", "y"}], 
     RowBox[{"1", "+", "y"}]]}], " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"MapToInterval", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"MapFromInterval", ",", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ComplexMapToInterval", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"ComplexMapFromInterval", ",", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"MapToIntervalD", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"MapFromIntervalD", ",", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ComplexMapToIntervalD", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"ComplexMapFromIntervalD", ",", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", 
         RowBox[{"b_", "?", "InfinityQ"}]}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"HalfLineToInterval", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       RowBox[{"Arg", "[", "b", "]"}]}], "]"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z", "-", "a"}], ")"}], "/", "L"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToIntervalD", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", 
         RowBox[{"b_", "?", "InfinityQ"}]}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"Arg", "[", "b", "]"}]}]], " ", "L"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "a"}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Arg", "[", "b", "]"}]}]], " ", "L"}], "+", "z"}], ")"}], 
     "2"]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapFromInterval", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a_", ",", 
          RowBox[{"b_", "?", "InfinityQ"}]}], "}"}], ",", 
        RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "x_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"L", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", 
        RowBox[{"Arg", "[", "b", "]"}]}], "]"}], " ", 
      RowBox[{"IntervalToHalfLine", "[", "x", "]"}]}], "+", "a"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromIntervalD", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", 
         RowBox[{"b_", "?", "InfinityQ"}]}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "1."}], "]"}], ":=",
    "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a_", ",", 
          RowBox[{"b_", "?", "InfinityQ"}]}], "}"}], ",", 
        RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "x_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Arg", "[", "b", "]"}]}]], " ", "L"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a_", "?", "InfinityQ"}], ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"MapToInterval", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"b", ",", "a"}], "}"}], ",", 
        RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", "z"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToIntervalD", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a_", "?", "InfinityQ"}], ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"MapToIntervalD", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"b", ",", "a"}], "}"}], ",", 
        RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", "z"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a_", "?", "InfinityQ"}], ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "x_"}], "]"}], ":=", 
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", ",", "a"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", 
     RowBox[{"-", "x"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a_", "?", "InfinityQ"}], ",", "b_"}], "}"}], ",", 
        RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "x_"}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"MapFromIntervalD", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"b", ",", "a"}], "}"}], ",", 
         RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", 
       RowBox[{"-", "x"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", 
        RowBox[{"b_", "?", "InfinityQ"}]}], "}"}], "]"}], ",", "z_"}], "]"}], 
   ":=", 
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "1."}]}], "]"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToIntervalD", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", 
        RowBox[{"b_", "?", "InfinityQ"}]}], "}"}], "]"}], ",", "z_"}], "]"}], 
   ":=", 
   RowBox[{"MapToIntervalD", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "1."}]}], "]"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", 
        RowBox[{"b_", "?", "InfinityQ"}]}], "}"}], "]"}], ",", "x_"}], "]"}], 
   ":=", 
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "1."}]}], "]"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromIntervalD", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", 
        RowBox[{"b_", "?", "InfinityQ"}]}], "}"}], "]"}], ",", "1."}], "]"}], 
   ":=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{"a_", ",", 
         RowBox[{"b_", "?", "InfinityQ"}]}], "}"}], "]"}], ",", "x_"}], "]"}],
     ":=", 
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", 
        RowBox[{"Stretch", "\[Rule]", "1."}]}], "]"}], ",", "x"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a_", "?", "InfinityQ"}], ",", "b_"}], "}"}], "]"}], ",", 
     "z_"}], "]"}], ":=", 
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "1."}]}], "]"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToIntervalD", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a_", "?", "InfinityQ"}], ",", "b_"}], "}"}], "]"}], ",", 
     "z_"}], "]"}], ":=", 
   RowBox[{"MapToIntervalD", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "1."}]}], "]"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a_", "?", "InfinityQ"}], ",", "b_"}], "}"}], "]"}], ",", 
     "x_"}], "]"}], ":=", 
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "1."}]}], "]"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromIntervalD", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a_", "?", "InfinityQ"}], ",", "b_"}], "}"}], "]"}], ",", 
     RowBox[{"-", "1."}]}], "]"}], ":=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a_", "?", "InfinityQ"}], ",", "b_"}], "}"}], "]"}], ",", 
      "x_"}], "]"}], ":=", 
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", 
        RowBox[{"Stretch", "\[Rule]", "1."}]}], "]"}], ",", "x"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InfinityInDomainQ", "[", "_", "]"}], ":=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InfinityInDomainQ", "[", 
    RowBox[{"Line", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "InfinityQ"}], ",", "_"}], "}"}], ",", "___"}], 
     "]"}], "]"}], ":=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InfinityInDomainQ", "[", 
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", 
         RowBox[{"_", "?", "InfinityQ"}]}], "}"}], ",", "___"}], "]"}], "]"}],
     ":=", "True"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightEndpointInfinityQ", "[", "_", "]"}], ":=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightEndpointInfinityQ", "[", 
    RowBox[{"Line", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_", ",", 
        RowBox[{"_", "?", "InfinityQ"}]}], "}"}], ",", "___"}], "]"}], "]"}], 
   ":=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftEndpointInfinityQ", "[", "_", "]"}], ":=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LeftEndpointInfinityQ", "[", 
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "InfinityQ"}], ",", "_"}], "}"}], ",", "___"}], 
      "]"}], "]"}], ":=", "True"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftEndpoint", "[", 
    RowBox[{"Line", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], ",", "___"}], "]"}], "]"}], ":=", 
   "a"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightEndpoint", "[", 
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", "___"}], "]"}], "]"}], ":=", 
    "b"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReverseOrientation", "[", 
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", "l___"}], "]"}], "]"}], ":=", 
    RowBox[{"Line", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"b", ",", "a"}], "}"}], ",", "l"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftContourArg", "[", 
    RowBox[{"Line", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], ",", "___"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"b", "-", "a"}], ")"}], "//", "Arg"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightContourArg", "[", 
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", "___"}], "]"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}], "//", "Arg"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DomainQ", "[", "_", "]"}], ":=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DomainQ", "[", "_Line", "]"}], ":=", "True"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BoundedDomainQ", "[", "_", "]"}], ":=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BoundedDomainQ", "[", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"LeftEndpointInfinityQ", "[", "#", "]"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"RightEndpointInfinityQ", "[", "#", "]"}]}]}], "&"}], 
       ")"}]}], "]"}], ":=", "True"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DomainMemberQ", "[", 
    RowBox[{"d_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapToInterval", "[", 
     RowBox[{"d", ",", "x"}], "]"}], "//", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Im", "[", "#", "]"}], "~", "NEqual", "~", "0"}], "&&", 
       RowBox[{
        RowBox[{"Abs", "[", "#", "]"}], "<=", 
        RowBox[{"1.", "+", "$MachineTolerance"}]}]}], "&"}], ")"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4833454487707644`*^9, 3.4833455513613977`*^9}, {
   3.483345594328467*^9, 3.483345703611602*^9}, {3.483353475520488*^9, 
   3.483353501893139*^9}, {3.483354211577889*^9, 3.483354249188334*^9}, {
   3.483354562979095*^9, 3.483354583842978*^9}, {3.4833574253703136`*^9, 
   3.483357429915225*^9}, {3.483374710607655*^9, 3.483374788710692*^9}, {
   3.483421785783741*^9, 3.483421825979871*^9}, {3.483422465747957*^9, 
   3.483422539654171*^9}, {3.4834226897392807`*^9, 3.483422697521455*^9}, {
   3.483423304506796*^9, 3.483423480662969*^9}, {3.483423804489627*^9, 
   3.483423910540371*^9}, {3.483438948740748*^9, 3.483438977762746*^9}, {
   3.483440611433612*^9, 3.48344063523136*^9}, {3.483442239871704*^9, 
   3.483442277887491*^9}, {3.483683392329089*^9, 3.4836834110116167`*^9}, {
   3.483685473060973*^9, 3.483685506031176*^9}, {3.483794735881212*^9, 
   3.4837947474847717`*^9}, {3.483872180191593*^9, 3.483872275096714*^9}, {
   3.483960972638691*^9, 3.48396097355789*^9}, 3.483961978361617*^9, {
   3.484213018183505*^9, 3.4842130324446287`*^9}, {3.486734068215551*^9, 
   3.486734128818309*^9}, {3.494766680125251*^9, 3.494766685954281*^9}, {
   3.495190460064179*^9, 3.4951904649484367`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Line", "Subsection",
 CellChangeTimes->{{3.483345736807745*^9, 3.483345737783413*^9}, 
   3.483423912324107*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "z_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"a", "+", "b", "-", 
     RowBox[{"2", "z"}]}], 
    RowBox[{"a", "-", "b"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "x_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"b", "+", "a"}], "2"], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"b", "-", "a"}], "2"], "x"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToIntervalD", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "x_"}], "]"}], ":=", 
   RowBox[{"-", 
    FractionBox["2", 
     RowBox[{"a", "-", "b"}]]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "x_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{"b", "-", "a"}], "2"]}], "  ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToIntervalSeriesAtInfinity", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "1"}], "]"}], ":=", 
    FractionBox["2", 
     RowBox[{"b", "-", "a"}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", "z_", "]"}], ":=", "z"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", "z_", "]"}], ":=", "z"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4833457483257303`*^9, 3.483345850202158*^9}, {
  3.4833505658569193`*^9, 3.483350583015511*^9}, {3.483355866082966*^9, 
  3.483355887012591*^9}, {3.483423915017583*^9, 3.483423918037788*^9}, {
  3.483423964909536*^9, 3.483423965247355*^9}, {3.483424407662266*^9, 
  3.4834244080274754`*^9}, {3.483683420277836*^9, 3.483683423270814*^9}, {
  3.4838563255675707`*^9, 3.483856326350184*^9}, {3.4842130333389387`*^9, 
  3.484213038713641*^9}, {3.4846325270552397`*^9, 3.484632623062786*^9}, {
  3.484638270629776*^9, 3.4846383321011133`*^9}, {3.4846391985928707`*^9, 
  3.484639231182498*^9}, {3.485258850634313*^9, 3.485258850945719*^9}, {
  3.486734024056157*^9, 3.486734039267836*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Unit Domains", "Subsection",
 CellChangeTimes->{{3.485258852871258*^9, 3.485258855638803*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"UnitCircle", "=", 
   RowBox[{"Circle", "[", 
    RowBox[{"0", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCircleFunQ", "[", "f_LFun", "]"}], ":=", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Domain", "[", "f", "]"}], "]"}], "\[Equal]", 
    RowBox[{"N", "[", "UnitCircle", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnitCircleFunQ", "[", "_", "]"}], ":=", "False"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UnitInterval", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitIntervalFunQ", "[", "f_IFun", "]"}], ":=", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Domain", "[", "f", "]"}], "]"}], "===", 
    RowBox[{"N", "[", "UnitInterval", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitIntervalFunQ", "[", "_", "]"}], ":=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalFunQ", "[", "f_IFun", "]"}], ":=", 
   RowBox[{"MatchQ", "[", 
    RowBox[{
     RowBox[{"Domain", "[", "f", "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "FiniteQ"}], ",", 
        RowBox[{"_", "?", "FiniteQ"}]}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntervalFunQ", "[", "_", "]"}], ":=", "False"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DomainQ", "[", "_Circle", "]"}], ":=", "True"}], ";"}]}], "Input",\

 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Stretched Line", "Subsection",
 CellChangeTimes->{{3.483345736807745*^9, 3.483345737783413*^9}, 
   3.483423912324107*^9, {3.485258876072122*^9, 3.48525887755016*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", 
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1.", "~", "NEqual", "~", "#"}], "&"}], ")"}]}]}]}], "]"}],
      ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", "\[Infinity]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", 
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1.", "~", "NEqual", "~", "#"}], "&"}], ")"}]}]}]}], "]"}],
      ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", "\[Infinity]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "a"}], "+", 
     RowBox[{"b", " ", "L"}]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", "L"}]]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   FractionBox[
    RowBox[{"1", "+", "L"}], 
    RowBox[{"1", "-", "L"}]]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "a"}], "+", 
     RowBox[{"b", " ", "L"}]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", "L"}]]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", " ", "a"}], "-", " ", 
     RowBox[{"b", " ", "L"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "\[InvisibleSpace]", "+", "L"}], ")"}], " ", "z"}]}], 
    RowBox[{
     RowBox[{"-", " ", "a"}], "+", 
     RowBox[{"b", " ", "L"}], "+", " ", "z", "-", 
     RowBox[{"L", " ", "z"}]}]]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"b", " ", "L", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", " ", "z"}], ")"}]}], "+", 
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", " ", "z"}], ")"}]}]}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", " ", "L", "+", "z", "-", " ", 
     RowBox[{"L", " ", "z"}]}]]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToIntervalD", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "L"}], "-", 
        RowBox[{"b", " ", "L"}]}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"a", "-", 
        RowBox[{"b", " ", "L"}], "-", "z", "+", 
        RowBox[{"L", " ", "z"}]}], ")"}], "2"]]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromIntervalD", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "a"}], " ", "L"}], "+", 
       RowBox[{"b", " ", "L"}]}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "L", "-", "z", "+", 
       RowBox[{"L", " ", "z"}]}], ")"}], "2"]]}], " ", ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4833457483257303`*^9, 3.483345850202158*^9}, {
   3.4833505658569193`*^9, 3.483350583015511*^9}, {3.483355866082966*^9, 
   3.483355887012591*^9}, {3.483423915017583*^9, 3.483423918037788*^9}, {
   3.483423964909536*^9, 3.483423965247355*^9}, {3.483424407662266*^9, 
   3.4834244080274754`*^9}, {3.483683420277836*^9, 3.483683423270814*^9}, {
   3.4838563255675707`*^9, 3.483856326350184*^9}, {3.4842130333389387`*^9, 
   3.484213038713641*^9}, {3.4846325270552397`*^9, 3.484632623062786*^9}, {
   3.484638270629776*^9, 3.4846383321011133`*^9}, {3.4846391985928707`*^9, 
   3.484639231182498*^9}, {3.485258871105242*^9, 3.485258872711887*^9}, {
   3.485258921221286*^9, 3.485259199351117*^9}, {3.485259506989711*^9, 
   3.485259530533613*^9}, {3.485259574616613*^9, 3.4852596013217297`*^9}, {
   3.485259876948634*^9, 3.485259968017874*^9}, 3.485260042970611*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"MapToInterval", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], "]"}], ",", "z"}], "]"}], "//", 
     RowBox[{
      RowBox[{"MapFromInterval", "[", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Infinity]"}], "}"}], "]"}], ",", "#"}], "]"}], 
      "&"}]}], "//", 
    RowBox[{
     RowBox[{"MapToInterval", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", "#"}], "]"}], 
     "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"MapFromInterval", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", "z"}], "]"}], "//", 
     RowBox[{
      RowBox[{"MapToInterval", "[", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Infinity]"}], "}"}], "]"}], ",", "#"}], "]"}], 
      "&"}]}], "//", 
    RowBox[{
     RowBox[{"MapFromInterval", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], "]"}], ",", "#"}], "]"}], "&"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4833457483257303`*^9, 3.483345850202158*^9}, {
  3.4833505658569193`*^9, 3.483350583015511*^9}, {3.483355866082966*^9, 
  3.483355887012591*^9}, {3.483423915017583*^9, 3.483423918037788*^9}, {
  3.483423964909536*^9, 3.483423965247355*^9}, {3.483424407662266*^9, 
  3.4834244080274754`*^9}, {3.483683420277836*^9, 3.483683423270814*^9}, {
  3.4838563255675707`*^9, 3.483856326350184*^9}, {3.4842130333389387`*^9, 
  3.484213038713641*^9}, {3.4846325270552397`*^9, 3.484632623062786*^9}, {
  3.484638270629776*^9, 3.4846383321011133`*^9}, {3.4846391985928707`*^9, 
  3.484639231182498*^9}, {3.485258871105242*^9, 3.485258872711887*^9}, {
  3.485258921221286*^9, 3.485259199351117*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Arc", "Subsection",
 CellChangeTimes->{{3.483379467455101*^9, 3.483379467975212*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Arc", "[", 
      RowBox[{"z0_", ",", "r_", ",", 
       RowBox[{"{", 
        RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], ",", "x_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"t0", "+", 
           RowBox[{"2", " ", "t1"}]}], ")"}]}]]}], " ", "r", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "t0"}], "2"]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], " ", "z0"}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "t1"}], "2"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "t0"}]], " ", "r"}], "+", "z0"}], 
       ")"}]}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "t1"}], "2"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "t0"}], "2"]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}]}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Arc", "[", 
      RowBox[{"z0_", ",", "r_", ",", 
       RowBox[{"{", 
        RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"t0", "+", "t1"}], ")"}]}]]}], " ", "r"}], "+", "z0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToInterval", "[", 
     RowBox[{
      RowBox[{"Arc", "[", 
       RowBox[{"z0_", ",", "r_", ",", 
        RowBox[{"{", 
         RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], ",", "z_"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"t0", "+", "t1"}], ")"}]}]]}], " ", "r"}], "+", "z0"}], 
       ")"}], "~", "NEqual", "~", "z"}], ")"}]}], ":=", "\[Infinity]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Arc", "[", 
      RowBox[{"z0_", ",", "r_", ",", 
       RowBox[{"{", 
        RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "t0"}], "2"]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "t1"}], "2"]]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "t0"}], "2"], "+", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "t1"}], "2"]}]], " ", "r"}], "-", 
        "z", "+", "z0"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "t0"}], "2"]]}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "t1"}], "2"]]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "t0"}], "2"], "+", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "t1"}], "2"]}]], " ", "r"}], "+", 
        "z", "-", "z0"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToInterval", "[", 
     RowBox[{
      RowBox[{"Arc", "[", 
       RowBox[{"z0_", ",", "r_", ",", 
        RowBox[{"{", 
         RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], ",", 
      RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "t0"}], "2"]], "+", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "t1"}], "2"]]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "t0"}], "2"]], "-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "t1"}], "2"]]}]]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromIntervalD", "[", 
    RowBox[{
     RowBox[{"Arc", "[", 
      RowBox[{"z0_", ",", "r_", ",", 
       RowBox[{"{", 
        RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], ",", "x_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"t0", "+", "t1"}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "t0"}]]}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "t1"}]]}], ")"}], " ", "r"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "t1"}], "2"]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "x"}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "t0"}], "2"]], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}]}], ")"}], "2"]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToIntervalD", "[", 
     RowBox[{
      RowBox[{"Arc", "[", 
       RowBox[{"z0_", ",", "r_", ",", 
        RowBox[{"{", 
         RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "t0"}], "2"]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "t1"}]], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"t0", "+", "t1"}], ")"}]}]]}], ")"}], " ", "r"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "t0"}], "2"]]}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "t1"}], "2"]]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"t0", "+", "t1"}], ")"}]}]], " ", "r"}], "+", "z", "-", 
         "z0"}], ")"}], "2"]}]]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftEndpoint", "[", 
    RowBox[{"Arc", "[", 
     RowBox[{"z0_", ",", "r_", ",", 
      RowBox[{"{", 
       RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"z0", "+", 
     RowBox[{"r", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "t0"}], "]"}]}]}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightEndpoint", "[", 
     RowBox[{"Arc", "[", 
      RowBox[{"z0_", ",", "r_", ",", 
       RowBox[{"{", 
        RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"z0", "+", 
      RowBox[{"r", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "t1"}], "]"}]}]}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReverseOrientation", "[", 
     RowBox[{"Arc", "[", 
      RowBox[{"z0_", ",", "r_", ",", 
       RowBox[{"{", 
        RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], "]"}], ":=", 
    RowBox[{"Arc", "[", 
     RowBox[{"z0", ",", "r", ",", 
      RowBox[{"{", 
       RowBox[{"t1", ",", "t0"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftContourArg", "[", 
    RowBox[{"Arc", "[", 
     RowBox[{"z0_", ",", "r_", ",", 
      RowBox[{"{", 
       RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"t0", "+", 
     RowBox[{
      RowBox[{"Sign", "[", 
       RowBox[{"t1", "-", "t0"}], "]"}], " ", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightContourArg", "[", 
     RowBox[{"Arc", "[", 
      RowBox[{"z0_", ",", "r_", ",", 
       RowBox[{"{", 
        RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"t1", "-", 
      RowBox[{
       RowBox[{"Sign", "[", 
        RowBox[{"t1", "-", "t0"}], "]"}], " ", 
       RowBox[{"\[Pi]", "/", "2"}]}]}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DomainQ", "[", "_Arc", "]"}], ":=", "True"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Arc", "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Det", "[", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{
             RowBox[{"Abs", "[", "a", "]"}], "^", "2"}], 
            RowBox[{"Im", "[", "a", "]"}], "1"},
           {
            RowBox[{
             RowBox[{"Abs", "[", "b", "]"}], "^", "2"}], 
            RowBox[{"Im", "[", "b", "]"}], "1"},
           {
            RowBox[{
             RowBox[{"Abs", "[", "c", "]"}], "^", "2"}], 
            RowBox[{"Im", "[", "c", "]"}], "1"}
          }], ")"}], "]"}], "-", 
       RowBox[{"I", " ", 
        RowBox[{"Det", "[", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{
              RowBox[{"Abs", "[", "a", "]"}], "^", "2"}], 
             RowBox[{"Re", "[", "a", "]"}], "1"},
            {
             RowBox[{
              RowBox[{"Abs", "[", "b", "]"}], "^", "2"}], 
             RowBox[{"Re", "[", "b", "]"}], "1"},
            {
             RowBox[{
              RowBox[{"Abs", "[", "c", "]"}], "^", "2"}], 
             RowBox[{"Re", "[", "c", "]"}], "1"}
           }], ")"}], "]"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       RowBox[{"Det", "[", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Re", "[", "a", "]"}], 
            RowBox[{"Im", "[", "a", "]"}], "1"},
           {
            RowBox[{"Re", "[", "b", "]"}], 
            RowBox[{"Im", "[", "b", "]"}], "1"},
           {
            RowBox[{"Re", "[", "c", "]"}], 
            RowBox[{"Im", "[", "c", "]"}], "1"}
          }], ")"}], "]"}]}], ")"}]}], "//", 
    RowBox[{"Function", "[", 
     RowBox[{"x0", ",", 
      RowBox[{"Arc", "[", 
       RowBox[{"x0", ",", 
        RowBox[{"Abs", "[", 
         RowBox[{"a", "-", "x0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arg", "[", 
           RowBox[{"a", "-", "x0"}], "]"}], ",", 
          RowBox[{"Arg", "[", 
           RowBox[{"c", "-", "x0"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4833795380580587`*^9, 3.483379705996648*^9}, {
  3.4833797422146187`*^9, 3.4833797846135187`*^9}, {3.483379880628213*^9, 
  3.48337990015007*^9}, {3.483683427120386*^9, 3.483683430593986*^9}, {
  3.483794719812766*^9, 3.483794722582838*^9}, {3.483795024838114*^9, 
  3.483795135576446*^9}, {3.483795186826642*^9, 3.48379519275738*^9}, {
  3.484213039499447*^9, 3.484213043390788*^9}, {3.485512885191251*^9, 
  3.4855128975512753`*^9}, {3.485773984968981*^9, 3.485774037382927*^9}, {
  3.485774079774032*^9, 3.485774080949815*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Circle", "Subsection",
 CellChangeTimes->{{3.483358174913599*^9, 3.483358177511505*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"MapToCircle", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"MapFromCircle", ",", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircle", "[", 
    RowBox[{
     RowBox[{"Circle", "[", 
      RowBox[{"a_", ",", "r_"}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"z", "-", "a"}], ")"}], "/", "r"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{
     RowBox[{"Circle", "[", 
      RowBox[{"a_", ",", "r_"}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"r", " ", "z"}], "+", "a"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircleD", "[", 
    RowBox[{
     RowBox[{"Circle", "[", 
      RowBox[{"a_", ",", "r_"}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"1", "/", "r"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapFromCircleD", "[", 
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{"a_", ",", "r_"}], "]"}], ",", "z_"}], "]"}], ":=", "r"}], " ",
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RealLine", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{"RealLine", ",", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "~", "NEqual", "~", 
         RowBox[{"-", "1."}]}], "&"}], ")"}]}]}], "]"}], ":=", 
   "\[Infinity]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{"RealLine", ",", "z_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "I"}], " ", "z"}], " ", "+", "I"}], 
    RowBox[{"z", " ", "+", "1"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircle", "[", 
    RowBox[{"RealLine", ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   RowBox[{"-", "1."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToCircle", "[", 
     RowBox[{"RealLine", ",", "t_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", "-", "t"}], 
     RowBox[{"\[ImaginaryI]", "+", "t"}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircleD", "[", 
    RowBox[{"RealLine", ",", "z_"}], "]"}], ":=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", "\[ImaginaryI]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "z"}], ")"}], "2"]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToCircleD", "[", 
     RowBox[{"RealLine", ",", "t_"}], "]"}], ":=", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", "\[ImaginaryI]"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", "t"}], ")"}], "2"]]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "~", "NEqual", "~", 
         RowBox[{"-", "1."}]}], "&"}], ")"}]}]}], "]"}], ":=", 
   "\[Infinity]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "z"}], ")"}]}], 
     RowBox[{"L", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "z"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircle", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   RowBox[{"-", "1."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToCircle", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "t_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{" ", 
      RowBox[{"\[ImaginaryI]", "-", 
       RowBox[{"L", " ", "t"}]}]}], 
     RowBox[{" ", 
      RowBox[{"\[ImaginaryI]", "+", 
       RowBox[{"L", " ", "t"}]}]}]]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}], ",", 
       RowBox[{"Centre", "\[Rule]", "a_"}]}], "]"}], ",", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "~", "NEqual", "~", 
         RowBox[{"-", "1."}]}], "&"}], ")"}]}]}], "]"}], ":=", 
   "\[Infinity]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}], ",", 
       RowBox[{"Centre", "\[Rule]", "a_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"a", "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "z"}], ")"}]}], 
     RowBox[{"L", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "z"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircle", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}], ",", 
       RowBox[{"Centre", "\[Rule]", "a_"}]}], "]"}], ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   RowBox[{"-", "1."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToCircle", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"Stretch", "\[Rule]", "L_"}], ",", 
        RowBox[{"Centre", "\[Rule]", "a_"}]}], "]"}], ",", "t_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{" ", 
      RowBox[{"\[ImaginaryI]", "-", 
       RowBox[{"L", " ", 
        RowBox[{"(", 
         RowBox[{"t", "-", "a"}], ")"}]}]}]}], 
     RowBox[{" ", 
      RowBox[{"\[ImaginaryI]", "+", 
       RowBox[{"L", " ", 
        RowBox[{"(", 
         RowBox[{"t", "-", "a"}], ")"}]}]}]}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Infinity]"}], " ", "I"}], ",", 
         RowBox[{"\[Infinity]", " ", "I"}]}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}], ",", 
       RowBox[{"Centre", "\[Rule]", "a_"}]}], "]"}], ",", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "~", "NEqual", "~", 
         RowBox[{"-", "1."}]}], "&"}], ")"}]}]}], "]"}], ":=", 
   "\[Infinity]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Infinity]"}], " ", "I"}], ",", 
         RowBox[{"\[Infinity]", " ", "I"}]}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}], ",", 
       RowBox[{"Centre", "\[Rule]", "a_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"a", "-", 
    RowBox[{"I", " ", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "z"}], ")"}]}], 
      RowBox[{"L", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "z"}], ")"}]}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircle", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Infinity]"}], " ", "I"}], ",", 
         RowBox[{"\[Infinity]", " ", "I"}]}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}], ",", 
       RowBox[{"Centre", "\[Rule]", "a_"}]}], "]"}], ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   RowBox[{"-", "1."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToCircle", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Infinity]"}], " ", "I"}], ",", 
          RowBox[{"\[Infinity]", " ", "I"}]}], "}"}], ",", 
        RowBox[{"Stretch", "\[Rule]", "L_"}], ",", 
        RowBox[{"Centre", "\[Rule]", "a_"}]}], "]"}], ",", "t_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{" ", 
      RowBox[{"\[ImaginaryI]", "+", 
       RowBox[{"I", " ", "L", " ", 
        RowBox[{"(", 
         RowBox[{"t", "-", "a"}], ")"}]}]}]}], 
     RowBox[{" ", 
      RowBox[{"\[ImaginaryI]", "-", " ", 
       RowBox[{"I", " ", "L", " ", 
        RowBox[{"(", 
         RowBox[{"t", "-", "a"}], ")"}]}]}]}]]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PeriodicInterval", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{"PeriodicInterval", ",", "z_"}], "]"}], ":=", 
   RowBox[{"CircleToPeriodicInterval", "[", "z", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircle", "[", 
    RowBox[{"PeriodicInterval", ",", "z_"}], "]"}], ":=", 
   RowBox[{"Exp", "[", 
    RowBox[{"I", " ", "z"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircleD", "[", 
    RowBox[{"PeriodicInterval", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CircleToPeriodicInterval", "'"}], "[", "z", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToCircleD", "[", 
     RowBox[{"PeriodicInterval", ",", "z_"}], "]"}], ":=", 
    RowBox[{"I", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "z"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{"l_Line", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapFromInterval", "[", 
    RowBox[{"l", ",", 
     RowBox[{
      RowBox[{"MapFromCircle", "[", 
       RowBox[{"PeriodicInterval", ",", "z"}], "]"}], "/", "\[Pi]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircle", "[", 
    RowBox[{"l_Line", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapToCircle", "[", 
    RowBox[{"PeriodicInterval", ",", 
     RowBox[{
      RowBox[{"MapToInterval", "[", 
       RowBox[{"l", ",", "z"}], "]"}], " ", "\[Pi]"}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircleD", "[", 
    RowBox[{"l_Line", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{"l", ",", 
      RowBox[{
       RowBox[{"MapFromCircle", "[", 
        RowBox[{"PeriodicInterval", ",", "z"}], "]"}], "/", "\[Pi]"}]}], 
     "]"}], " ", 
    RowBox[{
     RowBox[{"MapFromCircleD", "[", 
      RowBox[{"PeriodicInterval", ",", "z"}], "]"}], "/", "\[Pi]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToCircleD", "[", 
     RowBox[{"l_Line", ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"MapToCircleD", "[", 
      RowBox[{"PeriodicInterval", ",", 
       RowBox[{
        RowBox[{"MapToInterval", "[", 
         RowBox[{"l", ",", "z"}], "]"}], " ", "\[Pi]"}]}], " ", "]"}], " ", 
     RowBox[{"MapToIntervalD", "[", 
      RowBox[{"l", ",", "z"}], "]"}], " ", "\[Pi]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ellipse", "[", "r_", "]"}], ":=", 
    RowBox[{"Ellipse", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "r"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{
     RowBox[{"Ellipse", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", "r_"}], "]"}], ",", "z_"}], 
    "]"}], ":=", 
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], "]"}], ",", 
     RowBox[{"CircleToInterval", "[", 
      RowBox[{"MapFromCircle", "[", 
       RowBox[{
        RowBox[{"Circle", "[", 
         RowBox[{"0", ",", "r"}], "]"}], ",", "z"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircle", "[", 
    RowBox[{
     RowBox[{"Ellipse", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", "r_"}], "]"}], ",", "z_"}], 
    "]"}], ":=", 
   RowBox[{"MapToCircle", "[", 
    RowBox[{
     RowBox[{"Circle", "[", 
      RowBox[{"0", ",", "r"}], "]"}], ",", 
     RowBox[{"IntervalToInnerCircle", "[", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], ",", "z"}], "]"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircleD", "[", 
    RowBox[{
     RowBox[{"Ellipse", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", "r_"}], "]"}], ",", "z_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], "]"}], ",", 
      RowBox[{"CircleToInterval", "[", 
       RowBox[{"MapFromCircle", "[", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{"0", ",", "r"}], "]"}], ",", "z"}], "]"}], "]"}]}], "]"}], 
    RowBox[{
     RowBox[{"CircleToInterval", "'"}], "[", 
     RowBox[{"MapFromCircle", "[", 
      RowBox[{
       RowBox[{"Circle", "[", 
        RowBox[{"0", ",", "r"}], "]"}], ",", "z"}], "]"}], "]"}], 
    RowBox[{"MapFromCircleD", "[", 
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{"0", ",", "r"}], "]"}], ",", "z"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircleD", "[", 
    RowBox[{
     RowBox[{"Ellipse", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", "r_"}], "]"}], ",", "z_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"MapToCircleD", "[", 
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{"0", ",", "r"}], "]"}], ",", 
      RowBox[{"IntervalToInnerCircle", "[", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], "]"}], ",", "z"}], "]"}], "]"}]}], 
     "]"}], 
    RowBox[{
     RowBox[{"IntervalToInnerCircle", "'"}], "[", 
     RowBox[{"MapToInterval", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], "]"}], ",", "z"}], "]"}], "]"}], 
    RowBox[{"MapToIntervalD", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], "]"}], ",", "z"}], "]"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483358184411063*^9, 3.483358215416684*^9}, {
   3.4833584919325047`*^9, 3.4833585030367527`*^9}, {3.483358752548361*^9, 
   3.483358764459634*^9}, {3.483364577812846*^9, 3.483364669403695*^9}, {
   3.4833648717862577`*^9, 3.4833648944094667`*^9}, {3.483365014406825*^9, 
   3.483365023659081*^9}, 3.483423926491562*^9, {3.4842130442335253`*^9, 
   3.4842130508165607`*^9}, {3.484213525477508*^9, 3.4842135268320637`*^9}, {
   3.485238285408204*^9, 3.485238293092805*^9}, {3.487485413769861*^9, 
   3.487485419550645*^9}, {3.487583579186501*^9, 3.487583580039463*^9}, {
   3.492784976545187*^9, 3.49278504688733*^9}, {3.492785097910343*^9, 
   3.49278511175391*^9}, {3.493970401833056*^9, 3.4939704406385937`*^9}, {
   3.493970584348879*^9, 3.493970597627836*^9}, {3.493970638729023*^9, 
   3.493970691147909*^9}, {3.497012984679494*^9, 3.4970131235019093`*^9}, {
   3.497051590639956*^9, 3.4970517267700233`*^9}, {3.497051763391181*^9, 
   3.4970517643105497`*^9}, {3.497051799630886*^9, 3.4970518651885147`*^9}, {
   3.4970518965863667`*^9, 3.497051952040303*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["General", "Subsection",
 CellChangeTimes->{{3.48551974107169*^9, 3.485519741669588*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LeftEndpoint", "[", "comp_", "]"}], ":=", 
   RowBox[{"MapFromInterval", "[", 
    RowBox[{"comp", ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightEndpoint", "[", "comp_", "]"}], ":=", 
   RowBox[{"MapFromInterval", "[", 
    RowBox[{"comp", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftContourArg", "[", "comp_", "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"Arg", "[", 
     RowBox[{"MapToIntervalD", "[", 
      RowBox[{"comp", ",", 
       RowBox[{"LeftEndpoint", "[", "comp", "]"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightContourArg", "[", "comp_", "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"Arg", "[", 
     RowBox[{"-", 
      RowBox[{"MapToIntervalD", "[", 
       RowBox[{"comp", ",", 
        RowBox[{"RightEndpoint", "[", "comp", "]"}]}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.485519752301071*^9, 3.485519770939106*^9}, {
  3.4875835811369467`*^9, 3.487583581480941*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Maps D", "Section",
 CellChangeTimes->{{3.487583499334062*^9, 3.487583500532158*^9}}],

Cell[BoxData[{
 RowBox[{"MapToIntervalDomainD", ";"}], "\[IndentingNewLine]", 
 RowBox[{"MapToIntervalDDomainD", ";"}], "\[IndentingNewLine]", 
 RowBox[{"MapFromIntervalDomainD", ";"}], "\[IndentingNewLine]", 
 RowBox[{"BaryDomainD", ";"}], "\[IndentingNewLine]", 
 RowBox[{"MapToIntervalSeriesAtInfinityD", ";"}], "\[IndentingNewLine]", 
 RowBox[{"PointsD", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ValuesDomainD", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToValueListD", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToIntervalDomainD", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"b", "-", "z"}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"a", "-", "b"}], ")"}], "2"]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToIntervalDomainD", "[", 
     RowBox[{"0", ",", "1"}], "]"}], "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "z_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"a", "-", "z"}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}], "2"]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToIntervalDDomainD", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "z_"}], "]"}], ":=", 
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}], "2"]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MapToIntervalDDomainD", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{"-", 
     FractionBox["2", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "-", "b"}], ")"}], "2"]]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapFromIntervalDomainD", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], "-", 
    FractionBox["z", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapFromIntervalDomainD", "[", 
     RowBox[{"0", ",", "1"}], "]"}], "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], "+", 
    FractionBox["z", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToIntervalDomainD", "[", "spc__", "]"}], "[", 
    RowBox[{"d_IFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapToIntervalDomainD", "[", "spc", "]"}], "[", 
    RowBox[{
     RowBox[{"d", "//", "Domain"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToIntervalDDomainD", "[", "spc__", "]"}], "[", 
    RowBox[{"d_IFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapToIntervalDDomainD", "[", "spc", "]"}], "[", 
    RowBox[{
     RowBox[{"d", "//", "Domain"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MapFromIntervalDomainD", "[", "spc__", "]"}], "[", 
     RowBox[{"d_IFun", ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"MapFromIntervalDomainD", "[", "spc", "]"}], "[", 
     RowBox[{
      RowBox[{"d", "//", "Domain"}], ",", "z"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"BaryDomainD", "[", "spc__", "]"}], "[", 
     RowBox[{"f_", ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"MapToIntervalDomainD", "[", "spc", "]"}], "[", 
      RowBox[{"f", ",", "z"}], "]"}], " ", 
     RowBox[{
      RowBox[{
       RowBox[{"ToUnitInterval", "[", "f", "]"}], "'"}], "[", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"f", ",", "z"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToIntervalSeriesAtInfinityD", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "1"}], "]"}], ":=", 
   FractionBox["2", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "a"}], "+", "b"}], ")"}], "2"]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToIntervalSeriesAtInfinityD", "[", 
     RowBox[{"0", ",", "1"}], "]"}], "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "1"}], "]"}], ":=", 
   RowBox[{"-", 
    FractionBox["2", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "a"}], "+", "b"}], ")"}], "2"]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MapToIntervalSeriesAtInfinityD", "[", "spc__", "]"}], "[", 
     RowBox[{"f_IFun", ",", "s_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"MapToIntervalSeriesAtInfinityD", "[", "spc", "]"}], "[", 
     RowBox[{
      RowBox[{"f", "//", "Domain"}], ",", "s"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PointsD", "[", "spc__", "]"}], "[", 
    RowBox[{"d_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapFromIntervalDomainD", "[", "spc", "]"}], "[", 
    RowBox[{"d", ",", 
     RowBox[{"Points", "[", 
      RowBox[{"UnitInterval", ",", "n"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PointsD", "[", "spc__", "]"}], "[", "d_IFun", "]"}], ":=", 
    RowBox[{
     RowBox[{"PointsD", "[", "spc", "]"}], "[", 
     RowBox[{
      RowBox[{"d", "//", "Domain"}], ",", 
      RowBox[{"d", "//", "Length"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ValuesDomainD", "[", "spc__", "]"}], "[", "f_IFun", "]"}], ":=", 
    RowBox[{
     RowBox[{"Values", "[", 
      RowBox[{"f", "'"}], "]"}], 
     RowBox[{
      RowBox[{"MapFromIntervalDomainD", "[", "spc", "]"}], "[", 
      RowBox[{"f", ",", 
       RowBox[{"Points", "[", 
        RowBox[{"UnitInterval", ",", 
         RowBox[{"f", "//", "Length"}]}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToValueListD", "[", "spca__", "]"}], "[", "f_List", "]"}], ":=", 
   
   RowBox[{"Join", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"ZeroVector", "[", 
          RowBox[{"Length", "[", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}],
           "]"}], ",", 
         RowBox[{
          RowBox[{"ValuesDomainD", "[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           "]"}], "[", 
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}]}], "]"}], "&"}], "/@", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{"f", ",", 
         RowBox[{"{", "spca", "}"}]}], "}"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.487583527324916*^9, 3.4875835277095747`*^9}, {
   3.487583610129311*^9, 3.4875836825604877`*^9}, {3.49068578745546*^9, 
   3.490685796502432*^9}, {3.490685856637793*^9, 3.4906858590432796`*^9}, 
   3.490706902034288*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Points", "Section",
 CellChangeTimes->{{3.483345813916271*^9, 3.483345814684606*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FinitePoints", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CirclePoints", "[", "n_", "]"}], ":=", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "\[Pi]", " ", 
       RowBox[{"LeftEvenPoints", "[", "n", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NCirclePoints", "[", "n_", "]"}], ":=", 
     RowBox[{
      RowBox[{"CirclePoints", "[", "n", "]"}], "//", "N"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FourierRealLinePoints", "[", "n_", "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{"CircleToRealLine", ",", 
       RowBox[{
        RowBox[{"CirclePoints", "[", "n", "]"}], "//", "Rest"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NFourierRealLinePoints", "[", "n_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"CircleToRealLine", ",", 
        RowBox[{
         RowBox[{"NCirclePoints", "[", "n", "]"}], "//", "Rest"}]}], "]"}], "//",
       "Re"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RealLinePoints", "[", "n_", "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{"IntervalToRealLine", ",", 
       RowBox[{
        RowBox[{"ChebyshevLobattoPoints", "[", "n", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"2", ";;", 
         RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NRealLinePoints", "[", "n_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"IntervalToRealLine", ",", 
        RowBox[{
         RowBox[{"NChebyshevLobattoPoints", "[", "n", "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], "]"}], "//", 
      "Re"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Points", "[", 
      RowBox[{"d_Circle", ",", "n_"}], "]"}], ":=", 
     RowBox[{"MapFromCircle", "[", 
      RowBox[{"d", ",", 
       RowBox[{"NCirclePoints", "[", "n", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Points", "[", 
      RowBox[{"RealLine", ",", "n_"}], "]"}], ":=", 
     RowBox[{"MapFromCircle", "[", 
      RowBox[{"RealLine", ",", 
       RowBox[{"Points", "[", 
        RowBox[{"UnitCircle", ",", "n"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Points", "[", 
      RowBox[{
       RowBox[{"d", ":", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
          "___"}], "]"}]}], ",", "n_"}], "]"}], ":=", 
     RowBox[{"MapFromCircle", "[", 
      RowBox[{"RealLine", ",", 
       RowBox[{"Points", "[", 
        RowBox[{"UnitCircle", ",", "n"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Points", "[", 
      RowBox[{"d_Ellipse", ",", "n_"}], "]"}], ":=", 
     RowBox[{"MapFromCircle", "[", 
      RowBox[{"d", ",", 
       RowBox[{"Points", "[", 
        RowBox[{"UnitCircle", ",", "n"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Points", "[", 
      RowBox[{"d_", ",", "n_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"MapFromInterval", "[", 
        RowBox[{"d", ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"NChebyshevLobattoPoints", "[", "n", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Points", "[", 
      RowBox[{"l", ":", 
       RowBox[{"{", "__IFun", "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Points", "/@", "l"}], "//", "Flatten"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FinitePoints", "[", 
      RowBox[{"l", ":", 
       RowBox[{"{", "__IFun", "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"FinitePoints", "/@", "l"}], "//", "Flatten"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FinitePoints", "[", 
      RowBox[{"d_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Points", "[", 
        RowBox[{"d", ",", "n"}], "]"}], ",", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"InfinityQ", "[", "#", "]"}]}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483344977327508*^9, 3.483344993246881*^9}, 
   3.483345445664185*^9, {3.4833455918057127`*^9, 3.483345599019409*^9}, 
   3.4833456928324137`*^9, {3.483345767484376*^9, 3.483345816839005*^9}, 
   3.483345865911435*^9, {3.4833506777649612`*^9, 3.483350678727569*^9}, {
   3.483351030400753*^9, 3.48335108053277*^9}, {3.4833512325935583`*^9, 
   3.483351237327981*^9}, {3.483351711846841*^9, 3.483351745549491*^9}, {
   3.4833584066522093`*^9, 3.483358444415831*^9}, {3.483358550181333*^9, 
   3.483358550765761*^9}, {3.4833647463775473`*^9, 3.4833647547280293`*^9}, 
   3.483364801696904*^9, {3.483364837740032*^9, 3.483364845088306*^9}, {
   3.48421305173555*^9, 3.4842130599677763`*^9}, {3.4842135285707693`*^9, 
   3.484213579198628*^9}, {3.4928396684718847`*^9, 3.49283968874683*^9}, {
   3.497010865557407*^9, 3.49701091094143*^9}, {3.49707071563795*^9, 
   3.4970707600007467`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Array Funs", "Section",
 CellChangeTimes->{{3.483357107734129*^9, 3.483357108859681*^9}}],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.4833565873457327`*^9, 3.483356588768901*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FunQ", "::", "usage"}], "=", 
     "\"\<Tests if an object is in IFun or LFun.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ListFunQ", "::", "usage"}], "=", 
     "\"\<Tests if an object is in IFun whose values are a list.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VectorFunQ", "::", "usage"}], "=", 
     "\"\<Tests if an object is in IFun whose values are a vector.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixFunQ", "::", "usage"}], "=", 
     "\"\<Tests if an object is in IFun whose values are a matrix.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ArrayFunQ", "::", "usage"}], "=", 
     "\"\<Tests if an object is in IFun whose values are an array.\>\""}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FunQ", "[", "_", "]"}], ":=", "False"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ListFunQ", "[", "_", "]"}], ":=", "False"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ScalarFunQ", "[", "_", "]"}], ":=", "False"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VectorFunQ", "[", "_", "]"}], ":=", "False"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixFunQ", "[", "_", "]"}], ":=", "False"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ArrayFunQ", "[", "_", "]"}], ":=", "False"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToMatrixOfFuns", "::", "usage"}], "=", 
     "\"\<Changes an IFun whose values are a matrix to a matrix of \
IFuns\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToMatrixFun", "::", "usage"}], "=", 
     "\"\<Changes a matrix of IFuns to an IFun whose values are a \
matrix\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ToArrayOfFuns", ";"}], "\[IndentingNewLine]", 
   RowBox[{"ToArrayFun", ";"}], "\[IndentingNewLine]", 
   RowBox[{"ReImLinePlot", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MeanZero", "::", "usage"}], "=", 
     "\"\<Subtracts out the mean of an IFun.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ZeroAtZero", ";"}], "\[IndentingNewLine]", 
   RowBox[{"ZeroAtRight", ";"}], "\[IndentingNewLine]", 
   RowBox[{"ZeroAtLeft", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{"FiniteValues", ";"}], "\[IndentingNewLine]", 
   RowBox[{"FiniteLength", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"FastPlus", ";"}], "\[IndentingNewLine]", 
   RowBox[{"FastTimes", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"LinePlot", ";"}], "\[IndentingNewLine]", 
   RowBox[{"ReImLineLogPlot", ";"}], "\[IndentingNewLine]", 
   RowBox[{"ReImLineLogLogPlot", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$FunFormat", "=", 
     RowBox[{"{", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ListFunQ", "[", 
      RowBox[{"f_", "?", "FunQ"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "//", "Values"}], "//", "First"}], "//", "ListQ"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ScalarFunQ", "[", 
      RowBox[{"f_", "?", "FunQ"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "//", "Values"}], "//", "First"}], "//", "ScalarQ"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VectorFunQ", "[", 
      RowBox[{"f_", "?", "FunQ"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "//", "Values"}], "//", "First"}], "//", "VectorQ"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixFunQ", "[", 
      RowBox[{"f_", "?", "FunQ"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "//", "Values"}], "//", "First"}], "//", "MatrixQ"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ArrayFunQ", "[", 
      RowBox[{"f_", "?", "FunQ"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "//", "Values"}], "//", "First"}], "//", "ArrayQ"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483356596386485*^9, 3.483356598416835*^9}, {
  3.4833566569789343`*^9, 3.483356657435404*^9}, {3.4842130606939077`*^9, 
  3.484213073494734*^9}, {3.484213583222377*^9, 3.484213636744729*^9}, {
  3.4842136750742283`*^9, 3.484213726510725*^9}, {3.4842141876697187`*^9, 
  3.4842141924127197`*^9}, {3.484313924589241*^9, 3.4843140637901163`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["List Funs", "Subsection",
 CellChangeTimes->{{3.483356836527091*^9, 3.4833568381271067`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ToMatrixOfFuns", "[", "f_", "]"}], ":=", 
     RowBox[{"MatrixMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "f", "]"}], "[", 
         RowBox[{"#", ",", 
          RowBox[{"Domain", "[", "f", "]"}]}], "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{"Values", "[", "f", "]"}], "//", "ToMatrixOfLists"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToMatrixFun", "[", "f_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{"First", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"f", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}], "]"}], "]"}], "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MatrixMap", "[", 
         RowBox[{"Values", ",", "f"}], "]"}], "//", "ToListOfMatrices"}], ",", 
       RowBox[{"Domain", "[", 
        RowBox[{"f", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToArrayOfFuns", "[", 
      RowBox[{"f_", "?", "MatrixFunQ"}], "]"}], ":=", 
     RowBox[{"ToMatrixOfFuns", "[", "f", "]"}]}], ";", 
    RowBox[{
     RowBox[{"ToArrayOfFuns", "[", 
      RowBox[{"f_", "?", "VectorFunQ"}], "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"IFun", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Domain", "[", "f", "]"}]}], "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{"Values", "[", "f", "]"}], "//", "ToArrayOfLists"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToArrayOfFuns", "[", 
      RowBox[{"f_", "?", "ScalarFunQ"}], "]"}], ":=", "f"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToArrayFun", "[", "f_", "]"}], ":=", 
     RowBox[{"IFun", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ArrayMap", "[", 
         RowBox[{"Values", ",", "f"}], "]"}], "//", "ToListOfArrays"}], ",", 
       RowBox[{"Domain", "[", 
        RowBox[{"First", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "f", "}"}], "]"}], "]"}], "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483356853005821*^9, 3.483356904346511*^9}, {
  3.483357414919457*^9, 3.4833574229500303`*^9}, {3.484213074168247*^9, 
  3.484213077414568*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Overrides", "Subsection",
 CellChangeTimes->{{3.483357282030779*^9, 3.483357283268436*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReImLinePlot", "[", 
    RowBox[{
     RowBox[{"f_", "?", "ArrayFunQ"}], ",", "opts___"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ArrayMap", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ReImLinePlot", "[", 
        RowBox[{"#", ",", "opts"}], "]"}], "&"}], ",", 
      RowBox[{"f", "//", "ToArrayOfFuns"}]}], "]"}], "//", "MatrixForm"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IFun", "/:", 
   RowBox[{
    RowBox[{"Derivative", "[", 
     RowBox[{"k_", "?", "Positive"}], "]"}], "[", 
    RowBox[{"f_IFun", "?", "ArrayFunQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ArrayMap", "[", 
     RowBox[{
      RowBox[{"Derivative", "[", "k", "]"}], ",", 
      RowBox[{"f", "//", "ToArrayOfFuns"}]}], "]"}], "//", "ToArrayFun"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483357118840065*^9, 3.4833571603752213`*^9}, {
  3.48335721024826*^9, 3.483357227750917*^9}, {3.4833577443262043`*^9, 
  3.483357744510509*^9}, {3.4842130785825243`*^9, 3.484213080896137*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["IFun", "Section",
 CellChangeTimes->{{3.4833507905786133`*^9, 3.483350820695446*^9}}],

Cell[CellGroupData[{

Cell["Basic ops", "Subsection",
 CellChangeTimes->{{3.483353028540855*^9, 3.483353030092792*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IFun", "[", 
     RowBox[{"l_List", ",", "d_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"ChebyshevLobattoBarycentricInterpolation", "[", 
    RowBox[{"l", ",", 
     RowBox[{"MapToInterval", "[", 
      RowBox[{"d", ",", "z"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IFun", "[", 
     RowBox[{
      RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", "d_", ",", "n_Integer"}],
      "]"}], ":=", 
    RowBox[{"IFun", "[", 
     RowBox[{
      RowBox[{"f", "/@", 
       RowBox[{"Points", "[", 
        RowBox[{"d", ",", "n"}], "]"}]}], ",", "d"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FunQ", "[", "_IFun", "]"}], ":=", "True"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Values", "[", 
    RowBox[{"IFun", "[", 
     RowBox[{"l_List", ",", "_"}], "]"}], "]"}], ":=", "l"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Domain", "[", 
     RowBox[{"IFun", "[", 
      RowBox[{"_List", ",", "d_"}], "]"}], "]"}], ":=", "d"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Length", "[", "if_IFun", "]"}], "^:=", 
   RowBox[{
    RowBox[{"if", "//", "Values"}], "//", "Length"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Points", "[", "if_IFun", "]"}], ":=", 
    RowBox[{"Points", "[", 
     RowBox[{
      RowBox[{"if", "//", "Domain"}], ",", 
      RowBox[{"if", "//", "Length"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixMap", "[", 
    RowBox[{"f_", ",", "g_IFun"}], "]"}], ":=", 
   RowBox[{"MatrixMap", "[", 
    RowBox[{"f", ",", 
     RowBox[{"g", "//", "ToMatrixOfFuns"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrayMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{"g_IFun", "?", "ScalarFunQ"}]}], "]"}], ":=", 
   RowBox[{"f", "[", "g", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ArrayMap", "[", 
     RowBox[{"f_", ",", "g_IFun"}], "]"}], ":=", 
    RowBox[{"ArrayMap", "[", 
     RowBox[{"f", ",", 
      RowBox[{"g", "//", "ToArrayOfFuns"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DCT", "[", 
    RowBox[{"f_IFun", "?", "ArrayFunQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ArrayMap", "[", 
     RowBox[{"DCT", ",", "f"}], "]"}], "//", "ToListOfArrays"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DCT", "[", "if_IFun", "]"}], ":=", 
    RowBox[{
     RowBox[{"if", "//", "Values"}], "//", "DCT"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IFun", "/:", 
   RowBox[{"Map", "[", 
    RowBox[{"f_", ",", "g_IFun"}], "]"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"f", "/@", 
      RowBox[{"Values", "[", "g", "]"}]}], ",", 
     RowBox[{"Domain", "[", "g", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FastPlus", "[", "f__IFun", "]"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{"Values", "/@", 
        RowBox[{"{", "f", "}"}]}], ")"}]}], ",", 
     RowBox[{"Domain", "[", 
      RowBox[{
       RowBox[{"{", "f", "}"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FastTimes", "[", "f__IFun", "]"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"(", 
       RowBox[{"Values", "/@", 
        RowBox[{"{", "f", "}"}]}], ")"}]}], ",", 
     RowBox[{"Domain", "[", 
      RowBox[{
       RowBox[{"{", "f", "}"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f_IFun", "+", "g_IFun"}], "^:=", 
   RowBox[{"f", "~", "FastPlus", "~", "g"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Times", "[", 
    RowBox[{"f_IFun", ",", "g_IFun"}], "]"}], "^:=", 
   RowBox[{"f", "~", "FastTimes", "~", "g"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IFun", "/:", 
   RowBox[{
    RowBox[{"f_", "?", "ConstantQ"}], "+", "g_IFun"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"f", "+", 
      RowBox[{"Values", "[", "g", "]"}]}], ",", 
     RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IFun", "/:", 
   RowBox[{"g_IFun", "+", 
    RowBox[{"f_", "?", "ConstantQ"}]}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Values", "[", "g", "]"}], "+", "f"}], ",", 
     RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IFun", "/:", 
   RowBox[{"Times", "[", 
    RowBox[{
     RowBox[{"f_", "?", "ConstantQ"}], ",", "g_IFun"}], "]"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"f", " ", 
      RowBox[{"Values", "[", "g", "]"}]}], ",", 
     RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IFun", "/:", 
   RowBox[{"Times", "[", 
    RowBox[{"g_IFun", ",", 
     RowBox[{"f_", "?", "ConstantQ"}]}], "]"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Values", "[", "g", "]"}], "f"}], ",", 
     RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IFun", "/:", 
   RowBox[{"f_IFun", "^", 
    RowBox[{"c_", "?", "ConstantQ"}]}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Values", "[", "f", "]"}], "^", "c"}], ",", 
     RowBox[{"f", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IFun", "/:", 
   RowBox[{
    RowBox[{"c_", "?", "ConstantQ"}], "^", "f_IFun"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"c", "^", 
      RowBox[{"Values", "[", "f", "]"}]}], ",", 
     RowBox[{"f", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"f_IFun", "?", "ArrayFunQ"}], ",", 
      RowBox[{"g_IFun", "?", "ArrayFunQ"}]}], "]"}], "^:=", 
    RowBox[{"ToArrayFun", "[", 
     RowBox[{
      RowBox[{"ToArrayOfFuns", "[", "f", "]"}], ".", 
      RowBox[{"ToArrayOfFuns", "[", "g", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IFun", "/:", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"f_List", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"ArrayFunQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
      RowBox[{"g_IFun", "?", "ArrayFunQ"}]}], "]"}], ":=", 
    RowBox[{"ToArrayFun", "[", 
     RowBox[{"f", ".", 
      RowBox[{"ToArrayOfFuns", "[", "g", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToValues", "[", "op_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"op", "[", "if_IFun", "]"}], "^:=", 
     RowBox[{"IFun", "[", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"Values", "[", "if", "]"}], "]"}], ",", 
       RowBox[{"if", "//", "Domain"}]}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapToValues", "/@", 
   RowBox[{"{", 
    RowBox[{
    "Abs", ",", "Arg", ",", "Re", ",", "Im", ",", "Conjugate", ",", "Exp", 
     ",", "Tan", ",", "ArcSin", ",", "Sec", ",", "Sin", ",", "Cos", ",", 
     "Log", ",", "ArcTanh"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", "if_IFun", "]"}], "^:=", 
   RowBox[{"Inverse", "/@", "if"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", "f_IFun", "]"}], "^:=", 
   RowBox[{"Transpose", "/@", "f"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Max", "[", "f_IFun", "]"}], "^:=", 
   RowBox[{
    RowBox[{"f", "//", "Values"}], "//", "Max"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Min", "[", "f_IFun", "]"}], "^:=", 
   RowBox[{
    RowBox[{"f", "//", "Values"}], "//", "Min"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Mean", "[", "f_IFun", "]"}], "^:=", 
    RowBox[{
     RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToIntervalD", "[", 
    RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapToIntervalD", "[", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{
      RowBox[{"f", "//", "Domain"}], ",", "z"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ComplexMapToInterval", "[", 
    RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"ComplexMapToInterval", "[", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ComplexMapToIntervalD", "[", 
     RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
    RowBox[{"ComplexMapToIntervalD", "[", 
     RowBox[{
      RowBox[{"f", "//", "Domain"}], ",", "z"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToIntervalSeriesAtInfinity", "[", 
     RowBox[{"f_IFun", ",", "s_"}], "]"}], ":=", 
    RowBox[{"MapToIntervalSeriesAtInfinity", "[", 
     RowBox[{
      RowBox[{"f", "//", "Domain"}], ",", "s"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InfinityInDomainQ", "[", "f_IFun", "]"}], ":=", 
   RowBox[{"InfinityInDomainQ", "[", 
    RowBox[{"Domain", "[", "f", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightEndpointInfinityQ", "[", "f_IFun", "]"}], ":=", 
   RowBox[{"RightEndpointInfinityQ", "[", 
    RowBox[{"Domain", "[", "f", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftEndpointInfinityQ", "[", "f_IFun", "]"}], ":=", 
   RowBox[{"LeftEndpointInfinityQ", "[", 
    RowBox[{"Domain", "[", "f", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftEndpoint", "[", "f_IFun", "]"}], ":=", 
   RowBox[{
    RowBox[{"f", "//", "Domain"}], "//", "LeftEndpoint"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightEndpoint", "[", "f_IFun", "]"}], ":=", 
   RowBox[{
    RowBox[{"f", "//", "Domain"}], "//", "RightEndpoint"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftContourArg", "[", "f_IFun", "]"}], ":=", 
   RowBox[{
    RowBox[{"f", "//", "Domain"}], "//", "LeftContourArg"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightContourArg", "[", "f_IFun", "]"}], ":=", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], "//", "RightContourArg"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"First", "[", "f_IFun", "]"}], "^:=", 
   RowBox[{
    RowBox[{"f", "//", "Values"}], "//", "First"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Last", "[", "f_IFun", "]"}], "^:=", 
   RowBox[{
    RowBox[{"f", "//", "Values"}], "//", "Last"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dimensions", "[", "f_IFun", "]"}], "^:=", 
   RowBox[{
    RowBox[{"f", "//", "First"}], "//", "Dimensions"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReverseOrientation", "[", "f_IFun", "]"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{"Values", "[", "f", "]"}], "]"}], ",", 
     RowBox[{"ReverseOrientation", "[", 
      RowBox[{"Domain", "[", "f", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IFun", "/:", 
   RowBox[{
    RowBox[{"f_IFun", "?", "MatrixFunQ"}], "\[LeftDoubleBracket]", 
    RowBox[{"i_", ",", "j_"}], "\[RightDoubleBracket]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"f", "//", "ToMatrixOfFuns"}], ")"}], "\[LeftDoubleBracket]", 
     RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "//", 
    "ToArrayFun"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IFun", "/:", 
    RowBox[{
     RowBox[{"f_IFun", "?", "ListFunQ"}], "\[LeftDoubleBracket]", "i_", 
     "\[RightDoubleBracket]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"f", "//", "ToArrayOfFuns"}], ")"}], "\[LeftDoubleBracket]", 
     "i", "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MeanZero", "[", "f_IFun", "]"}], ":=", 
   RowBox[{"f", "-", 
    RowBox[{"First", "[", 
     RowBox[{"DCT", "[", "f", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroAtZero", "[", "f_IFun", "]"}], "/;", 
    RowBox[{"OddQ", "[", 
     RowBox[{"Length", "[", "f", "]"}], "]"}]}], ":=", 
   RowBox[{"f", "-", 
    RowBox[{"f", "[", "0.", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroAtRight", "[", "f_", "]"}], ":=", 
   RowBox[{"f", "-", 
    RowBox[{"Last", "[", "f", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroAtLeft", "[", "f_", "]"}], ":=", 
   RowBox[{"f", "-", 
    RowBox[{"First", "[", "f", "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483350812166354*^9, 3.48335082335257*^9}, {
   3.483350877847248*^9, 3.483350930997191*^9}, 3.483350986470674*^9, {
   3.483351300103538*^9, 3.483351430770136*^9}, {3.4833515803586473`*^9, 
   3.4833516183528547`*^9}, {3.4833517545590067`*^9, 
   3.4833517864894323`*^9}, {3.483351852944139*^9, 3.483351918663783*^9}, {
   3.483351951687303*^9, 3.4833519982661667`*^9}, {3.483352181733685*^9, 
   3.483352282266302*^9}, {3.483352446645955*^9, 3.483352456844081*^9}, {
   3.483352515278224*^9, 3.4833528368956547`*^9}, {3.483352877015656*^9, 
   3.483352933327417*^9}, {3.4833530080437393`*^9, 3.48335301141365*^9}, {
   3.483353543466423*^9, 3.483353586418872*^9}, {3.483356620262637*^9, 
   3.483356630094211*^9}, {3.4833701489116783`*^9, 3.48337016350626*^9}, {
   3.483421845675194*^9, 3.4834219130182047`*^9}, {3.483421984358199*^9, 
   3.4834220476574697`*^9}, {3.48342244770286*^9, 3.483422457298358*^9}, {
   3.483422544714013*^9, 3.4834225592977247`*^9}, {3.483438996932592*^9, 
   3.483439018768381*^9}, {3.483440643593851*^9, 3.48344068540413*^9}, {
   3.483442288461852*^9, 3.4834423055308113`*^9}, {3.483454414760386*^9, 
   3.48345446853969*^9}, {3.483454811021137*^9, 3.483454819709587*^9}, {
   3.483454958063472*^9, 3.4834549849622107`*^9}, {3.48345674565522*^9, 
   3.483456761552747*^9}, {3.483530018403451*^9, 3.48353005790307*^9}, {
   3.48353011695616*^9, 3.483530128946239*^9}, {3.483535280730329*^9, 
   3.48353532791258*^9}, {3.483775004384644*^9, 3.483775030073434*^9}, {
   3.484213084604721*^9, 3.48421308897782*^9}, {3.484638394484399*^9, 
   3.4846384122880363`*^9}, {3.4847347249896593`*^9, 3.484734727315569*^9}, {
   3.49483284063314*^9, 3.494832852840321*^9}, {3.497272950012536*^9, 
   3.497272952050342*^9}, {3.497272984700521*^9, 3.497273003500057*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finite points and graphs", "Subsection",
 CellChangeTimes->{{3.483351999966769*^9, 3.48335202566986*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FinitePoints", "[", "if_IFun", "]"}], ":=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"if", "//", "Points"}], ",", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"InfinityQ", "[", "#", "]"}]}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FiniteValues", "[", "if_IFun", "]"}], ":=", 
     RowBox[{"Last", "/@", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Points", "[", "if", "]"}], ",", 
           RowBox[{"Values", "[", "if", "]"}]}], "}"}], "]"}], ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"InfinityQ", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FiniteLength", "[", "f_", "]"}], ":=", 
     RowBox[{
      RowBox[{"f", "//", "FinitePoints"}], "//", "Length"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FiniteRealPoints", "[", "if_IFun", "]"}], ":=", 
     RowBox[{
      RowBox[{"if", "//", "FinitePoints"}], "//", "Re"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LinePlot", "[", 
      RowBox[{"f_", ",", "opts___"}], "]"}], ":=", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FiniteRealPoints", "[", "f", "]"}], ",", 
          RowBox[{"FiniteValues", "[", "f", "]"}]}], "}"}], "]"}], ",", 
       "opts"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReImLinePlot", "[", 
      RowBox[{"f_", ",", "opts___"}], "]"}], ":=", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FiniteRealPoints", "[", "f", "]"}], ",", 
            RowBox[{
             RowBox[{"FiniteValues", "[", "f", "]"}], "//", "Re"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FiniteRealPoints", "[", "f", "]"}], ",", 
            RowBox[{
             RowBox[{"FiniteValues", "[", "f", "]"}], "//", "Im"}]}], "}"}], 
          "]"}]}], "}"}], ",", "opts"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReImLineLogPlot", "[", 
      RowBox[{"f_", ",", "opts___"}], "]"}], ":=", 
     RowBox[{"ListLineLogPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FiniteRealPoints", "[", "f", "]"}], ",", 
            RowBox[{
             RowBox[{"FiniteValues", "[", "f", "]"}], "//", "Re"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FiniteRealPoints", "[", "f", "]"}], ",", 
            RowBox[{
             RowBox[{"FiniteValues", "[", "f", "]"}], "//", "Im"}]}], "}"}], 
          "]"}]}], "}"}], ",", "opts"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReImLineLogLogPlot", "[", 
      RowBox[{"f_", ",", "opts___"}], "]"}], ":=", 
     RowBox[{"ListLineLogLogPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FiniteRealPoints", "[", "f", "]"}], ",", 
            RowBox[{
             RowBox[{"FiniteValues", "[", "f", "]"}], "//", "Re"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FiniteRealPoints", "[", "f", "]"}], ",", 
            RowBox[{
             RowBox[{"FiniteValues", "[", "f", "]"}], "//", "Im"}]}], "}"}], 
          "]"}]}], "}"}], ",", "opts"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LinePlot", "[", 
      RowBox[{"f_List", ",", "opts___"}], "]"}], ":=", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FiniteRealPoints", "[", "#", "]"}], ",", 
             RowBox[{"FiniteValues", "[", "#", "]"}]}], "}"}], "]"}], "&"}], 
         ",", "f"}], "]"}], ",", "opts"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LineLogPlot", "[", 
      RowBox[{"f_List", ",", "opts___"}], "]"}], ":=", 
     RowBox[{"ListLineLogPlot", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FiniteRealPoints", "[", "#", "]"}], ",", 
             RowBox[{"FiniteValues", "[", "#", "]"}]}], "}"}], "]"}], "&"}], 
         ",", "f"}], "]"}], ",", "opts"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{"f", ":", 
       RowBox[{"IFun", "[", 
        RowBox[{"l_List", ",", "_"}], "]"}]}], "]"}], ":=", 
     RowBox[{"ReImLinePlot", "[", 
      RowBox[{"f", ",", 
       RowBox[{"Sequence", "@@", "$FunFormat"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483352039401124*^9, 3.483352062072611*^9}, {
   3.4833521216213837`*^9, 3.483352126148597*^9}, {3.483356991645603*^9, 
   3.4833570055643682`*^9}, 3.483357100512883*^9, {3.48421308972243*^9, 
   3.484213093420948*^9}, {3.484213734464205*^9, 3.484213764212124*^9}, {
   3.493970999388257*^9, 3.493971008708922*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "::", "\<\"noctx\"\>"}], ":", 
  " ", "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"No previous context \
defined.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/End/noctx\\\", \
ButtonNote -> \\\"End::noctx\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4939709763470297`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Derivative", "Subsection",
 CellChangeTimes->{{3.483353035493946*^9, 3.483353036476404*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChebyshevD", "::", "usage"}], "=", 
   "\"\<Maps a list of Chebyshev coefficients to those of its \
derivative.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChebyshevLobattoDerivative", "::", "usage"}], "=", 
   "\"\<Maps a list of function values at Chebyshev points to those of its \
derivative.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChebyshevI", "::", "usage"}], "=", 
   "\"\<Maps a list of Chebyshev coefficients to those of its indefinite \
integral.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChebyshevLobattoIntegrate", "::", "usage"}], "=", 
   "\"\<Maps a list of function values at Chebyshev points to those of its \
indefinite integral.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChebyshevD", "[", "c_List", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "1"}], ",", 
         RowBox[{"{", "0", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"d", "[", "n", "]"}], "=", 
           RowBox[{
            RowBox[{"d", "[", 
             RowBox[{"n", "-", "1"}], "]"}], "=", "0"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", "k", "]"}], "=", 
             RowBox[{
              RowBox[{"d", "[", 
               RowBox[{"k", "+", "2"}], "]"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"k", "+", "1"}], ")"}], " ", 
               RowBox[{"c", "\[LeftDoubleBracket]", 
                RowBox[{"k", "+", "2"}], "\[RightDoubleBracket]"}]}]}]}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"n", "-", "2"}], ",", "1", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"d", "[", "0", "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", "2", "]"}], "/", "2"}], " ", "+", " ", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"#", "-", "1"}], "]"}], "&"}], ",", 
            RowBox[{"{", "n", "}"}]}], "]"}]}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChebyshevLobattoDerivative", "[", "c_List", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"InverseDCT", "[", 
     RowBox[{"ChebyshevD", "[", 
      RowBox[{"DCT", "[", "c", "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IFun", "/:", 
   RowBox[{
    RowBox[{"Derivative", "[", "0", "]"}], "[", "if_IFun", "]"}], ":=", 
   "if"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IFun", "/:", 
   RowBox[{
    RowBox[{"Derivative", "[", "1", "]"}], "[", "if_IFun", "]"}], ":=", 
   RowBox[{
    RowBox[{"IFun", "[", 
     RowBox[{
      RowBox[{"ChebyshevLobattoDerivative", "[", 
       RowBox[{"Values", "[", "if", "]"}], "]"}], " ", ",", 
      RowBox[{"if", "//", "Domain"}]}], "]"}], " ", 
    RowBox[{"IFun", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MapToIntervalD", "[", 
        RowBox[{"if", ",", "#"}], "]"}], "&"}], ",", 
      RowBox[{"if", "//", "Domain"}], ",", 
      RowBox[{"if", "//", "Length"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IFun", "/:", 
   RowBox[{
    RowBox[{"Derivative", "[", 
     RowBox[{"k_", "?", "Positive"}], "]"}], "[", "if_IFun", "]"}], ":=", 
   RowBox[{
    RowBox[{"Derivative", "[", "1", "]"}], "[", 
    RowBox[{
     RowBox[{"Derivative", "[", 
      RowBox[{"k", "-", "1"}], "]"}], "[", "if", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IFun", "/:", 
   RowBox[{"Derivative", "[", "if_IFun", "]"}], ":=", 
   RowBox[{"if", "'"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483353104595459*^9, 3.483353285758293*^9}, {
  3.48335371904615*^9, 3.4833537661478357`*^9}, {3.4833552014241467`*^9, 
  3.483355209604744*^9}, {3.484213094821862*^9, 3.484213095586375*^9}, {
  3.4842137664813004`*^9, 3.484213788731217*^9}, {3.4843140854498663`*^9, 
  3.484314164675178*^9}, {3.486399396259076*^9, 3.4863993963924637`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integrate", "Subsection",
 CellChangeTimes->{{3.483353782191738*^9, 3.483353783069309*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReduceDimension", "[", "f_IFun", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"f", "//", "DCT"}], "//", "Most"}], "//", "InverseDCT"}], ",", 
     
     RowBox[{"Domain", "[", "f", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReduceDimensionIntegrate", "[", "f_IFun", "]"}], ":=", 
    RowBox[{"ReduceDimension", "[", 
     RowBox[{"Integrate", "[", "f", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChebyshevI", "[", "c_List", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "c2", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c2", "=", 
        RowBox[{"ZeroVector", "[", 
         RowBox[{
          RowBox[{"Length", "[", "c", "]"}], "+", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"c2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "=", 
        RowBox[{"c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"c2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "=", 
        RowBox[{"c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "c", "]"}], ">", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
           "c2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "=", 
           
           RowBox[{
            RowBox[{
            "c", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/", 
            "4"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "c2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=", 
           
           RowBox[{
            RowBox[{
            "c2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
            RowBox[{
             RowBox[{
             "c", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/",
              "4"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"c2", "\[LeftDoubleBracket]", 
               RowBox[{"k", "+", "1"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{
               RowBox[{"c2", "\[LeftDoubleBracket]", 
                RowBox[{"k", "+", "1"}], "\[RightDoubleBracket]"}], "+", 
               RowBox[{
                RowBox[{
                "c", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
                "/", 
                RowBox[{"(", 
                 RowBox[{"2", "k"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{
              RowBox[{"c2", "\[LeftDoubleBracket]", 
               RowBox[{"k", "-", "1"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{
               RowBox[{"c2", "\[LeftDoubleBracket]", 
                RowBox[{"k", "-", "1"}], "\[RightDoubleBracket]"}], "-", 
               RowBox[{
                RowBox[{
                "c", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
                "/", 
                RowBox[{"(", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   RowBox[{"k", "-", "2"}], ")"}]}], ")"}]}]}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{
              "c2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "=", 
              RowBox[{
               RowBox[{
               "c2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], "^", "k"}], " ", 
                RowBox[{
                "c", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"1", "/", 
                   RowBox[{"(", 
                    RowBox[{"2", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "2"}], ")"}]}], ")"}]}], "-", 
                  RowBox[{"1", "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "k"}], ")"}]}]}], ")"}]}]}]}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "3", ",", 
              RowBox[{"Length", "[", "c", "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", "c2"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChebyshevLobattoIntegrate", "[", "c_List", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"InverseDCT", "[", 
     RowBox[{"ChebyshevI", "[", 
      RowBox[{"DCT", "[", "c", "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Integrate", "[", "if_IFun", "]"}], "^:=", 
    RowBox[{"IFun", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Values", "[", "if", "]"}], " ", 
         RowBox[{"Values", "[", 
          RowBox[{"IFun", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MapFromIntervalD", "[", 
              RowBox[{"if", ",", "#"}], "]"}], "&"}], ",", "UnitInterval", 
            ",", 
            RowBox[{"if", "//", "Length"}]}], "]"}], "]"}]}], ")"}], "//", 
       "ChebyshevLobattoIntegrate"}], ",", 
      RowBox[{"if", "//", "Domain"}]}], "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DomainIntegrate", "[", "if_IFun", "]"}], ":=", 
   RowBox[{
    RowBox[{"if", "//", "Integrate"}], "//", "Last"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DomainIntegrate", "[", 
    RowBox[{"{", "if__IFun", "}"}], "]"}], ":=", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{"DomainIntegrate", "/@", 
      RowBox[{"{", "if", "}"}]}], ")"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483353803448553*^9, 3.4833538433748283`*^9}, {
   3.4833539595230703`*^9, 3.48335398733048*^9}, {3.483354100498394*^9, 
   3.4833541733445463`*^9}, {3.4833543434009333`*^9, 
   3.4833543510951567`*^9}, {3.483354502228129*^9, 3.483354522304864*^9}, {
   3.483354611051683*^9, 3.483354639519751*^9}, 3.483355242969805*^9, {
   3.483423941106819*^9, 3.483423953906876*^9}, {3.483857512817984*^9, 
   3.483857556028566*^9}, {3.483857595598034*^9, 3.4838576039060373`*^9}, {
   3.48421309623915*^9, 3.4842130995317717`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Domain Plots", "Section",
 CellChangeTimes->{{3.48335616104325*^9, 3.48335616298706*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DomainPlot", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", 
         RowBox[{"b_", "?", "InfinityQ"}]}], "}"}], ",", "___"}], "]"}], ",", 
     "opts___"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Blue", ",", 
       RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
       RowBox[{"PointSize", "[", "Large", "]"}], ",", 
       RowBox[{"Point", "[", 
        RowBox[{"a", "//", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Re", "[", "#", "]"}], ",", 
            RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "//", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], ",", 
              RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], ",", 
          RowBox[{
           RowBox[{"a", "+", 
            RowBox[{"2", " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"Arg", "[", "b", "]"}]}], "]"}]}]}], "//", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], ",", 
              RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}]}], "}"}], 
        "]"}]}], "}"}], ",", "opts", ",", 
     RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DomainPlot", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a_", "?", "InfinityQ"}], ",", "b_"}], "}"}], ",", "___"}], 
      "]"}], ",", "opts___"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Blue", ",", 
       RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
       RowBox[{"PointSize", "[", "Large", "]"}], ",", 
       RowBox[{"Point", "[", 
        RowBox[{"b", "//", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Re", "[", "#", "]"}], ",", 
            RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"b", "+", 
            RowBox[{"2", " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"Arg", "[", "a", "]"}]}], "]"}]}]}], "//", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], ",", 
              RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], ",", 
          RowBox[{"b", "//", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], ",", 
              RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}]}], "}"}], 
        "]"}]}], "}"}], ",", "opts", ",", 
     RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DomainPlot", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", "___"}], "]"}], ",", 
     "opts___"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Blue", ",", 
       RowBox[{"PointSize", "[", "Large", "]"}], ",", 
       RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
       RowBox[{"Point", "[", 
        RowBox[{"a", "//", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Re", "[", "#", "]"}], ",", 
            RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Point", "[", 
        RowBox[{"b", "//", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Re", "[", "#", "]"}], ",", 
            RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "//", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], ",", 
              RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], ",", 
          RowBox[{"b", "//", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], ",", 
              RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}]}], "}"}], 
        "]"}]}], "}"}], ",", "opts", ",", 
     RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DomainPlot", "[", 
    RowBox[{
     RowBox[{"Arc", "[", 
      RowBox[{"z0_", ",", "r_", ",", 
       RowBox[{"{", 
        RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], ",", "opts___"}], "]"}], 
   ":=", "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Blue", ",", 
       RowBox[{"PointSize", "[", "Large", "]"}], ",", 
       RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Point", "[", 
        RowBox[{
         RowBox[{"z0", " ", "+", " ", 
          RowBox[{"r", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", "t0"}], "]"}]}]}], "//", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Re", "[", "#", "]"}], ",", 
            RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], " ", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Point", "[", 
        RowBox[{
         RowBox[{"z0", " ", "+", " ", 
          RowBox[{"r", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", "t1"}], "]"}]}]}], "//", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Re", "[", "#", "]"}], ",", 
            RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], " ", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"z0", "+", 
            RowBox[{"r", " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"(", 
                RowBox[{"t1", "-", 
                 RowBox[{"0.0001", " ", 
                  RowBox[{"Sign", "[", 
                   RowBox[{"t1", "-", "t0"}], "]"}]}]}], ")"}]}], "]"}]}]}], "//", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], ",", 
              RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], ",", 
          RowBox[{
           RowBox[{"z0", " ", "+", " ", 
            RowBox[{"r", " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", "t1"}], "]"}]}]}], "//", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], ",", 
              RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}]}], "}"}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"Circle", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Re", "[", "#", "]"}], ",", 
             RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}], "[", "z0", "]"}], 
         ",", "r", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t0", ",", "t1"}], "}"}], "//", "N"}], "//", "Sort"}]}], 
        "]"}]}], "}"}], ",", "opts", ",", 
     RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DomainPlot", "[", 
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{"z0_", ",", "r_"}], "]"}], ",", "opts___"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Thick", ",", "Blue", ",", 
        RowBox[{"PointSize", "[", "Large", "]"}], ",", 
        RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"z0", "+", 
             RowBox[{"r", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "0.2"}], "]"}]}]}], " ", "//", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Re", "[", "#", "]"}], ",", 
               RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], ",", 
           RowBox[{
            RowBox[{"z0", " ", "+", " ", 
             RowBox[{"r", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", "0.2001"}], "]"}]}]}], "//", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Re", "[", "#", "]"}], ",", 
               RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}]}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Circle", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], ",", 
              RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}], "[", "z0", "]"}],
           ",", "r"}], "]"}]}], "}"}], ",", "opts", ",", 
      RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DomainPlot", "[", 
     RowBox[{"ell_Ellipse", ",", "opts___"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ComplexPlot", "[", 
         RowBox[{
          RowBox[{"MapFromCircle", "[", 
           RowBox[{"ell", ",", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", " ", "t"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Thick"}]}], "]"}], ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue", ",", 
            RowBox[{"PointSize", "[", "Large", "]"}], ",", 
            RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"MapFromCircle", "[", 
                 RowBox[{"ell", ",", 
                  RowBox[{"Exp", "[", 
                   RowBox[{"I", " ", "0.2"}], "]"}]}], "]"}], "//", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Re", "[", "#", "]"}], ",", 
                   RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], ",", 
               RowBox[{
                RowBox[{"MapFromCircle", "[", 
                 RowBox[{"ell", ",", 
                  RowBox[{"Exp", "[", 
                   RowBox[{"I", " ", "0.2001"}], "]"}]}], "]"}], "//", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Re", "[", "#", "]"}], ",", 
                   RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}]}], "}"}], 
             "]"}]}], "}"}], ",", "opts", ",", 
          RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DomainPlot", "[", 
    RowBox[{"if_IFun", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"DomainPlot", "[", 
    RowBox[{
     RowBox[{"if", "//", "Domain"}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DomainPlot", "[", 
     RowBox[{"if_LFun", ",", "opts___"}], "]"}], ":=", 
    RowBox[{"DomainPlot", "[", 
     RowBox[{
      RowBox[{"if", "//", "Domain"}], ",", "opts"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DomainPlot", "[", 
    RowBox[{"l_List", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DomainPlot", "[", 
       RowBox[{"#", ",", "opts"}], "]"}], "&"}], "/@", "l"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.48335617075694*^9, 3.4833562715095873`*^9}, {
   3.483356310420053*^9, 3.4833563723859797`*^9}, {3.483423558109275*^9, 
   3.4834236312615747`*^9}, {3.4834239853700323`*^9, 3.483423986843719*^9}, {
   3.4834245366763353`*^9, 3.4834245494156446`*^9}, {3.48344189075259*^9, 
   3.483441906962291*^9}, {3.4837936522942467`*^9, 3.483793809396326*^9}, {
   3.483793844376672*^9, 3.4837938542141113`*^9}, {3.484041319048172*^9, 
   3.484041320707625*^9}, 3.484213100125162*^9, {3.4843142023332977`*^9, 
   3.484314211044437*^9}, {3.48533697468791*^9, 3.485336975328581*^9}, {
   3.487074740672673*^9, 3.4870748135754347`*^9}, {3.487074846543948*^9, 
   3.487074853214128*^9}, {3.497052243376128*^9, 3.497052358577112*^9}, {
   3.497052404055091*^9, 3.497052417223629*^9}, {3.497052533124929*^9, 
   3.497052535792292*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["LFun", "Section",
 CellChangeTimes->{{3.4833507905786133`*^9, 3.483350820695446*^9}, {
  3.483358067743087*^9, 3.483358067900124*^9}}],

Cell[CellGroupData[{

Cell["Basic ops", "Subsection",
 CellChangeTimes->{{3.483353028540855*^9, 3.483353030092792*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LFun", "[", 
     RowBox[{"l_List", ",", "d_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"MapDot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MapToCircle", "[", 
        RowBox[{"d", ",", "z"}], "]"}], "^", "#"}], "&"}], ",", 
     RowBox[{"FFT", "[", "l", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LFun", "[", 
     RowBox[{"f_", ",", "d_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"LFun", "[", 
     RowBox[{
      RowBox[{"f", "/@", 
       RowBox[{"MapFromCircle", "[", 
        RowBox[{"d", ",", 
         RowBox[{"Points", "[", 
          RowBox[{"UnitCircle", ",", "n"}], "]"}]}], "]"}]}], ",", "d"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FunQ", "[", "_LFun", "]"}], ":=", "True"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Values", "[", 
    RowBox[{"LFun", "[", 
     RowBox[{"l_List", ",", "_"}], "]"}], "]"}], ":=", "l"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Domain", "[", 
     RowBox[{"LFun", "[", 
      RowBox[{"_", ",", "d_"}], "]"}], "]"}], ":=", "d"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Length", "[", "if_LFun", "]"}], "^:=", 
   RowBox[{
    RowBox[{"if", "//", "Values"}], "//", "Length"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Points", "[", "if_LFun", "]"}], ":=", 
    RowBox[{"MapFromCircle", "[", 
     RowBox[{
      RowBox[{"if", "//", "Domain"}], ",", 
      RowBox[{"Points", "[", 
       RowBox[{"UnitCircle", ",", 
        RowBox[{"if", "//", "Length"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FFT", "[", "if_LFun", "]"}], ":=", 
    RowBox[{
     RowBox[{"if", "//", "Values"}], "//", "FFT"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LaurentCoefficients", "[", 
     RowBox[{"lf", ":", 
      RowBox[{"LFun", "[", 
       RowBox[{"_", ",", "_Circle"}], "]"}]}], "]"}], ":=", 
    RowBox[{"MapOuter", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"MapToCircle", "[", 
         RowBox[{"lf", ",", "1"}], "]"}], "^", "#"}], "&"}], ",", 
      RowBox[{"FFT", "[", "lf", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LFun", "/:", 
   RowBox[{"Map", "[", 
    RowBox[{"f_", ",", "g_LFun"}], "]"}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{
     RowBox[{"f", "/@", 
      RowBox[{"Values", "[", "g", "]"}]}], ",", 
     RowBox[{"Domain", "[", "g", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FastPlus", "[", "f__LFun", "]"}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{"Values", "/@", 
        RowBox[{"{", "f", "}"}]}], ")"}]}], ",", 
     RowBox[{"Domain", "[", 
      RowBox[{
       RowBox[{"{", "f", "}"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FastTimes", "[", "f__LFun", "]"}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"(", 
       RowBox[{"Values", "/@", 
        RowBox[{"{", "f", "}"}]}], ")"}]}], ",", 
     RowBox[{"Domain", "[", 
      RowBox[{
       RowBox[{"{", "f", "}"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f_LFun", "+", "g_LFun"}], "^:=", 
   RowBox[{"f", "~", "FastPlus", "~", "g"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Times", "[", 
    RowBox[{"f_LFun", ",", "g_LFun"}], "]"}], "^:=", 
   RowBox[{"f", "~", "FastTimes", "~", "g"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LFun", "/:", 
   RowBox[{
    RowBox[{"f_", "?", "ConstantQ"}], "+", "g_LFun"}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{
     RowBox[{"f", "+", 
      RowBox[{"Values", "[", "g", "]"}]}], ",", 
     RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LFun", "/:", 
   RowBox[{"g_LFun", "+", 
    RowBox[{"f_", "?", "ConstantQ"}]}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Values", "[", "g", "]"}], "+", "f"}], ",", 
     RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LFun", "/:", 
   RowBox[{"Times", "[", 
    RowBox[{
     RowBox[{"f_", "?", "ConstantQ"}], ",", "g_LFun"}], "]"}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{
     RowBox[{"f", " ", 
      RowBox[{"Values", "[", "g", "]"}]}], ",", 
     RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LFun", "/:", 
   RowBox[{"Times", "[", 
    RowBox[{"g_LFun", ",", 
     RowBox[{"f_", "?", "ConstantQ"}]}], "]"}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Values", "[", "g", "]"}], "f"}], ",", 
     RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LFun", "/:", 
   RowBox[{"f_LFun", "^", 
    RowBox[{"c_", "?", "ConstantQ"}]}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Values", "[", "f", "]"}], "^", "c"}], ",", 
     RowBox[{"f", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LFun", "/:", 
    RowBox[{
     RowBox[{"c_", "?", "ConstantQ"}], "^", "f_LFun"}], ":=", 
    RowBox[{"LFun", "[", 
     RowBox[{
      RowBox[{"c", "^", 
       RowBox[{"Values", "[", "f", "]"}]}], ",", 
      RowBox[{"f", "//", "Domain"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LMapToValues", "[", "op_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"op", "[", "if_LFun", "]"}], "^:=", 
     RowBox[{"LFun", "[", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{"Values", "[", "if", "]"}], "]"}], ",", 
       RowBox[{"if", "//", "Domain"}]}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LMapToValues", "/@", 
    RowBox[{"{", 
     RowBox[{
     "Abs", ",", "Arg", ",", "Re", ",", "Im", ",", "Conjugate", ",", "Exp", 
      ",", "Tan", ",", "ArcSin", ",", "Sec", ",", "Sin", ",", "Cos", ",", 
      "Log", ",", "ArcTanh"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Max", "[", "f_LFun", "]"}], "^:=", 
   RowBox[{
    RowBox[{"f", "//", "Values"}], "//", "Max"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Min", "[", "f_LFun", "]"}], "^:=", 
   RowBox[{
    RowBox[{"f", "//", "Values"}], "//", "Min"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Mean", "[", "f_LFun", "]"}], "^:=", 
    RowBox[{
     RowBox[{"FFT", "[", "f", "]"}], "\[LeftDoubleBracket]", "0", 
     "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MeanZero", "[", "f_LFun", "]"}], "^:=", 
    RowBox[{"f", "-", 
     RowBox[{"Mean", "[", "f", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircle", "[", 
    RowBox[{"f_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapToCircle", "[", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircleD", "[", 
    RowBox[{"f_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapToCircleD", "[", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{"f_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapFromCircle", "[", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircleD", "[", 
    RowBox[{"f_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapFromCircleD", "[", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], ",", "z"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483350812166354*^9, 3.48335082335257*^9}, {
   3.483350877847248*^9, 3.483350930997191*^9}, 3.483350986470674*^9, {
   3.483351300103538*^9, 3.483351430770136*^9}, {3.4833515803586473`*^9, 
   3.4833516183528547`*^9}, {3.4833517545590067`*^9, 
   3.4833517864894323`*^9}, {3.483351852944139*^9, 3.483351918663783*^9}, {
   3.483351951687303*^9, 3.4833519982661667`*^9}, {3.483352181733685*^9, 
   3.483352282266302*^9}, {3.483352446645955*^9, 3.483352456844081*^9}, {
   3.483352515278224*^9, 3.4833528368956547`*^9}, {3.483352877015656*^9, 
   3.483352933327417*^9}, {3.4833530080437393`*^9, 3.48335301141365*^9}, {
   3.483353543466423*^9, 3.483353586418872*^9}, {3.483356620262637*^9, 
   3.483356630094211*^9}, {3.483358085483878*^9, 3.483358097879388*^9}, {
   3.483358140117008*^9, 3.483358165942245*^9}, {3.483358228039433*^9, 
   3.483358351726206*^9}, {3.483359091650475*^9, 3.483359101721353*^9}, {
   3.483359132755368*^9, 3.4833591409973583`*^9}, {3.484213101012703*^9, 
   3.484213104626405*^9}, {3.4850795534051447`*^9, 3.485079594401326*^9}, {
   3.4852387058894033`*^9, 3.485238715470031*^9}, {3.496991355106161*^9, 
   3.4969913886781273`*^9}, {3.496991448329032*^9, 3.4969914553384237`*^9}, {
   3.4969914995685*^9, 3.496991516034853*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finite points and graphs", "Subsection",
 CellChangeTimes->{{3.483351999966769*^9, 3.48335202566986*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FinitePoints", "[", "if_LFun", "]"}], ":=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"if", "//", "Points"}], ",", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"InfinityQ", "[", "#", "]"}]}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FiniteValues", "[", "if_LFun", "]"}], ":=", 
     RowBox[{"Last", "/@", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Points", "[", "if", "]"}], ",", 
           RowBox[{"Values", "[", "if", "]"}]}], "}"}], "]"}], ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"InfinityQ", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FiniteLength", "[", "f_", "]"}], ":=", 
     RowBox[{
      RowBox[{"f", "//", "FinitePoints"}], "//", "Length"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FiniteRealPoints", "[", "if_LFun", "]"}], ":=", 
     RowBox[{
      RowBox[{"if", "//", "FinitePoints"}], "//", "Re"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FiniteRealPoints", "[", "if_IFun", "]"}], "/;", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"LeftEndpoint", "[", "if", "]"}], "]"}], "~", "NEqual", "~", 
       RowBox[{"Re", "[", 
        RowBox[{"RightEndpoint", "[", "if", "]"}], "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{"if", "//", "FinitePoints"}], "//", "Im"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$FunFormat", "=", 
     RowBox[{"{", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{"f", ":", 
       RowBox[{"LFun", "[", 
        RowBox[{"l_List", ",", "_"}], "]"}]}], "]"}], ":=", 
     RowBox[{"ReImLinePlot", "[", 
      RowBox[{"f", ",", 
       RowBox[{"Sequence", "@@", "$FunFormat"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483352039401124*^9, 3.483352062072611*^9}, {
   3.4833521216213837`*^9, 3.483352126148597*^9}, {3.483356991645603*^9, 
   3.4833570055643682`*^9}, 3.483357100512883*^9, {3.483358636183907*^9, 
   3.483358669165689*^9}, {3.483860642919132*^9, 3.48386068480976*^9}, {
   3.484213105326469*^9, 3.484213106742607*^9}, {3.493971014162521*^9, 
   3.493971023319751*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivative", "Subsection",
 CellChangeTimes->{{3.483353035493946*^9, 3.483353036476404*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LFun", "/:", 
     RowBox[{
      RowBox[{"Derivative", "[", "0", "]"}], "[", "if_LFun", "]"}], ":=", 
     "if"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LFun", "/:", 
     RowBox[{
      RowBox[{"Derivative", "[", "1", "]"}], "[", "f_LFun", "]"}], ":=", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"LFun", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PadRight", "[", 
          RowBox[{
           RowBox[{"ShiftLeft", "[", 
            RowBox[{"MapOuter", "[", 
             RowBox[{
              RowBox[{"#", "&"}], ",", 
              RowBox[{"FFT", "[", "f", "]"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", "f", "]"}], "+", "2"}]}], "]"}], "//", 
         "InverseFFT"}], ",", 
        RowBox[{"Domain", "[", "f", "]"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"#", " ", 
        RowBox[{"LFun", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MapToCircleD", "[", 
            RowBox[{"f", ",", "#"}], "]"}], "&"}], ",", 
          RowBox[{"f", "//", "Domain"}], ",", 
          RowBox[{"#", "//", "Length"}]}], "]"}]}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LFun", "/:", 
     RowBox[{
      RowBox[{"Derivative", "[", 
       RowBox[{"k_", "?", "Positive"}], "]"}], "[", "if_LFun", "]"}], ":=", 
     RowBox[{
      RowBox[{"Derivative", "[", "1", "]"}], "[", 
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"k", "-", "1"}], "]"}], "[", "if", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LFun", "/:", 
     RowBox[{"Derivative", "[", "if_LFun", "]"}], ":=", 
     RowBox[{"if", "'"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DomainIntegrate", "[", 
      RowBox[{"if_LFun", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Domain", "[", "#", "]"}], "\[Equal]", "RealLine"}], "&"}], 
        ")"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Values", "[", "if", "]"}], " ", 
           RowBox[{"Values", "[", 
            RowBox[{"LFun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", "\[Equal]", 
                  RowBox[{"-", "1."}]}], ",", "0", ",", 
                 RowBox[{"MapFromCircleD", "[", 
                  RowBox[{"if", ",", "#"}], "]"}]}], "]"}], "&"}], ",", 
              "UnitCircle", ",", 
              RowBox[{"if", "//", "Length"}]}], "]"}], "]"}]}], ")"}], "//", 
         "FFT"}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", " ", "\[Pi]", "\[NonBreakingSpace]", "I"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DomainIntegrate", "[", "if_LFun", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Values", "[", "if", "]"}], " ", 
           RowBox[{"Values", "[", 
            RowBox[{"LFun", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"MapFromCircleD", "[", 
                RowBox[{"if", ",", "#"}], "]"}], "&"}], ",", "UnitCircle", 
              ",", 
              RowBox[{"if", "//", "Length"}]}], "]"}], "]"}]}], ")"}], "//", 
         "FFT"}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", " ", "\[Pi]", "\[NonBreakingSpace]", "I"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483353104595459*^9, 3.483353285758293*^9}, {
  3.48335371904615*^9, 3.4833537661478357`*^9}, {3.4833552014241467`*^9, 
  3.483355209604744*^9}, {3.48335870011001*^9, 3.483358744702181*^9}, {
  3.483358820405746*^9, 3.483358883408209*^9}, {3.483359199082526*^9, 
  3.483359212626307*^9}, {3.484213815706768*^9, 3.484213819920042*^9}, {
  3.4955322005345078`*^9, 3.495532265648736*^9}, {3.4955323432598743`*^9, 
  3.495532350079324*^9}, {3.4955326370443907`*^9, 3.495532664981474*^9}, {
  3.497053891735265*^9, 3.497053972214673*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "::", "\<\"noctx\"\>"}], ":", 
  " ", "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"No previous context \
defined.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/End/noctx\\\", \
ButtonNote -> \\\"End::noctx\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4955326679979773`*^9, 3.497053929149234*^9, 
  3.4970539769602118`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[PlusMinus] Eval", "Subsection",
 CellChangeTimes->{{3.483363904698044*^9, 3.4833639084967422`*^9}, {
  3.4833639812684307`*^9, 3.483363981707456*^9}}],

Cell[BoxData[{
 RowBox[{"NegativePart", ";"}], "\[IndentingNewLine]", 
 RowBox[{"NonNegativePart", ";"}], "\[IndentingNewLine]", 
 RowBox[{"PositivePart", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NonPositivePart", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"NonNegativeEvaluate", ";"}], "\[IndentingNewLine]", 
 RowBox[{"NegativeEvaluate", ";"}], "\[IndentingNewLine]", 
 RowBox[{"PositiveEvaluate", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NonPositiveEvaluate", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NegativePart", "[", "lf_LFun", "]"}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"lf", "//", "FFT"}], "//", "NegativeShiftList"}], "//", 
      "InverseFFT"}], ",", 
     RowBox[{"lf", "//", "Domain"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NonNegativePart", "[", "lf_LFun", "]"}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"lf", "//", "FFT"}], "//", "NonNegativeShiftList"}], "//", 
      "InverseFFT"}], ",", 
     RowBox[{"lf", "//", "Domain"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PositivePart", "[", "lf_LFun", "]"}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"lf", "//", "FFT"}], "//", "PositiveShiftList"}], "//", 
      "InverseFFT"}], ",", 
     RowBox[{"lf", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NonPositivePart", "[", "lf_LFun", "]"}], ":=", 
    RowBox[{"LFun", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"lf", "//", "FFT"}], "//", "NonPositiveShiftList"}], "//", 
       "InverseFFT"}], ",", 
      RowBox[{"lf", "//", "Domain"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NonNegativeEvaluate", "[", 
     RowBox[{"f_LFun", ",", "z_"}], "]"}], "/;", 
    RowBox[{"NZeroQ", "[", 
     RowBox[{"MapToCircle", "[", 
      RowBox[{"f", ",", "z"}], "]"}], "]"}]}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"f", "//", "FFT"}], ")"}], "\[LeftDoubleBracket]", "0", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NonNegativeEvaluate", "[", 
    RowBox[{"f_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapDot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MapToCircle", "[", 
        RowBox[{"f", ",", "z"}], "]"}], "^", "#"}], "&"}], ",", 
     RowBox[{
      RowBox[{"f", "//", "FFT"}], "//", "NonNegativeShiftList"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NegativeEvaluate", "[", 
     RowBox[{"f_LFun", ",", "z_"}], "]"}], "/;", 
    RowBox[{"InfinityQ", "[", 
     RowBox[{"MapToCircle", "[", 
      RowBox[{"f", ",", "z"}], "]"}], "]"}]}], ":=", 
   RowBox[{"0", " ", 
    RowBox[{"First", "[", 
     RowBox[{"Values", "[", "f", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NegativeEvaluate", "[", 
    RowBox[{"f_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapDot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MapToCircle", "[", 
        RowBox[{"f", ",", "z"}], "]"}], "^", "#"}], "&"}], ",", 
     RowBox[{
      RowBox[{"f", "//", "FFT"}], "//", "NegativeShiftList"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PositiveEvaluate", "[", 
    RowBox[{"f_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapDot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MapToCircle", "[", 
        RowBox[{"f", ",", "z"}], "]"}], "^", "#"}], "&"}], ",", 
     RowBox[{
      RowBox[{"f", "//", "FFT"}], "//", "PositiveShiftList"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PositiveEvaluate", "[", 
     RowBox[{"f_LFun", ",", "z_"}], "]"}], "/;", 
    RowBox[{"NZeroQ", "[", 
     RowBox[{"MapToCircle", "[", 
      RowBox[{"f", ",", "z"}], "]"}], "]"}]}], ":=", 
   RowBox[{"0", " ", 
    RowBox[{"First", "[", 
     RowBox[{"Values", "[", "f", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NonPositiveEvaluate", "[", 
    RowBox[{"f_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapDot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MapToCircle", "[", 
        RowBox[{"f", ",", "z"}], "]"}], "^", "#"}], "&"}], ",", 
     RowBox[{
      RowBox[{"f", "//", "FFT"}], "//", "NonPositiveShiftList"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NonPositiveEvaluate", "[", 
     RowBox[{"f_LFun", ",", "z_"}], "]"}], "/;", 
    RowBox[{"InfinityQ", "[", 
     RowBox[{"MapToCircle", "[", 
      RowBox[{"f", ",", "z"}], "]"}], "]"}]}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"f", "//", "FFT"}], ")"}], "\[LeftDoubleBracket]", "0", 
    "\[RightDoubleBracket]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483363916647043*^9, 3.4833640526048326`*^9}, {
  3.483943507822102*^9, 3.483943575180575*^9}, {3.483943612219314*^9, 
  3.483943744187881*^9}, {3.4842131073386497`*^9, 3.4842131104928217`*^9}, {
  3.484213824517642*^9, 3.484213870510972*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Conversion", "Section",
 CellChangeTimes->{{3.483359306242362*^9, 3.4833593079933233`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LFun", "[", "f_IFun", "]"}], ":=", 
     RowBox[{"LFun", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Values", "[", "f", "]"}], ",", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"Values", "[", "f", "]"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       "UnitCircle"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToUnitCircle", "[", "lf_LFun", "]"}], ":=", 
     RowBox[{"LFun", "[", 
      RowBox[{
       RowBox[{"Values", "[", "lf", "]"}], ",", "UnitCircle"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToUnitInterval", "[", "lf_IFun", "]"}], ":=", 
     RowBox[{"IFun", "[", 
      RowBox[{
       RowBox[{"Values", "[", "lf", "]"}], ",", "UnitInterval"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.48335939105831*^9, 3.483359443871398*^9}, {
   3.4833636301617603`*^9, 3.483363709684456*^9}, {3.483365109086899*^9, 
   3.483365123233575*^9}, {3.483417288920186*^9, 3.483417315604308*^9}, 
   3.4834239580124903`*^9, {3.483424032494875*^9, 3.483424038605085*^9}, {
   3.484213111243266*^9, 3.484213111799402*^9}, {3.484213862538981*^9, 
   3.484213863082179*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Adaptive", "Section",
 CellChangeTimes->{{3.474036523272689*^9, 3.47403652484798*^9}, 
   3.483369968265069*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChopDrop", "[", 
    RowBox[{"cf_IFun", ",", "prec_"}], "]"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"InverseDCT", "[", 
      RowBox[{
       RowBox[{"ChopDrop", "[", 
        RowBox[{
         RowBox[{"cf", "//", "DCT"}], ",", "prec"}], "]"}], "//", 
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{"0", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
           "}"}], ",", "True", ",", "#"}], "]"}], "&"}]}], "]"}], ",", 
     RowBox[{"Domain", "[", "cf", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChopDrop", "[", "cf_IFun", "]"}], ":=", 
    RowBox[{"IFun", "[", 
     RowBox[{
      RowBox[{"InverseDCT", "[", 
       RowBox[{
        RowBox[{"ChopDrop", "[", 
         RowBox[{"cf", "//", "DCT"}], "]"}], "//", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"0", " ", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}],
             "}"}], ",", "True", ",", "#"}], "]"}], "&"}]}], "]"}], ",", 
      RowBox[{"Domain", "[", "cf", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChopDrop", "[", 
    RowBox[{"cf_LFun", ",", "prec_"}], "]"}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ChopDrop", "[", 
         RowBox[{
          RowBox[{"cf", "//", "FFT"}], ",", "prec"}], "]"}], "//", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"ShiftList", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{"IndexRange", "[", "#", "]"}], "\[Equal]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"ShiftList", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}],
                ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"0", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "0", 
                 "\[RightDoubleBracket]"}]}]}], "}"}], ",", "2"}], "]"}], ",",
            "True", ",", "#"}], "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"SetIndexRange", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Max", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{"IndexRange", "[", "#", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", 
              RowBox[{"IndexRange", "[", "#", "]"}], "]"}], "]"}]}], "}"}]}], 
         "]"}], "&"}]}], "//", "InverseFFT"}], ",", 
     RowBox[{"cf", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChopDrop", "[", "cf_LFun", "]"}], ":=", 
    RowBox[{"LFun", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ChopDrop", "[", 
          RowBox[{"cf", "//", "FFT"}], "]"}], "//", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"ShiftList", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "2"}], "]"}], 
            ",", 
            RowBox[{
             RowBox[{"IndexRange", "[", "#", "]"}], "\[Equal]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
            RowBox[{"ShiftList", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"0", " ", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "0", 
                  "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"0", " ", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "0", 
                  "\[RightDoubleBracket]"}]}]}], "}"}], ",", "2"}], "]"}], 
            ",", "True", ",", "#"}], "]"}], "&"}]}], "//", 
        RowBox[{
         RowBox[{"SetIndexRange", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Max", "[", 
               RowBox[{"Abs", "[", 
                RowBox[{"IndexRange", "[", "#", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{"IndexRange", "[", "#", "]"}], "]"}], "]"}]}], "}"}]}],
           "]"}], "&"}]}], "//", "InverseFFT"}], ",", 
      RowBox[{"cf", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AdaptiveIFun", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"InterpolationPrecision", "\[Rule]", "$MachineTolerance"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AdaptiveIFun", "[", 
     RowBox[{"m_Integer", ",", "f_", ",", "d_", ",", 
      RowBox[{"pars", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "prec", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"prec", "=", 
        RowBox[{
         RowBox[{"InterpolationPrecision", "/.", 
          RowBox[{"{", "pars", "}"}]}], "/.", 
         RowBox[{"Options", "[", "AdaptiveIFun", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"IFun", "[", 
           RowBox[{"f", ",", "d", ",", "m"}], "]"}], "//", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"DCT", "[", "#", "]"}], "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "//", 
                  "Flatten"}], "//", "Abs"}], "//", "Max"}], ")"}], "<", 
              RowBox[{"prec", " ", 
               RowBox[{"(", 
                RowBox[{"Max", "[", 
                 RowBox[{"$MachineTolerance", ",", 
                  RowBox[{"Norm", "/@", 
                   RowBox[{"Values", "[", "#", "]"}]}]}], "]"}], ")"}]}]}], 
             ",", "#", ",", 
             RowBox[{"AdaptiveIFun", "[", 
              RowBox[{
               RowBox[{"2", "m"}], ",", "f", ",", "d", ",", "pars"}], "]"}]}],
             "]"}], "&"}]}], "//", 
         RowBox[{
          RowBox[{"ChopDrop", "[", 
           RowBox[{"#", ",", 
            RowBox[{"prec", " ", 
             RowBox[{"(", 
              RowBox[{"Max", "[", 
               RowBox[{"$MachineTolerance", ",", 
                RowBox[{"Norm", "/@", 
                 RowBox[{"Values", "[", "#", "]"}]}]}], "]"}], ")"}]}]}], 
           "]"}], "&"}]}], "//", 
        RowBox[{
         RowBox[{"IFun", "[", 
          RowBox[{"f", ",", "d", ",", 
           RowBox[{"Length", "[", "#", "]"}]}], "]"}], "&"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AdaptiveLFun", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"InterpolationPrecision", "\[Rule]", "$MachineTolerance"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AdaptiveLFun", "[", 
     RowBox[{"m_Integer", ",", "f_", ",", "d_", ",", 
      RowBox[{"pars", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "prec", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"prec", "=", 
        RowBox[{
         RowBox[{"InterpolationPrecision", "/.", 
          RowBox[{"{", "pars", "}"}]}], "/.", 
         RowBox[{"Options", "[", "AdaptiveLFun", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LFun", "[", 
        RowBox[{"f", ",", "\[IndentingNewLine]", "d", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"ChopDrop", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"LFun", "[", 
              RowBox[{"f", ",", "d", ",", "m"}], "]"}], "//", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToList", "[", 
                    RowBox[{"FFT", "[", "#", "]"}], "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", 
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "2"}]}], "}"}], "\[RightDoubleBracket]"}], "//",
                     "Flatten"}], "//", "Abs"}], "//", "Max"}], ")"}], "<", 
                 "prec"}], ",", "#", ",", 
                RowBox[{"AdaptiveLFun", "[", 
                 RowBox[{
                  RowBox[{"2", "m"}], ",", "f", ",", "d", ",", "pars"}], 
                 "]"}]}], "]"}], "&"}]}], ",", "prec"}], "]"}], "]"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", "d_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"AdaptiveIFun", "[", 
    RowBox[{"4", ",", "f", ",", "d", ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LFun", "[", 
     RowBox[{
      RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", "d_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"AdaptiveLFun", "[", 
     RowBox[{"8", ",", "f", ",", "d", ",", "opts"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.474035775577231*^9, 3.474035987864354*^9}, {
   3.474036019002137*^9, 3.474036093093234*^9}, {3.4740364689824457`*^9, 
   3.4740364961546383`*^9}, {3.474036760016651*^9, 3.4740367617974052`*^9}, {
   3.474036855649918*^9, 3.474036857000949*^9}, {3.474036980592698*^9, 
   3.474037123285651*^9}, 3.4740373642436037`*^9, {3.474097570580873*^9, 
   3.4740975844645567`*^9}, {3.474208679140645*^9, 3.474208680072769*^9}, {
   3.474210821627788*^9, 3.474210872915141*^9}, {3.474888594741364*^9, 
   3.474888605900641*^9}, {3.475238233997864*^9, 3.4752382569267807`*^9}, {
   3.475252382064433*^9, 3.4752524146186743`*^9}, {3.47731605552514*^9, 
   3.477316055733725*^9}, {3.477316124834956*^9, 3.47731612730411*^9}, {
   3.481018619637477*^9, 3.48101863985886*^9}, {3.48102074230964*^9, 
   3.481020748693557*^9}, {3.483369969307438*^9, 3.4833700147832727`*^9}, {
   3.4833701868186293`*^9, 3.483370304992483*^9}, {3.4833704123102703`*^9, 
   3.483370426132512*^9}, {3.483370682995695*^9, 3.4833706886936197`*^9}, {
   3.483374153510399*^9, 3.483374168866235*^9}, {3.4833744203145237`*^9, 
   3.48337442055938*^9}, {3.483374527597877*^9, 3.483374529322722*^9}, {
   3.483871180052124*^9, 3.483871180192601*^9}, {3.483942636191736*^9, 
   3.483942698080391*^9}, {3.483942768784499*^9, 3.483942898506122*^9}, {
   3.483942930904917*^9, 3.483942963659463*^9}, {3.483943031927639*^9, 
   3.483943078408636*^9}, {3.483943138831491*^9, 3.4839432090164013`*^9}, {
   3.484213917188714*^9, 3.4842139188963223`*^9}, {3.484312186492405*^9, 
   3.4843121886742163`*^9}, {3.4868137918742857`*^9, 
   3.4868138466663513`*^9}, {3.48681388192935*^9, 3.4868139540982037`*^9}, {
   3.486814096235469*^9, 3.4868140982125273`*^9}, {3.486814129931013*^9, 
   3.486814162491341*^9}, {3.4868142176070538`*^9, 3.486814218941963*^9}, {
   3.486816435021593*^9, 3.486816443061062*^9}, {3.487440852371088*^9, 
   3.4874409352531223`*^9}, {3.4941375887537727`*^9, 3.494137598678265*^9}, {
   3.494169644427272*^9, 3.494169692664863*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "::", "\<\"noctx\"\>"}], ":", 
  " ", "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"No previous context \
defined.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/End/noctx\\\", \
ButtonNote -> \\\"End::noctx\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.486814163663795*^9, 3.486814219692659*^9, 
  3.4868164459207783`*^9, 3.4874408984899263`*^9, 3.487440936774788*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Value List", "Section",
 CellChangeTimes->{{3.473083838769656*^9, 3.473083844319007*^9}, {
  3.473096714361272*^9, 3.473096716152658*^9}}],

Cell[BoxData[{
 RowBox[{"ToArrayOfListOfFuns", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToListOfArrayFuns", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToValueList", ";"}], "\[IndentingNewLine]", 
 RowBox[{"FromValueList", ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixMultVectorFun", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RightMatrixMultVectorFun", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RightMatrixMultMatrixFun", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixMultMatrixFun", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"TransformMatrix", ";"}], "\[IndentingNewLine]", 
 RowBox[{"DerivativeMatrix", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FiniteTransformMatrix", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroAtInfinityIFun", "[", 
    RowBox[{"ls_List", ",", 
     RowBox[{"d_", "?", "LeftEndpointInfinityQ"}]}], "]"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", " ", 
         RowBox[{
         "ls", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "}"}], ",", "ls"}], "]"}], ",", "d"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroAtInfinityIFun", "[", 
    RowBox[{"ls_List", ",", 
     RowBox[{"d_", "?", "RightEndpointInfinityQ"}]}], "]"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"ls", ",", 
       RowBox[{"{", 
        RowBox[{"0", " ", 
         RowBox[{
         "ls", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "}"}]}], "]"}], ",", "d"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroAtInfinityIFun", "[", 
     RowBox[{"ls_List", ",", "d_"}], "]"}], ":=", 
    RowBox[{"IFun", "[", 
     RowBox[{"ls", ",", "d"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToArrayOfListOfFuns", "[", "f_List", "]"}], ":=", 
   RowBox[{"ToArrayOfLists", "[", 
    RowBox[{"ToArrayOfFuns", "/@", "f"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToListOfArrayFuns", "[", "f_List", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{"ToArrayFun", "/@", 
      RowBox[{"Thread", "[", "f", "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToValueList", "[", "GI_List", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ArrayMap", "[", 
       RowBox[{"FiniteValues", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ToArrayOfFuns", "/@", "GI"}], "//", "ToArrayOfLists"}], 
      ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToValueList", "[", 
     RowBox[{"f_", "?", "FunQ"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ArrayMap", "[", 
      RowBox[{"FiniteValues", ",", 
       RowBox[{"ToArrayOfFuns", "[", "f", "]"}]}], "]"}], "//", "Flatten"}]}],
    ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FromValueList", "[", 
    RowBox[{
     RowBox[{"f_", "?", "ScalarFunQ"}], ",", "ls_"}], "]"}], ":=", 
   RowBox[{"ZeroAtInfinityIFun", "[", 
    RowBox[{"ls", ",", 
     RowBox[{"Domain", "[", "f", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FromValueList", "[", 
    RowBox[{
     RowBox[{"f_", "?", "VectorFunQ"}], ",", "ls_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ZeroAtInfinityIFun", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Domain", "[", "f", "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Partition", "[", 
      RowBox[{"ls", ",", 
       RowBox[{"FiniteLength", "[", "f", "]"}]}], "]"}]}], "//", 
    "ToArrayFun"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FromValueList", "[", 
     RowBox[{
      RowBox[{"f_", "?", "MatrixFunQ"}], ",", "ls_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"MatrixMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ZeroAtInfinityIFun", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Domain", "[", "f", "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"PartitionList", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"ls", ",", 
           RowBox[{"FiniteLength", "[", "f", "]"}]}], "]"}], ",", 
         RowBox[{"f", "//", "Dimensions"}]}], "]"}]}], "]"}], "//", 
     "ToArrayFun"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FromValueList", "[", 
     RowBox[{
      RowBox[{"GI_List", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"VectorFunQ", "[", 
          RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], ")"}]}], ",", 
      "ls_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"ZeroAtInfinityIFun", "[", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"Domain", "[", 
         RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], "]"}], "&"}], "/@", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"GI", ",", 
        RowBox[{"ToListOfArrays", "/@", "\[IndentingNewLine]", 
         RowBox[{"Thread", "[", 
          RowBox[{"PartitionList", "[", 
           RowBox[{
            RowBox[{"PartitionList", "[", 
             RowBox[{"ls", ",", 
              RowBox[{"Flatten", "[", 
               RowBox[{"ArrayMap", "[", 
                RowBox[{"FiniteLength", ",", 
                 RowBox[{"ToArrayOfListOfFuns", "[", "GI", "]"}]}], "]"}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"ToArrayOfLists", "[", 
              RowBox[{"ToArrayOfFuns", "/@", "GI"}], "]"}]}]}], "]"}], 
          "]"}]}]}], "}"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FromValueList", "[", 
     RowBox[{
      RowBox[{"GI_List", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MatrixFunQ", "[", 
          RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], ")"}]}], ",", 
      "ls_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"ZeroAtInfinityIFun", "[", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"Domain", "[", 
         RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"GI", ",", 
        RowBox[{"ToListOfMatrices", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"PartitionList", "[", 
            RowBox[{
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{"PartitionList", "[", 
                RowBox[{"ls", ",", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"ArrayMap", "[", 
                   RowBox[{"FiniteLength", ",", 
                    RowBox[{"ToArrayOfListOfFuns", "[", "GI", "]"}]}], "]"}], 
                  "]"}]}], "]"}], ",", 
               RowBox[{"Length", "[", "GI", "]"}]}], "]"}], ",", 
             RowBox[{"Dimensions", "[", 
              RowBox[{"First", "[", "GI", "]"}], "]"}]}], "]"}], "//", 
           "ToListOfMatrices"}], ")"}]}]}], "}"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FromValueList", "[", 
     RowBox[{
      RowBox[{"GI_List", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ScalarFunQ", "[", 
          RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], ")"}]}], ",", 
      "ls_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"ZeroAtInfinityIFun", "[", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"Domain", "[", 
         RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"GI", ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{"ls", ",", 
          RowBox[{"FiniteLength", "/@", "GI"}]}], "]"}]}], "}"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixMultVectorFun", "[", "G_List", "]"}], ":=", 
    RowBox[{"Join", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"RightJoin", "@@", "#"}], "&"}], "/@", 
       RowBox[{"MatrixMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SparseDiagonalMatrix", "[", 
           RowBox[{"ToValueList", "[", "#", "]"}], "]"}], "&"}], ",", 
         RowBox[{"G", "//", "ToArrayOfListOfFuns"}]}], "]"}]}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightMatrixMultVectorFun", "[", "G_List", "]"}], ":=", 
    RowBox[{"MatrixMultVectorFun", "[", 
     RowBox[{"Transpose", "/@", "G"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightMatrixMultMatrixFun", "[", "G_List", "]"}], ":=", 
    RowBox[{"BlockDiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MatrixMultVectorFun", "[", 
        RowBox[{"Transpose", "/@", 
         RowBox[{"(", "G", ")"}]}], "]"}], ",", 
       RowBox[{"MatrixMultVectorFun", "[", 
        RowBox[{"Transpose", "/@", 
         RowBox[{"(", "G", ")"}]}], "]"}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixMultMatrixFun", "[", "G_List", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"RightJoin", "@@", 
       RowBox[{"(", 
        RowBox[{"SparseDiagonalMatrix", "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], " ", 
             RowBox[{"MatrixMap", "[", 
              RowBox[{"ToValueList", ",", 
               RowBox[{"G", "//", "ToArrayOfListOfFuns"}]}], "]"}]}], "]"}], 
           ",", "1"}], "]"}]}], ")"}]}], ")"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{"RightJoin", "@@", 
       RowBox[{"(", 
        RowBox[{"SparseDiagonalMatrix", "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Reverse", "/@", 
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], " ", 
              RowBox[{"MatrixMap", "[", 
               RowBox[{"ToValueList", ",", 
                RowBox[{"G", "//", "ToArrayOfListOfFuns"}]}], "]"}]}], 
             "]"}]}], ",", "1"}], "]"}]}], ")"}]}], ")"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{"RightJoin", "@@", 
       RowBox[{"(", 
        RowBox[{"SparseDiagonalMatrix", "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], 
             RowBox[{"Reverse", "[", " ", 
              RowBox[{"MatrixMap", "[", 
               RowBox[{"ToValueList", ",", 
                RowBox[{"G", "//", "ToArrayOfListOfFuns"}]}], "]"}], "]"}]}], 
            "]"}], ",", "1"}], "]"}]}], ")"}]}], ")"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{"RightJoin", "@@", 
       RowBox[{"(", 
        RowBox[{"SparseDiagonalMatrix", "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Reverse", "/@", 
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], 
              RowBox[{"Reverse", "[", " ", 
               RowBox[{"MatrixMap", "[", 
                RowBox[{"ToValueList", ",", 
                 RowBox[{"G", "//", "ToArrayOfListOfFuns"}]}], "]"}], "]"}]}],
              "]"}]}], ",", "1"}], "]"}]}], ")"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.473096730716428*^9, 3.4730967441951*^9}, {
   3.473099526243023*^9, 3.473099537919195*^9}, {3.4731000809233923`*^9, 
   3.473100142397484*^9}, {3.473100193866753*^9, 3.4731001941056423`*^9}, {
   3.47310027864179*^9, 3.473100309750576*^9}, {3.473101356817292*^9, 
   3.473101370243711*^9}, {3.473101410714446*^9, 3.473101456148327*^9}, {
   3.473101498763423*^9, 3.473101505000099*^9}, {3.473101553793117*^9, 
   3.473101563291766*^9}, {3.473101896770516*^9, 3.4731019167294416`*^9}, {
   3.473102013149777*^9, 3.4731020709728107`*^9}, {3.4731031023470993`*^9, 
   3.473103107069096*^9}, {3.473103378109933*^9, 3.473103383174313*^9}, {
   3.473159398048666*^9, 3.473159398975093*^9}, {3.473159438261609*^9, 
   3.473159442932281*^9}, {3.4731634443300743`*^9, 3.473163444482799*^9}, {
   3.4731639426872997`*^9, 3.4731639801180143`*^9}, {3.47316555542665*^9, 
   3.4731655697780933`*^9}, {3.473166506149234*^9, 3.473166526267873*^9}, {
   3.4731666120311317`*^9, 3.473166622412496*^9}, {3.473166683845372*^9, 
   3.4731666840978403`*^9}, {3.473167414263929*^9, 3.473167450842231*^9}, {
   3.4731677667735033`*^9, 3.47316782247386*^9}, {3.473167856578377*^9, 
   3.473167930268104*^9}, {3.4731679998218*^9, 3.473168010722261*^9}, {
   3.4735084813708477`*^9, 3.4735084967582283`*^9}, {3.475846746135805*^9, 
   3.475846746293288*^9}, {3.483451006995565*^9, 3.483451007798764*^9}, {
   3.483451088268886*^9, 3.483451254494029*^9}, {3.483451312742113*^9, 
   3.4834513716434383`*^9}, {3.483451452673127*^9, 3.483451479505025*^9}, {
   3.4834516090375767`*^9, 3.483451614220043*^9}, 3.483451721505829*^9, {
   3.4834517718061132`*^9, 3.483451830311635*^9}, {3.483451878831801*^9, 
   3.48345190458639*^9}, {3.4834542856043386`*^9, 3.4834542941380653`*^9}, 
   3.483454385059978*^9, {3.483454562939279*^9, 3.4834546192055483`*^9}, {
   3.483454703448241*^9, 3.4834547146954937`*^9}, {3.4835352485554943`*^9, 
   3.483535250379033*^9}, {3.484213112554517*^9, 3.484213117613285*^9}, {
   3.484213921115374*^9, 3.484213992139248*^9}, {3.4874842310994368`*^9, 
   3.4874842321789637`*^9}, {3.4874845637285023`*^9, 3.487484567058283*^9}, 
   3.487484692955558*^9, {3.487484953425606*^9, 3.487484954197157*^9}, {
   3.4930286489950333`*^9, 3.493028649565748*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Transform Matrix", "Section",
 CellChangeTimes->{{3.483505425396306*^9, 3.483505431475411*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TransformMatrix", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"ColumnMap", "[", 
    RowBox[{"DCT", ",", 
     RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TransformMatrix", "[", 
    RowBox[{"_", ",", "n_Integer"}], "]"}], ":=", 
   RowBox[{"TransformMatrix", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TransformMatrix", "[", "f_", "]"}], ":=", 
   RowBox[{"TransformMatrix", "[", 
    RowBox[{"f", "//", "Length"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FiniteTransformMatrix", "[", 
    RowBox[{
     RowBox[{"d_", "?", "LeftEndpointInfinityQ"}], ",", "n_Integer"}], "]"}], 
   ":=", 
   RowBox[{
    RowBox[{"TransformMatrix", "[", "n", "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", 
     RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FiniteTransformMatrix", "[", 
    RowBox[{
     RowBox[{"d_", "?", "RightEndpointInfinityQ"}], ",", "n_Integer"}], "]"}],
    ":=", 
   RowBox[{
    RowBox[{"TransformMatrix", "[", "n", "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", 
     RowBox[{";;", 
      RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FiniteTransformMatrix", "[", 
    RowBox[{"_", ",", "n_Integer"}], "]"}], ":=", 
   RowBox[{"TransformMatrix", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FiniteTransformMatrix", "[", "f_", "]"}], ":=", 
   RowBox[{"FiniteTransformMatrix", "[", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], ",", 
     RowBox[{"f", "//", "Length"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DerivativeMatrix", "[", "1", "]"}], "[", 
    RowBox[{"d_", ",", "n_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapToIntervalD", "[", 
     RowBox[{"d", ",", 
      RowBox[{"Points", "[", 
       RowBox[{"d", ",", "n"}], "]"}]}], "]"}], 
    RowBox[{"ColumnMap", "[", 
     RowBox[{"ChebyshevLobattoDerivative", ",", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DerivativeMatrix", "[", "1", "]"}], "[", "f_", "]"}], ":=", 
   RowBox[{
    RowBox[{"DerivativeMatrix", "[", "1", "]"}], "[", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], ",", 
     RowBox[{"f", "//", "Length"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DerivativeMatrix", "[", "k_Integer", "]"}], "[", "pars__", "]"}],
    ":=", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DerivativeMatrix", "[", "1", "]"}], "[", "pars", "]"}], ",", 
     "k"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeMatrix", "[", 
    RowBox[{"d_", ",", "n_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DerivativeMatrix", "[", "1", "]"}], "[", 
    RowBox[{"d", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DerivativeMatrix", "[", 
     RowBox[{"f_", "?", "FunQ"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"DerivativeMatrix", "[", "1", "]"}], "[", "f", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DiagonalMatrix", "[", "f_IFun", "]"}], "^:=", 
   RowBox[{
    RowBox[{"f", "//", "Values"}], "//", "DiagonalMatrix"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IdentityMatrix", "[", "f_IFun", "]"}], "^:=", 
   RowBox[{
    RowBox[{"f", "//", "Length"}], "//", "IdentityMatrix"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.48350543420284*^9, 3.483505548579411*^9}, {
   3.483505920980666*^9, 3.4835059680385103`*^9}, {3.483701625689651*^9, 
   3.4837016667799463`*^9}, 3.483701737903455*^9, {3.484213119119396*^9, 
   3.484213119567383*^9}, {3.491637064682308*^9, 3.491637225993536*^9}, {
   3.49163726515784*^9, 3.49163727298698*^9}, {3.491637428282514*^9, 
   3.4916374308417053`*^9}, {3.491637475275908*^9, 3.491637573534903*^9}, {
   3.491637611654057*^9, 3.491637629936039*^9}, 3.491637697355856*^9, {
   3.497924176496698*^9, 3.497924204468904*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.491637683138454*^9, 3.491637696286406*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Roots", "Section",
 CellChangeTimes->{{3.47894581625465*^9, 3.478945816793881*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ComplexRoots", "[", 
     RowBox[{"cf_IFun", "?", "UnitIntervalFunQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "dct", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dct", "=", 
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"cf", "//", "DCT"}], ",", "$MachineTolerance"}], "]"}], "//",
          "RemoveZeros"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dct", "]"}], "<=", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Length", "[", "dct", "]"}], "\[Equal]", "2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
            "dct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "/", 
           RowBox[{
           "dct", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "}"}], ",", "\[IndentingNewLine]", "True", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"PadLeft", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"dct", "//", "Most"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"dct", "//", "Last"}], ")"}]}], ")"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "dct", "]"}], "-", "1"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", "dct", "]"}], "-", "1"}]}], "}"}]}], 
             "]"}]}], "+", 
           RowBox[{"(", 
            RowBox[{"SparseArray", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", "1"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
                  RowBox[{"j", "\[Equal]", 
                   RowBox[{"i", "+", "1"}]}]}], "\[Rule]", "0.5"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
                  RowBox[{"j", "\[Equal]", 
                   RowBox[{"i", "-", "1"}]}]}], "\[Rule]", "0.5"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "dct", "]"}], "-", "1"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", "dct", "]"}], "-", "1"}]}], "}"}]}], 
             "]"}], ")"}]}], "//", "Eigenvalues"}]}], "]"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ComplexRoots", "[", "cf_IFun", "]"}], ":=", 
    RowBox[{"MapFromInterval", "[", 
     RowBox[{"cf", ",", 
      RowBox[{
       RowBox[{"cf", "//", "ToUnitInterval"}], "//", "ComplexRoots"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Roots", "[", "cf_IFun", "]"}], "^:=", "\[IndentingNewLine]", 
    RowBox[{"MapFromInterval", "[", 
     RowBox[{"cf", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"cf", "//", "ToUnitInterval"}], "//", "ComplexRoots"}], 
          ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"Im", "[", "#", "]"}], "]"}], "<", 
              RowBox[{"100", "$MachineTolerance"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1."}], "\[LessEqual]", 
              RowBox[{"Re", "[", "#", "]"}], "\[LessEqual]", "1."}], ")"}]}], 
           "&"}]}], "]"}], "//", "Re"}], "//", "Sort"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ComplexRoots", "[", "lf_LFun", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "dct", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dct", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{"lf", "//", "FFT"}], ",", "$MachineTolerance"}], "]"}], "//",
           "RemoveZeros"}], "//", "ToList"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MapFromCircle", "[", 
        RowBox[{"lf", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"SparseArray", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
                  RowBox[{"j", "\[Equal]", 
                   RowBox[{"i", "-", "1"}]}]}], "\[Rule]", "1"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "dct", "]"}], "-", "1"}], ",", " ", 
                  
                  RowBox[{
                   RowBox[{"Length", "[", "dct", "]"}], "-", "2"}]}], "}"}]}],
                "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"{", 
                RowBox[{"Most", "[", "dct", "]"}], "}"}]}], "/", 
              RowBox[{"Last", "[", "dct", "]"}]}]}], "]"}], "//", 
           "Transpose"}], "//", "Eigenvalues"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Roots", "[", "lf_LFun", "]"}], "^:=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "dct", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dct", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{"lf", "//", "FFT"}], ",", "$MachineTolerance"}], "]"}], "//",
           "RemoveZeros"}], "//", "ToList"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MapFromCircle", "[", 
        RowBox[{"lf", ",", "\[IndentingNewLine]", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"SparseArray", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
                    RowBox[{"j", "\[Equal]", 
                    RowBox[{"i", "-", "1"}]}]}], "\[Rule]", "1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "dct", "]"}], "-", "1"}], ",", " ", 
                    RowBox[{
                    RowBox[{"Length", "[", "dct", "]"}], "-", "2"}]}], 
                   "}"}]}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"{", 
                  RowBox[{"Most", "[", "dct", "]"}], "}"}]}], "/", 
                RowBox[{"Last", "[", "dct", "]"}]}]}], "]"}], "//", 
             "Transpose"}], "//", "Eigenvalues"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"Abs", "[", "#", "]"}], "-", "1"}], "]"}], "<", 
             RowBox[{"10.", "^", 
              RowBox[{"(", 
               RowBox[{"-", "6"}], ")"}]}]}], "&"}]}], "]"}]}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Minimize", "[", "cf_IFun", "]"}], "^:=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cf", "'"}], "//", "Roots"}], ",", 
         RowBox[{"Endpoints", "[", "cf", "]"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"cf", "/@", "#"}], "//", "Abs"}], ",", "#"}], "}"}], 
         "]"}], "&"}]}], "//", "Sort"}], "//", "First"}], "//", "Second"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4789459027970753`*^9, 3.4789459704619713`*^9}, {
   3.478946013855628*^9, 3.478946043491737*^9}, {3.4789462238548803`*^9, 
   3.478946230574432*^9}, {3.478947313704776*^9, 3.478947326625637*^9}, {
   3.479122297106867*^9, 3.4791223244076223`*^9}, {3.479122386625576*^9, 
   3.4791223895025053`*^9}, {3.483337566403657*^9, 3.483337663251597*^9}, {
   3.483338325945608*^9, 3.483338327496827*^9}, {3.4852448704438343`*^9, 
   3.485244885796268*^9}, {3.485245312772583*^9, 3.485245358103043*^9}, {
   3.485245723752804*^9, 3.485245754327861*^9}, {3.48524579164633*^9, 
   3.485245800421247*^9}, {3.485245894417157*^9, 3.485245895529755*^9}, {
   3.485245987106523*^9, 3.4852459975974092`*^9}, 3.485246363849628*^9, {
   3.4947435675003767`*^9, 3.494743589545515*^9}, {3.494766455994582*^9, 
   3.4947664796467047`*^9}, {3.4952665334766817`*^9, 
   3.4952665528723392`*^9}, {3.497010603191907*^9, 3.497010658180678*^9}, {
   3.497164182144596*^9, 3.497164415433519*^9}, {3.497164447815051*^9, 
   3.4971644509139442`*^9}, {3.4971647395252666`*^9, 3.497164740547826*^9}, {
   3.497164897903748*^9, 3.497164899188628*^9}, {3.497166286097805*^9, 
   3.497166383105126*^9}, {3.49716641616777*^9, 3.49716641663021*^9}, {
   3.498227505505344*^9, 3.498227507919443*^9}, 3.5001782018571453`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fun Chain", "Section",
 CellChangeTimes->{{3.485246418190384*^9, 3.485246418652227*^9}, {
  3.485348073042902*^9, 3.485348073490803*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Fun", "[", 
     RowBox[{
      RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", 
      RowBox[{"l", ":", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}], ",", "___"}], "]"}]}], ",", 
      "opts___"}], "]"}], ":=", 
    RowBox[{"IFun", "[", 
     RowBox[{"f", ",", "l", ",", "opts"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fun", "[", 
    RowBox[{
     RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"l", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "___"}], "}"}]}], ",", "Lopts___"}], 
      "]"}], ",", "n_List"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"IFun", "[", 
       RowBox[{"f", ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Or", "@@", 
              RowBox[{"(", 
               RowBox[{"InfinityQ", "/@", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                ")"}]}], ",", 
             RowBox[{"{", "Lopts", "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}]}], "]"}], ",", 
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
        "]"}], "&"}], "/@", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"l", ",", "2", ",", "1"}], "]"}], ",", "n"}], "}"}], "]"}]}],
     "//", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "#"}], "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fun", "[", 
    RowBox[{
     RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"l", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "___"}], "}"}]}], ",", "Lopts___"}], 
      "]"}], ",", "n_Integer"}], "]"}], ":=", 
   RowBox[{"Fun", "[", 
    RowBox[{"f", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"l", ",", "Lopts"}], "]"}], ",", 
     RowBox[{"n", " ", 
      RowBox[{"OneVector", "[", 
       RowBox[{
        RowBox[{"Length", "[", "l", "]"}], "-", "1"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fun", "[", 
    RowBox[{
     RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"l", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "___"}], "}"}]}], ",", "Lopts___"}], 
      "]"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"IFun", "[", 
       RowBox[{"f", ",", 
        RowBox[{"Line", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Or", "@@", 
              RowBox[{"(", 
               RowBox[{"InfinityQ", "/@", "#"}], ")"}]}], ",", 
             RowBox[{"{", "Lopts", "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}]}], "]"}], ",", "opts"}], "]"}], 
      "&"}], "/@", 
     RowBox[{"Partition", "[", 
      RowBox[{"l", ",", "2", ",", "1"}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "#"}], "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fun", "[", 
    RowBox[{
     RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", "d_Circle", ",", 
     "opts___"}], "]"}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{"f", ",", "d", ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fun", "[", 
    RowBox[{
     RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", "d_Line", ",", 
     "opts___"}], "]"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{"f", ",", "d", ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fun", "[", 
    RowBox[{
     RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", "d_Arc", ",", "opts___"}],
     "]"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{"f", ",", "d", ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Fun", "[", 
     RowBox[{
      RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", "d_Curve", ",", 
      "opts___"}], "]"}], ":=", 
    RowBox[{"IFun", "[", 
     RowBox[{"f", ",", "d", ",", "opts"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Fun", "[", 
     RowBox[{
      RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", "l_List", ",", 
      "n_List"}], "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Fun", "[", 
        RowBox[{"f", ",", 
         RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "]"}],
        "&"}], "/@", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{"l", ",", "n"}], "}"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Fun", "[", 
     RowBox[{
      RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", "l_List", ",", 
      "opts___"}], "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Fun", "[", 
        RowBox[{"f", ",", "#", ",", "opts"}], "]"}], "&"}], "/@", "l"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroAtInfinityFun", "[", 
     RowBox[{
      RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", "d_", ",", "opts___"}], 
     "]"}], ":=", 
    RowBox[{"Fun", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"InfinityQ", "[", "#", "]"}], ",", 
         RowBox[{"0", " ", 
          RowBox[{"f", "[", "0.", "]"}]}], ",", 
         RowBox[{
          RowBox[{"f", "[", "#", "]"}], "/.", 
          RowBox[{
           RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0"}]}]}], "]"}], 
       "&"}], ",", "d", ",", "opts"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IdentityAtInfinityFun", "[", 
     RowBox[{
      RowBox[{"G_", "?", "NotListOrPatternQ"}], ",", "pars___"}], "]"}], ":=", 
    RowBox[{"Fun", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"InfinityQ", "[", "#", "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"G", "[", "0.", "]"}], "//", "MatrixQ"}], ",", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "[", 
             RowBox[{"G", "[", "0.", "]"}], "]"}], "]"}], ",", "1"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"G", "[", "#", "]"}], "/.", 
          RowBox[{
           RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0"}]}]}], "]"}], 
       "&"}], ",", "pars"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroAtInfinityIFun", "[", 
     RowBox[{
      RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", "d_", ",", "opts___"}], 
     "]"}], ":=", 
    RowBox[{"IFun", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"InfinityQ", "[", "#", "]"}], ",", 
         RowBox[{"0", " ", 
          RowBox[{"f", "[", "0.", "]"}]}], ",", 
         RowBox[{
          RowBox[{"f", "[", "#", "]"}], "/.", 
          RowBox[{
           RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0"}]}]}], "]"}], 
       "&"}], ",", "d", ",", "opts"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IdentityAtInfinityIFun", "[", 
     RowBox[{
      RowBox[{"G_", "?", "NotListOrPatternQ"}], ",", "pars___"}], "]"}], ":=", 
    RowBox[{"IFun", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"InfinityQ", "[", "#", "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"G", "[", "0.", "]"}], "//", "MatrixQ"}], ",", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "[", 
             RowBox[{"G", "[", "0.", "]"}], "]"}], "]"}], ",", "1"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"G", "[", "#", "]"}], "/.", 
          RowBox[{
           RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0"}]}]}], "]"}], 
       "&"}], ",", "pars"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroAtInfinityLFun", "[", 
    RowBox[{
     RowBox[{"f_", "?", "NotListOrPatternQ"}], ",", "d_", ",", "opts___"}], 
    "]"}], ":=", 
   RowBox[{"LFun", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"InfinityQ", "[", "#", "]"}], ",", 
        RowBox[{"0", " ", 
         RowBox[{"f", "[", "0.", "]"}]}], ",", 
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], "/.", 
         RowBox[{
          RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0"}]}]}], "]"}], "&"}],
      ",", "d", ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzk0swnEAh/HmgKyhDqk0xrwsm6nWarOFZOMUU7Y0my2ruVlH5mbrUGKG
rIwlh5xq1lTamAul4YAD6cLKv5exNfMy5eX37fDsc32a9DOjhjIajcYlQTb3
ZW7tM6OwcqRmGIkIbbCCk1yGRnf7rIP4pYmVVB1cMJzEhJtdDX2tFPOUOBCk
6iCPcdN8RizPbwpgPBARwr1kRgSf+CwZvD3f7IZD+7Z6ZiGj6OxNldSaEo1Q
Eg6KoCV3PQJ7jlXjULy1MAmrdCI9dPnjqwbi/TdvHTJNj0Ir8e6ZksJtSYBv
qcwqPvqrWyBveOptkTh2qX6HVwKvzUFMsxpWoF0nt8O+XJcDepV/IScxX8s5
gksTrig0Tw/GYHejPAU9u1oKio2vG3niyc+vC2oExRBURumHcMf3UAjTs4q2
TlkRzvs9VEcN+Sio0/Afg2TXxw==
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["FunList methods", "Section",
 CellChangeTimes->{{3.4874817020350847`*^9, 3.487481705546548*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FunListDot", "[", 
    RowBox[{"f_", ",", "g_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ".", 
      RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     "&"}], "/@", 
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{"f", ",", "g"}], "}"}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4874817068818274`*^9, 3.4874817408282948`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plots", "Section",
 CellChangeTimes->{{3.487663743717039*^9, 3.487663744218933*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DCTPlot", "[", 
    RowBox[{"f_IFun", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"ListLineLogPlot", "[", 
    RowBox[{
     RowBox[{"Norm", "/@", 
      RowBox[{"(", 
       RowBox[{"f", "//", "DCT"}], ")"}]}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FFTPlot", "[", 
    RowBox[{"f_LFun", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"ListLineLogPlot", "[", 
    RowBox[{
     RowBox[{"Norm", "/@", 
      RowBox[{"(", 
       RowBox[{"f", "//", "FFT"}], ")"}]}], ",", "opts"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4876637455081663`*^9, 3.4876637817399893`*^9}, {
  3.493060974331949*^9, 3.493060987531814*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curve Fun", "Section",
 CellChangeTimes->{{3.494762376844779*^9, 3.4947623779948263`*^9}}],

Cell[CellGroupData[{

Cell["Line Curve", "Subsection",
 CellChangeTimes->{{3.497578250652198*^9, 3.497578253242104*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DomainQ", "[", "_Curve", "]"}], ":=", "True"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr_IFun", "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapDot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ChebyshevT", "[", 
       RowBox[{
        RowBox[{"#", "-", "1"}], ",", "z"}], "]"}], "&"}], ",", 
     RowBox[{"DCT", "[", "cr", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromIntervalD", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr_IFun", "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapDot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ChebyshevT", "[", 
       RowBox[{
        RowBox[{"#", "-", "1"}], ",", "z"}], "]"}], "&"}], ",", 
     RowBox[{"DCT", "[", 
      RowBox[{"cr", "'"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr_", "]"}], ",", 
     RowBox[{"z_", "?", "InfinityQ"}]}], "]"}], ":=", "z"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr_", "]"}], ",", 
     RowBox[{"z_", "?", "InfinityQ"}]}], "]"}], ":=", "z"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToInterval", "[", 
     RowBox[{
      RowBox[{"Curve", "[", "cr_", "]"}], ",", "z_"}], "]"}], "/;", 
    RowBox[{"z", "~", "NEqual", "~", 
     RowBox[{"First", "[", "cr", "]"}]}]}], ":=", 
   RowBox[{"-", "1."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToInterval", "[", 
     RowBox[{
      RowBox[{"Curve", "[", "cr_", "]"}], ",", "z_"}], "]"}], "/;", 
    RowBox[{"z", "~", "NEqual", "~", 
     RowBox[{"Last", "[", "cr", "]"}]}]}], ":=", "1."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr_", "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"cr", "-", "z"}], "//", "Roots"}], "//", "First"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToIntervalD", "[", 
    RowBox[{
     RowBox[{"cr", ":", 
      RowBox[{"Curve", "[", "_", "]"}]}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"1", "/", 
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{"cr", ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"cr", ",", "z"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ComplexMapToInterval", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr_", "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"cr", "-", "z"}], "//", "ComplexRoots"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ComplexMapToIntervalD", "[", 
    RowBox[{
     RowBox[{"cr", ":", 
      RowBox[{"Curve", "[", "_", "]"}]}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"1", "/", 
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{"cr", ",", 
      RowBox[{"ComplexMapToInterval", "[", 
       RowBox[{"cr", ",", "z"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DomainMemberQ", "[", 
     RowBox[{
      RowBox[{"cr", ":", 
       RowBox[{"Curve", "[", "_IFun", "]"}]}], ",", "z_"}], "]"}], ":=", 
    RowBox[{"Or", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"NZeroQ", "[", 
          RowBox[{"Im", "[", "#", "]"}], "]"}], "&&", 
         RowBox[{
          RowBox[{"Abs", "[", "#", "]"}], "\[LessEqual]", 
          RowBox[{"1.", " ", "+", "$MachineTolerance"}]}]}], "&"}], "/@", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"cr", ",", "z"}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr_LFun", "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapDot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"z", "^", "#"}], "&"}], ",", 
     RowBox[{"FFT", "[", "cr", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircleD", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr_LFun", "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapDot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"z", "^", "#"}], "&"}], ",", 
     RowBox[{"FFT", "[", 
      RowBox[{"cr", "'"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircle", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr_", "]"}], ",", 
     RowBox[{"z_", "?", "InfinityQ"}]}], "]"}], ":=", "z"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr_", "]"}], ",", 
     RowBox[{"z_", "?", "InfinityQ"}]}], "]"}], ":=", "z"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromCircle", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr_", "]"}], ",", 
     RowBox[{"z_", "?", "ZeroQ"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircle", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr_", "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"cr", "-", "z"}], "//", "Roots"}], "//", "First"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToCircleD", "[", 
    RowBox[{
     RowBox[{"cr", ":", 
      RowBox[{"Curve", "[", "_", "]"}]}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"1", "/", 
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{"cr", ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"cr", ",", "z"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ComplexMapToCircle", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr_", "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"cr", "-", "z"}], "//", "ComplexRoots"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ComplexMapToIntervalD", "[", 
    RowBox[{
     RowBox[{"cr", ":", 
      RowBox[{"Curve", "[", "_", "]"}]}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"1", "/", 
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{"cr", ",", 
      RowBox[{"ComplexMapToInterval", "[", 
       RowBox[{"cr", ",", "z"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DomainMemberQ", "[", 
     RowBox[{
      RowBox[{"cr", ":", 
       RowBox[{"Curve", "[", "_LFun", "]"}]}], ",", "z_"}], "]"}], ":=", 
    RowBox[{"Or", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"1", "-", "#"}], "]"}], "\[LessEqual]", 
         "$MachineTolerance"}], "&"}], "/@", 
       RowBox[{"MapToCircle", "[", 
        RowBox[{"cr", ",", "z"}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Curve", "[", 
      RowBox[{"cr_IFun", ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Curve", "[", "cr", "]"}], ",", 
     RowBox[{"MapFromInterval", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", "z"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromIntervalD", "[", 
    RowBox[{
     RowBox[{"Curve", "[", 
      RowBox[{"cr_IFun", ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", "z"}], "]"}], " ", 
    
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{
      RowBox[{"Curve", "[", "cr", "]"}], ",", 
      RowBox[{"MapFromInterval", "[", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", "z"}], "]"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Curve", "[", 
      RowBox[{"cr_IFun", ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", 
     RowBox[{"MapToInterval", "[", 
      RowBox[{
       RowBox[{"cr", "//", "Curve"}], ",", "z"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapToIntervalD", "[", 
    RowBox[{
     RowBox[{"Curve", "[", 
      RowBox[{"cr_IFun", ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapToIntervalD", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{
        RowBox[{"cr", "//", "Curve"}], ",", "z"}], "]"}]}], "]"}], "/", 
    RowBox[{"MapFromIntervalD", "[", 
     RowBox[{
      RowBox[{"cr", "//", "Curve"}], ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{
        RowBox[{"cr", "//", "Curve"}], ",", "z"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ComplexMapToInterval", "[", 
    RowBox[{
     RowBox[{"Curve", "[", 
      RowBox[{"cr_IFun", ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapToInterval", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", 
     RowBox[{"ComplexMapToInterval", "[", 
      RowBox[{
       RowBox[{"cr", "//", "Curve"}], ",", "z"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ComplexMapToIntervalD", "[", 
     RowBox[{
      RowBox[{"Curve", "[", 
       RowBox[{"cr_IFun", ",", 
        RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"MapToIntervalD", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", 
       RowBox[{"ComplexMapToInterval", "[", 
        RowBox[{
         RowBox[{"cr", "//", "Curve"}], ",", "z"}], "]"}]}], "]"}], "/", 
     RowBox[{"MapFromIntervalD", "[", 
      RowBox[{
       RowBox[{"cr", "//", "Curve"}], ",", 
       RowBox[{"ComplexMapToInterval", "[", 
        RowBox[{
         RowBox[{"cr", "//", "Curve"}], ",", "z"}], "]"}]}], "]"}]}]}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ComplexPlot", "[", 
    RowBox[{"cf_IFun", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Re", "[", "#", "]"}], ",", 
          RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}], "/@", "cf"}], "//", 
      "Values"}], ",", "opts"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ComplexPlot", "[", 
    RowBox[{"cf_LFun", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Re", "[", "#", "]"}], ",", 
          RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}], "/@", "cf"}], "//", 
      "Values"}], ",", "opts"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DomainPlot", "[", 
    RowBox[{
     RowBox[{"Curve", "[", 
      RowBox[{"cf_", ",", "___"}], "]"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ComplexPlot", "[", 
      RowBox[{"cf", ",", "opts", ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", "Blue", ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"cf", "//", "Values"}], "//", "Last"}], "//", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Re", "[", "#", "]"}], ",", 
               RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"cf", "//", "Values"}], "//", "Last"}], ")"}], "+", 
             RowBox[{"0.01", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", 
                RowBox[{"Arg", "[", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf", "//", "Values"}], "//", "Last"}], ")"}], 
                   "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"cf", "//", "Values"}], ")"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"-", "2"}], "\[RightDoubleBracket]"}]}], ")"}], 
                 "]"}]}], "]"}]}]}], "//", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Re", "[", "#", "]"}], ",", 
               RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}]}], "}"}], 
         "]"}]}], "}"}], "//", "Graphics"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.49476250942632*^9, 3.4947625132201443`*^9}, {
   3.494762726722869*^9, 3.494762749664926*^9}, {3.494763128992263*^9, 
   3.494763166377179*^9}, {3.494766377842944*^9, 3.4947664080111427`*^9}, {
   3.494766500729113*^9, 3.494766502208643*^9}, {3.494766982005666*^9, 
   3.494766994392671*^9}, {3.49518775773598*^9, 3.495187823293003*^9}, {
   3.4951878602928543`*^9, 3.4951878631606817`*^9}, {3.495187896324965*^9, 
   3.495187940699926*^9}, {3.4951879785363407`*^9, 3.495188016658265*^9}, {
   3.495188058879025*^9, 3.4951880755665493`*^9}, {3.495188135176591*^9, 
   3.495188151999836*^9}, {3.495188189929864*^9, 3.495188193398246*^9}, {
   3.495188240581738*^9, 3.4951882588798513`*^9}, {3.495188354787169*^9, 
   3.495188460229392*^9}, {3.495188931773102*^9, 3.495188934365692*^9}, 
   3.4951928151374283`*^9, {3.495192853254855*^9, 3.4951928723570757`*^9}, {
   3.495192936299263*^9, 3.495192960113768*^9}, {3.495265879637179*^9, 
   3.495266048336622*^9}, {3.49526662244268*^9, 3.495266623689248*^9}, {
   3.4952666634570503`*^9, 3.495266762899432*^9}, 3.495266809653582*^9, {
   3.497008257349441*^9, 3.497008269024145*^9}, {3.497010061218788*^9, 
   3.497010072818861*^9}, {3.497011724002408*^9, 3.49701175745719*^9}, {
   3.497011798926992*^9, 3.497011823897986*^9}, {3.49733212535394*^9, 
   3.497332126835277*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Curve ops", "Subsection",
 CellChangeTimes->{{3.495792300076027*^9, 3.495792301147708*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Conjugate", "[", 
    RowBox[{"Arc", "[", 
     RowBox[{"x0_", ",", "r_", ",", 
      RowBox[{"{", 
       RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}], "]"}], "^:=", 
   RowBox[{"Arc", "[", 
    RowBox[{
     RowBox[{"Conjugate", "[", "x0", "]"}], ",", "r", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "t0"}], ",", 
       RowBox[{"-", "t1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Conjugate", "[", 
    RowBox[{"Curve", "[", 
     RowBox[{"cr_IFun", ",", "opts___"}], "]"}], "]"}], "^:=", 
   RowBox[{"Curve", "[", 
    RowBox[{
     RowBox[{"Conjugate", "[", "cr", "]"}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReverseOrientation", "[", 
    RowBox[{"Curve", "[", 
     RowBox[{"cr_IFun", ",", "opts___"}], "]"}], "]"}], ":=", 
   RowBox[{"Curve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "cr", "]"}], "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"Values", "[", "cr", "]"}], "]"}], ",", 
       RowBox[{"Domain", "[", "cr", "]"}]}], "]"}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Curve", "/:", 
   RowBox[{
    RowBox[{"c_", "?", "NumberQ"}], "+", 
    RowBox[{"Curve", "[", 
     RowBox[{"cr_IFun", ",", "opts___"}], "]"}]}], ":=", 
   RowBox[{"Curve", "[", 
    RowBox[{
     RowBox[{"c", "+", "cr"}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Curve", "/:", 
   RowBox[{
    RowBox[{"c_", "?", "NumberQ"}], " ", 
    RowBox[{"Curve", "[", 
     RowBox[{"cr_IFun", ",", "opts___"}], "]"}]}], ":=", 
   RowBox[{"Curve", "[", 
    RowBox[{
     RowBox[{"c", " ", "cr"}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Arc", "/:", 
   RowBox[{
    RowBox[{"c_", "?", "NumberQ"}], " ", 
    RowBox[{"Arc", "[", 
     RowBox[{"x0_", ",", "r_", ",", 
      RowBox[{"{", 
       RowBox[{"t0_", ",", "t1_"}], "}"}]}], "]"}]}], ":=", 
   RowBox[{"Arc", "[", 
    RowBox[{
     RowBox[{"c", " ", "x0"}], ",", "r", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Pi]", "-", "t0"}], ",", 
       RowBox[{"\[Pi]", "-", "t1"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.495792304864911*^9, 3.495792391468533*^9}, {
  3.4957926536747513`*^9, 3.4957926797625103`*^9}, {3.495792734817669*^9, 
  3.495792744998494*^9}, {3.495798314882843*^9, 3.495798321890238*^9}, {
  3.4957984040612392`*^9, 3.4957984956638308`*^9}, {3.4970100827084513`*^9, 
  3.497010086484091*^9}, {3.4981791949521837`*^9, 3.4981792582742033`*^9}, {
  3.498179301516636*^9, 3.498179304790155*^9}, {3.498279501889369*^9, 
  3.4982795515044413`*^9}, {3.498279602064722*^9, 3.498279626621723*^9}, {
  3.4982903357074327`*^9, 3.498290434816778*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Inverse map", "Subsection",
 CellChangeTimes->{{3.494763168114753*^9, 3.49476316968156*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Curve", "[", 
    RowBox[{"cr_", ",", "g_", ",", "gin_"}], "]"}], ":=", 
   RowBox[{"Curve", "[", 
    RowBox[{"cr", ",", "g", ",", "gin", ",", 
     RowBox[{"Stretch", "\[Rule]", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromInterval", "[", 
    RowBox[{
     RowBox[{"Curve", "[", 
      RowBox[{"cr_", ",", "g_", ",", "gin_", ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapDot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ChebyshevT", "[", 
        RowBox[{
         RowBox[{"#", "-", "1"}], ",", 
         RowBox[{"MapFromInterval", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", "z"}], 
          "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"DCT", "[", "cr", "]"}]}], "]"}], "//", "g"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapFromIntervalD", "[", 
    RowBox[{
     RowBox[{"Curve", "[", 
      RowBox[{"cr_", ",", "g_", ",", "gin_", ",", 
       RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"MapDot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ChebyshevT", "[", 
          RowBox[{
           RowBox[{"#", "-", "1"}], ",", "z"}], "]"}], "&"}], ",", 
        RowBox[{"DCT", "[", "cr", "]"}]}], "]"}], "//", 
      RowBox[{"g", "'"}]}], ")"}], 
    RowBox[{"MapDot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ChebyshevT", "[", 
        RowBox[{
         RowBox[{"#", "-", "1"}], ",", "z"}], "]"}], "&"}], ",", 
      RowBox[{"DCT", "[", 
       RowBox[{"cr", "'"}], "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapToInterval", "[", 
     RowBox[{
      RowBox[{"Curve", "[", 
       RowBox[{"cr_", ",", "g_", ",", "gin_", ",", 
        RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"cr", "-", 
      RowBox[{"gin", "[", "z", "]"}]}], "//", "ComplexRoots"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DomainPlot", "[", 
    RowBox[{"Curve", "[", 
     RowBox[{"cfib_IFun", ",", "g_", ",", "gin_", ",", 
      RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cf", "=", 
       RowBox[{"g", "[", 
        RowBox[{"IFun", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"cfib", "//", "Values"}], "//", "Most"}], ",", 
          RowBox[{"cfib", "//", "Domain"}]}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ComplexPlot", "[", 
        RowBox[{"cf", ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Thick"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", "Blue", ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"cf", "//", "Values"}], "//", "Last"}], "//", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Re", "[", "#", "]"}], ",", 
                 RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"cf", "//", "Values"}], "//", "Last"}], ")"}], "+", 
               RowBox[{"0.01", 
                RowBox[{"Exp", "[", 
                 RowBox[{"I", " ", 
                  RowBox[{"Arg", "[", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cf", "//", "Values"}], "//", "Last"}], ")"}], 
                    "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"cf", "//", "Values"}], ")"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"-", "2"}], "\[RightDoubleBracket]"}]}], ")"}], 
                   "]"}]}], "]"}]}]}], "//", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Re", "[", "#", "]"}], ",", 
                 RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}]}]}], "}"}], 
           "]"}]}], "}"}], "//", "Graphics"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.49476250942632*^9, 3.4947625132201443`*^9}, {
  3.494762726722869*^9, 3.494762749664926*^9}, {3.494763128992263*^9, 
  3.494763141054439*^9}, {3.494763174659741*^9, 3.494763200439451*^9}, {
  3.494763276984947*^9, 3.494763282447401*^9}, {3.4947633290625134`*^9, 
  3.494763338348571*^9}, {3.4947634035818443`*^9, 3.494763414298493*^9}, {
  3.494763593164175*^9, 3.494763787952816*^9}, {3.497578273543551*^9, 
  3.497578353435154*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["NEqual", "Section",
 CellChangeTimes->{{3.4982904392696*^9, 3.498290440867317*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"ls_", ",", "___"}], "]"}], "~", "NEqual", "~", 
    RowBox[{"Line", "[", 
     RowBox[{"ls2_", ",", "___"}], "]"}]}], ":=", 
   RowBox[{"NZeroQ", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            ",", "0", ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
           "]"}], "&"}], "/@", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sort", "[", "ls", "]"}], ",", 
            RowBox[{"Sort", "[", "ls2", "]"}]}], "}"}], "]"}]}], ")"}], "//", 
       "Flatten"}], "//", "Abs"}], "//", "Max"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Arc", "[", 
     RowBox[{"x0_", ",", "r_", ",", "t0_"}], "]"}], "~", "NEqual", "~", 
    RowBox[{"Arc", "[", 
     RowBox[{"x2_", ",", "r2_", ",", "t2_"}], "]"}]}], ":=", 
   RowBox[{"NZeroQ", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x0", "-", "x2"}], ",", 
         RowBox[{"r", "-", "r2"}], ",", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "t0"}], "]"}], "-", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "t2"}], "]"}]}]}], "}"}], "//", "Flatten"}], "//",
       "Abs"}], "//", "Max"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Curve", "[", 
     RowBox[{"f_", ",", "opts___"}], "]"}], "~", "NEqual", "~", 
    RowBox[{"Curve", "[", 
     RowBox[{"g_", ",", "opts___"}], "]"}]}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "f", "]"}], "\[Equal]", 
      RowBox[{"Length", "[", "g", "]"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "-", "g"}], "//", "Values"}], "//", "Norm"}], ")"}], 
      "<", "$MachineTolerance"}], ",", "False"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4982904549503202`*^9, 3.4982905127512283`*^9}, {
   3.498290706468816*^9, 3.498290839853673*^9}, {3.498290880259631*^9, 
   3.498290903136194*^9}, 3.498290955519956*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["List ops", "Section",
 CellChangeTimes->{{3.4958009952232323`*^9, 3.49580099659879*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SelectWithPoint", "[", 
    RowBox[{"GG_", ",", "Gg_"}], "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"GG", ",", 
       RowBox[{
        RowBox[{"Or", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"LeftEndpoint", "[", "#", "]"}], "~", "NEqual", "~", 
           RowBox[{"(", "Gg", ")"}]}], ",", 
          RowBox[{
           RowBox[{"RightEndpoint", "[", "#", "]"}], "~", "NEqual", "~", 
           RowBox[{"(", "Gg", ")"}]}]}], "]"}], "&"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"LeftEndpoint", "[", "#1", "]"}], "~", "NEqual", "~", 
          RowBox[{"(", "Gg", ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"LeftContourArg", "[", "#1", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RightContourArg", "[", "#1", "]"}]}], "]"}], "<", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"LeftEndpoint", "[", "#2", "]"}], "~", "NEqual", "~", 
          RowBox[{"(", "Gg", ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"LeftContourArg", "[", "#2", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RightContourArg", "[", "#2", "]"}]}], "]"}]}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SelectWithPoint", "[", 
    RowBox[{"GG_", ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"GG", ",", 
       RowBox[{
        RowBox[{"Or", "[", 
         RowBox[{
          RowBox[{"InfinityQ", "[", 
           RowBox[{"LeftEndpoint", "[", "#", "]"}], "]"}], ",", 
          RowBox[{"InfinityQ", "[", 
           RowBox[{"RightEndpoint", "[", "#", "]"}], "]"}]}], "]"}], "&"}]}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"LeftEndpoint", "[", "#1", "]"}], "//", "InfinityQ"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LeftContourArg", "[", "#1", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RightContourArg", "[", "#1", "]"}]}], "]"}], "<", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"LeftEndpoint", "[", "#2", "]"}], "//", "InfinityQ"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LeftContourArg", "[", "#2", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RightContourArg", "[", "#2", "]"}]}], "]"}]}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Endpoints", "[", "GG_IFun", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"GG", "//", "LeftEndpoint"}], "//", "N"}], "//", "Chop"}], 
      ",", 
      RowBox[{
       RowBox[{
        RowBox[{"GG", "//", "RightEndpoint"}], "//", "N"}], "//", "Chop"}]}], 
     "}"}], "/.", 
    RowBox[{
     RowBox[{"_", "?", "InfinityQ"}], "\[Rule]", "\[Infinity]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Endpoints", "[", "GG_List", "]"}], ":=", 
   RowBox[{"Union", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"LeftEndpoint", "/@", "GG"}], "//", "N"}], "//", "Chop"}], 
        ",", 
        RowBox[{
         RowBox[{
          RowBox[{"RightEndpoint", "/@", "GG"}], "//", "N"}], "//", 
         "Chop"}]}], "}"}], "/.", 
      RowBox[{
       RowBox[{"_", "?", "InfinityQ"}], "\[Rule]", "\[Infinity]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FiniteEndpoints", "[", "GG_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Endpoints", "[", "GG", "]"}], ",", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"InfinityQ", "[", "#", "]"}]}], "&"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.495801018230802*^9, 3.495801018475052*^9}, {
  3.4971664534976797`*^9, 3.497166467874453*^9}, {3.49716940828198*^9, 
  3.497169416548876*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Other Transforms", "Section",
 CellChangeTimes->{{3.4972411091936197`*^9, 3.497241112175318*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LegendreTransform", "[", 
     RowBox[{"if_", ",", "m_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", "w", ",", "cf", ",", "ifv", ",", "j", ",", "n"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "w"}], "}"}], "=", 
        RowBox[{"Thread", "[", 
         RowBox[{"GaussianQuadratureWeights", "[", 
          RowBox[{"m", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ifv", "=", 
        RowBox[{"if", "/@", "p"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cf", "[", "0", "]"}], "=", 
        RowBox[{"w", " ", 
         RowBox[{"LegendreP", "[", 
          RowBox[{"0", ",", "p"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cf", "[", "1", "]"}], "=", 
        RowBox[{"w", " ", 
         RowBox[{"LegendreP", "[", 
          RowBox[{"1", ",", "p"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cf", "[", "n_", "]"}], ":=", 
        RowBox[{
         RowBox[{"cf", "[", "n", "]"}], "=", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "n"}], "-", "1"}], ")"}], " ", "p", " ", 
            RowBox[{"cf", "[", 
             RowBox[{"n", "-", "1"}], "]"}]}], " ", "-", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], " ", 
            RowBox[{"cf", "[", 
             RowBox[{"n", "-", "2"}], "]"}]}]}], "n"]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"2", " ", "j"}], "+", "1"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"cf", "[", "j", "]"}], ".", "ifv"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LegendreTransform", "[", "if_IFun", "]"}], ":=", 
   RowBox[{"LegendreTransform", "[", 
    RowBox[{
     RowBox[{"if", "//", "ToUnitInterval"}], ",", 
     RowBox[{"if", "//", "Length"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LegendreTransform", "[", "if_List", "]"}], ":=", 
    RowBox[{"LegendreTransform", "[", 
     RowBox[{
      RowBox[{"IFun", "[", 
       RowBox[{"if", ",", "UnitInterval"}], "]"}], ",", 
      RowBox[{"if", "//", "Length"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EvaluateMatrix", "[", 
    RowBox[{"f_IFun", ",", "x_List"}], "]"}], ":=", 
   RowBox[{"EvaluateMatrix", "[", 
    RowBox[{
     RowBox[{"f", "//", "ToUnitInterval"}], ",", 
     RowBox[{"MapToInterval", "[", 
      RowBox[{"f", ",", "x"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EvaluateMatrix", "[", 
    RowBox[{
     RowBox[{"f_IFun", "?", "UnitIntervalFunQ"}], ",", "x_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w", ",", "j", ",", "p", ",", "k", ",", "n"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"k", "=", 
       RowBox[{"Length", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"NChebyshevLobattoPoints", "[", "k", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"w", "[", "1", "]"}], "=", 
       RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"w", "[", "j_", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"j", "+", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"w", "[", "k", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"k", "+", "1"}], ")"}]}], " ", 
        RowBox[{"1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"n", ",", 
            RowBox[{"N", "[", 
             RowBox[{"Chop", "[", 
              RowBox[{"#", ",", "$MachineEpsilon"}], "]"}], "]"}]}], "]"}], 
          ",", 
          RowBox[{
           RowBox[{"BasisVector", "[", "k", "]"}], "[", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"n", ",", 
              RowBox[{"N", "[", 
               RowBox[{"Chop", "[", 
                RowBox[{"#", ",", "$MachineEpsilon"}], "]"}], "]"}]}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          FractionBox[
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"w", "[", "j", "]"}], "/", 
              RowBox[{"(", 
               RowBox[{"#", "-", 
                RowBox[{
                "n", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
                ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"j", "=", "1"}], "k"], 
            RowBox[{
             RowBox[{"w", "[", "j", "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"#", "-", 
               RowBox[{
               "n", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
              ")"}]}]}]]}], "]"}], "&"}], "/@", "x"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EvaluateMatrix", "[", 
    RowBox[{"f_IFun", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"EvaluateMatrix", "[", 
     RowBox[{"f", ",", 
      RowBox[{"{", "x", "}"}]}], "]"}], "//", "First"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LegendreTransformMatrix", "[", "if_IFun", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "p", ",", "w", ",", "cf", ",", "ifv", ",", "j", ",", "n", ",", "m"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", "=", 
        RowBox[{"Length", "[", "if", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "w"}], "}"}], "=", 
        RowBox[{"Thread", "[", 
         RowBox[{"GaussianQuadratureWeights", "[", 
          RowBox[{"m", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cf", "[", "0", "]"}], "=", 
        RowBox[{"w", " ", 
         RowBox[{"LegendreP", "[", 
          RowBox[{"0", ",", "p"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cf", "[", "1", "]"}], "=", 
        RowBox[{"w", " ", 
         RowBox[{"LegendreP", "[", 
          RowBox[{"1", ",", "p"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cf", "[", "n_", "]"}], ":=", 
        RowBox[{
         RowBox[{"cf", "[", "n", "]"}], "=", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "n"}], "-", "1"}], ")"}], " ", "p", " ", 
            RowBox[{"cf", "[", 
             RowBox[{"n", "-", "1"}], "]"}]}], " ", "-", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], " ", 
            RowBox[{"cf", "[", 
             RowBox[{"n", "-", "2"}], "]"}]}]}], "n"]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "j"}], "+", "1"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"cf", "[", "j", "]"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}], ".", 
        RowBox[{"EvaluateMatrix", "[", 
         RowBox[{
          RowBox[{"if", "//", "ToUnitInterval"}], ",", "p"}], "]"}]}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FiniteLegendreTransformMatrix", "[", 
    RowBox[{"if_", "?", "LeftEndpointInfinityQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"LegendreTransformMatrix", "[", "if", "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", 
     RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FiniteLegendreTransformMatrix", "[", 
     RowBox[{"if_", "?", "RightEndpointInfinityQ"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"LegendreTransformMatrix", "[", "if", "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", 
      RowBox[{";;", 
       RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FiniteInverseLegendreTransformMatrix", "[", 
    RowBox[{"if_", "?", "LeftEndpointInfinityQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"LegendreTransformMatrix", "[", "if", "]"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"2", ";;"}], ",", "All"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FiniteInverseLegendreTransformMatrix", "[", 
    RowBox[{"if_", "?", "RightEndpointInfinityQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"LegendreTransformMatrix", "[", "if", "]"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{";;", 
      RowBox[{"-", "2"}]}], ",", "All"}], "\[RightDoubleBracket]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.497241484189402*^9, 3.4972414884360533`*^9}, {
  3.4972415206694937`*^9, 3.497241571021899*^9}, {3.497241619390684*^9, 
  3.497241623524742*^9}, {3.497242080235902*^9, 3.497242095364773*^9}, {
  3.497242183831702*^9, 3.497242227369783*^9}, {3.497242378520434*^9, 
  3.4972424442412357`*^9}, {3.497242480843912*^9, 3.497242493376683*^9}, {
  3.4972427348483133`*^9, 3.497242763696892*^9}, {3.497242842354184*^9, 
  3.497242850169325*^9}, {3.497242946023922*^9, 3.497242971896956*^9}, {
  3.497796891805066*^9, 3.497796924452887*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Finish", "Section",
 CellChangeTimes->{{3.4842068983367157`*^9, 3.484206898904407*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.484206906081437*^9, 3.484206913225231*^9}, {
   3.484207060820569*^9, 3.484207062002028*^9}, 3.48421017031083*^9, {
   3.48421023591794*^9, 3.484210237210731*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{814, 809},
WindowMargins->{{Automatic, 165}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 6, \
2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 147, 3, 26, "Text"],
Cell[CellGroupData[{
Cell[717, 27, 32, 0, 67, "Section"],
Cell[752, 29, 1006, 15, 27, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1795, 49, 98, 1, 37, "Section"],
Cell[1896, 52, 14423, 343, 2098, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[16356, 400, 92, 1, 37, "Section"],
Cell[16451, 403, 6708, 188, 568, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[23196, 596, 88, 1, 37, "Section"],
Cell[23287, 599, 10512, 278, 628, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[33836, 882, 88, 1, 37, "Section"],
Cell[33927, 885, 8266, 239, 613, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[42230, 1129, 236, 3, 37, "Section"],
Cell[CellGroupData[{
Cell[42491, 1136, 98, 1, 34, "Subsection"],
Cell[42592, 1139, 10846, 292, 1436, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[53475, 1436, 97, 1, 34, "Subsection"],
Cell[53575, 1439, 18787, 580, 1444, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[72399, 2024, 118, 2, 34, "Subsection"],
Cell[72520, 2028, 2661, 76, 271, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[75218, 2109, 100, 1, 26, "Subsection"],
Cell[75321, 2112, 1770, 56, 178, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[77128, 2173, 173, 2, 26, "Subsection"],
Cell[77304, 2177, 5827, 174, 304, "Input",
 InitializationCell->True],
Cell[83134, 2353, 2703, 74, 103, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85874, 2432, 91, 1, 34, "Subsection"],
Cell[85968, 2435, 13359, 402, 757, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[99364, 2842, 94, 1, 26, "Subsection"],
Cell[99461, 2845, 17878, 544, 1195, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[117376, 3394, 94, 1, 34, "Subsection"],
Cell[117473, 3397, 1211, 35, 88, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[118733, 3438, 91, 1, 37, "Section"],
Cell[118827, 3441, 8719, 266, 798, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[127583, 3712, 91, 1, 37, "Section"],
Cell[127677, 3715, 5808, 157, 403, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[133522, 3877, 95, 1, 37, "Section"],
Cell[CellGroupData[{
Cell[133642, 3882, 94, 1, 34, "Subsection"],
Cell[133739, 3885, 5083, 137, 718, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[138859, 4027, 99, 1, 34, "Subsection"],
Cell[138961, 4030, 2556, 71, 178, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[141554, 4106, 97, 1, 34, "Subsection"],
Cell[141654, 4109, 1060, 29, 73, "Input",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[142763, 4144, 91, 1, 37, "Section"],
Cell[CellGroupData[{
Cell[142879, 4149, 97, 1, 34, "Subsection"],
Cell[142979, 4152, 16395, 474, 1153, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[159411, 4631, 111, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[159547, 4636, 6132, 172, 493, "Input",
 InitializationCell->True],
Cell[165682, 4810, 427, 8, 23, "Message"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[166158, 4824, 98, 1, 26, "Subsection"],
Cell[166259, 4827, 4967, 131, 418, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[171263, 4963, 97, 1, 26, "Subsection"],
Cell[171363, 4966, 6950, 181, 418, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[178362, 5153, 95, 1, 37, "Section"],
Cell[178460, 5156, 13258, 367, 463, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[191755, 5528, 140, 2, 37, "Section"],
Cell[CellGroupData[{
Cell[191920, 5534, 97, 1, 34, "Subsection"],
Cell[192020, 5537, 9778, 287, 643, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[201835, 5829, 111, 1, 34, "Subsection"],
Cell[201949, 5832, 2658, 74, 193, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[204644, 5911, 98, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[204767, 5916, 4490, 120, 238, "Input",
 InitializationCell->True],
Cell[209260, 6038, 476, 9, 23, "Message"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[209785, 6053, 158, 2, 34, "Subsection"],
Cell[209946, 6057, 5506, 166, 418, "Input",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[215501, 6229, 97, 1, 37, "Section"],
Cell[215601, 6232, 1543, 38, 133, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[217181, 6275, 118, 2, 37, "Section"],
Cell[CellGroupData[{
Cell[217324, 6281, 13857, 350, 838, "Input",
 InitializationCell->True],
Cell[231184, 6633, 520, 9, 23, "Message"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[231753, 6648, 144, 2, 37, "Section"],
Cell[231900, 6652, 14915, 383, 1243, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[246852, 7040, 101, 1, 37, "Section"],
Cell[246956, 7043, 4364, 121, 253, "Input",
 InitializationCell->True],
Cell[251323, 7166, 92, 1, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[251452, 7172, 89, 1, 37, "Section"],
Cell[251544, 7175, 10181, 259, 568, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[261762, 7439, 143, 2, 67, "Section"],
Cell[261908, 7443, 10460, 316, 583, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[272405, 7764, 102, 1, 37, "Section"],
Cell[272510, 7767, 544, 16, 27, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[273091, 7788, 90, 1, 67, "Section"],
Cell[273184, 7791, 877, 27, 43, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[274098, 7823, 96, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[274219, 7828, 98, 1, 34, "Subsection"],
Cell[274320, 7831, 16234, 476, 943, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[290591, 8312, 97, 1, 26, "Subsection"],
Cell[290691, 8315, 2872, 82, 118, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[293600, 8402, 98, 1, 34, "Subsection"],
Cell[293701, 8405, 5189, 144, 223, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[298939, 8555, 89, 1, 67, "Section"],
Cell[299031, 8558, 2681, 78, 103, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[301749, 8641, 94, 1, 67, "Section"],
Cell[301846, 8644, 4239, 123, 298, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[306122, 8772, 103, 1, 37, "Section"],
Cell[306228, 8775, 10769, 296, 788, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[317034, 9076, 93, 1, 37, "Section"],
Cell[317130, 9079, 361, 8, 43, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
