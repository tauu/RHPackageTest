Notebook[{
Cell["\<\
\[Copyright] Sheehan Olver, 2010, subject to BSD license.

Other contributors include Georg Wechslberger.

FredholmDet is based on code by Folkmar Bornemann.\
\>", "Text"],

Cell[CellGroupData[{

Cell["Setup", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<RiemannHilbert`\>\"", ",", 
    RowBox[{"{", "\"\<RiemannHilbert`Common`\>\"", "}"}]}], "]"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Documentation", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`Cauchy", "::", "usage"}], "=", 
   "\"\<Cauchy[f,z] evaluates the Cauchy transform \!\(\*FractionBox[\(1\), \
\(2\\\ \[Pi]\[NonBreakingSpace]I\)]\)\!\(\*SubscriptBox[\(\[Integral]\), \
\(Domain[f]\)]\)\!\(\*FractionBox[\(f[t]\), \(t - z\)]\)\[DifferentialD]t of \
an IFun f at a complex point z. Cauchy[ifunlist,z] evaluates the sum of the \
Cauchy transform of each element of ifunlist. Cauchy[\[PlusMinus]1,f,x] \
evaluates the left/right limit of Cauchy[f,x] for x on the domain of f. \
Cauchy[\[PlusMinus]1,flist] for CauchyBoundedQ[flist] true evaluates the \
Cauchy transform of flist on the points of flist, returning another list of \
IFuns.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`Hilbert", "::", "usage"}], "=", 
   "\"\<Hilbert[f,x] evaluates the Hilbert transform \!\(\*FractionBox[\(1\), \
\(\[Pi]\)]\)PV\!\(\*SubscriptBox[\(\[Integral]\), \
\(Domain[f]\)]\)\!\(\*FractionBox[\(f[t]\), \(t - x\)]\)\[DifferentialD]t of \
an IFun f at a point x on Domain[f].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`RHSolve", "::", "usage"}], "=", 
   "\"\<RHSolve[ifunlist] returns u such that IdentityMatrix[2] + \
CauchyTransform[u,z] has the jumps specified by ifunlist.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`RHSolver", "::", "usage"}], "=", 
   "\"\<RHSolver[ifunlist] constructs an anonymous function R that \
precomputes the matrices used in RHSolve, so that if the domain and points of \
ifunlist are the same as ifunlist2, then R[ifunlist2] == \
RHSolve[ifunlist2].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`RHSolveTop", "::", "usage"}], "=", 
   "\"\<RHSolveTop[ifunlist] returns the top row of RHSolve.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`RHSolverTop", "::", "usage"}], "=", 
   "\"\<RHSolverTop[ifunlist] constructs an anonymous function R that \
precomputes the matrices used in RHSolveTop, so that if the domain and points \
of ifunlist are the same as ifunlist2, then R[ifunlist2] == \
RHSolveTop[ifunlist2].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`CauchyBoundedQ", "::", "usage"}], "=", 
    "\[IndentingNewLine]", 
    "\"\<CauchyBoundedQ[ifunlist] Determines if the Cauchy transform of \
ifunlist is bounded (i.e., at each joint vertex of ifunlist the functions sum \
to zero)\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`CauchyOperator", "::", "usage"}], "=", 
   "\[IndentingNewLine]", 
   "\"\<CauchyOperator[s,flist] returns a function C such that if glist has \
the same domain and number of points as flist, then C[glist] = \
Cauchy[s,glist]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`AddIdentityMatrix", "::", "usage"}], "=", 
   "\[IndentingNewLine]", 
   "\"\<Adds IdentityMatrix[2] to a list of ifuns.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RiemannHilbert`CauchyMatrix", ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["LFun Cauchy", "Section"],

Cell[CellGroupData[{

Cell["At Value", "Subsection"],

Cell[BoxData[{
 RowBox[{"RiemannHilbert`Cauchy", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RiemannHilbert`CauchyS", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{"lf_LFun", ",", "z_List"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Cauchy", "[", 
      RowBox[{"lf", ",", "#"}], "]"}], "&"}], "/@", "z"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{"s_", ",", "lf_LFun", ",", "z_List"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Cauchy", "[", 
       RowBox[{"s", ",", "lf", ",", "#"}], "]"}], "&"}], "/@", "z"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyS", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", 
     RowBox[{"lf_LFun", "?", "UnitCircleFunQ"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"NonNegativeEvaluate", "[", 
    RowBox[{"lf", ",", "z"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyS", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"lf_LFun", "?", "UnitCircleFunQ"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"NegativeEvaluate", "[", 
     RowBox[{"lf", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{
     RowBox[{"lf_LFun", "?", "UnitCircleFunQ"}], ",", 
     RowBox[{"z_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "#", "]"}], "<=", "1."}], "&"}], ")"}]}]}], 
    "]"}], ":=", 
   RowBox[{"CauchyS", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "lf", ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{
     RowBox[{"lf_LFun", "?", "UnitCircleFunQ"}], ",", 
     RowBox[{"z_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "#", "]"}], ">", "1."}], "&"}], ")"}]}]}], "]"}],
    ":=", 
   RowBox[{"CauchyS", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "lf", ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{"s_", ",", 
     RowBox[{"lf_LFun", "?", "UnitCircleFunQ"}], ",", 
     RowBox[{"z_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DomainMemberQ", "[", 
         RowBox[{"UnitCircle", ",", "#"}], "]"}], "&"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"CauchyS", "[", 
    RowBox[{"s", ",", "lf", ",", "z"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"lf_LFun", "?", "UnitCircleFunQ"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{"Cauchy", "[", 
     RowBox[{"lf", ",", "z"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{
      RowBox[{"f", ":", 
       RowBox[{"LFun", "[", 
        RowBox[{"_", ",", "_Curve"}], "]"}]}], ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"Cauchy", "[", 
       RowBox[{
        RowBox[{"f", "//", "ToUnitCircle"}], ",", 
        RowBox[{"ComplexMapToCircle", "[", 
         RowBox[{
          RowBox[{"f", "//", "Domain"}], ",", "z"}], "]"}]}], "]"}], "]"}], 
     "-", 
     RowBox[{"Total", "[", 
      RowBox[{"Cauchy", "[", 
       RowBox[{
        RowBox[{"f", "//", "ToUnitCircle"}], ",", 
        RowBox[{"ComplexMapToCircle", "[", 
         RowBox[{
          RowBox[{"f", "//", "Domain"}], ",", 
          SuperscriptBox["10", "18"]}], "]"}]}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cauchy", "[", 
      RowBox[{"s_", ",", 
       RowBox[{"f", ":", 
        RowBox[{"LFun", "[", 
         RowBox[{"_", ",", "_Curve"}], "]"}]}], ",", "z_"}], "]"}], "/;", 
     RowBox[{"DomainMemberQ", "[", 
      RowBox[{"f", ",", "z"}], "]"}]}], ":=", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"Cauchy", "[", 
       RowBox[{"s", ",", 
        RowBox[{"f", "//", "ToUnitCircle"}], ",", 
        RowBox[{"ComplexMapToCircle", "[", 
         RowBox[{
          RowBox[{"f", "//", "Domain"}], ",", "z"}], "]"}]}], "]"}], "]"}], 
     "-", 
     RowBox[{"Total", "[", 
      RowBox[{"Cauchy", "[", 
       RowBox[{
        RowBox[{"f", "//", "ToUnitCircle"}], ",", 
        RowBox[{"ComplexMapToCircle", "[", 
         RowBox[{
          RowBox[{"f", "//", "Domain"}], ",", 
          SuperscriptBox["10", "18"]}], "]"}]}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{"lf_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{
      RowBox[{"lf", "//", "ToUnitCircle"}], ",", 
      RowBox[{"MapToCircle", "[", 
       RowBox[{"lf", ",", "z"}], "]"}]}], "]"}], "-", 
    RowBox[{"Cauchy", "[", 
     RowBox[{
      RowBox[{"lf", "//", "ToUnitCircle"}], ",", 
      RowBox[{"MapToCircle", "[", 
       RowBox[{"lf", ",", "\[Infinity]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{"s_", ",", "lf_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{"s", ",", 
      RowBox[{"lf", "//", "ToUnitCircle"}], ",", 
      RowBox[{"MapToCircle", "[", 
       RowBox[{"lf", ",", "z"}], "]"}]}], "]"}], "-", 
    RowBox[{"Cauchy", "[", 
     RowBox[{
      RowBox[{"lf", "//", "ToUnitCircle"}], ",", 
      RowBox[{"MapToCircle", "[", 
       RowBox[{"lf", ",", "\[Infinity]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`Hilbert", "[", 
    RowBox[{"lf_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"I", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cauchy", "[", 
       RowBox[{
        RowBox[{"+", "1"}], ",", "lf", ",", "z"}], "]"}], "+", 
      RowBox[{"Cauchy", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "lf", ",", "z"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True],

Cell[BoxData[""], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Inverse", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`CauchyInverse", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "lf_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"Cauchy", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "lf", ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverse", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "lf_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"Cauchy", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "lf", ",", "z"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverse", "[", 
     RowBox[{"lf_LFun", ",", "z_"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"MapToCircle", "[", 
       RowBox[{"lf", ",", "z"}], "]"}], "]"}], "\[LessEqual]", "1."}]}], ":=", 
   RowBox[{"CauchyInverse", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "lf", ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CauchyInverse", "[", 
      RowBox[{"lf_LFun", ",", "z_"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"MapToCircle", "[", 
        RowBox[{"lf", ",", "z"}], "]"}], "]"}], ">", "1."}]}], ":=", 
    RowBox[{"CauchyInverse", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "lf", ",", "z"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`HilbertInverse", "[", 
    RowBox[{"lf_LFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CauchyInverse", "[", 
       RowBox[{
        RowBox[{"+", "1"}], ",", "lf", ",", "z"}], "]"}], "-", 
      RowBox[{"CauchyInverse", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "lf", ",", "z"}], "]"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Whole Fun", "Subsection",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", 
     RowBox[{"lf_LFun", "?", "UnitCircleFunQ"}]}], "]"}], ":=", 
   RowBox[{"NonNegativePart", "[", "lf", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"lf_LFun", "?", "UnitCircleFunQ"}]}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"NegativePart", "[", "lf", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f", ":", 
       RowBox[{"LFun", "[", 
        RowBox[{"_", ",", "_Curve"}], "]"}]}]}], "]"}], ":=", 
    RowBox[{"LFun", "[", 
     RowBox[{
      RowBox[{"Cauchy", "[", 
       RowBox[{"s", ",", "f", ",", 
        RowBox[{"f", "//", "Points"}]}], "]"}], ",", 
      RowBox[{"f", "//", "Domain"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{"s_", ",", "lf_LFun"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"LFun", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Cauchy", "[", 
        RowBox[{"s", ",", 
         RowBox[{"lf", "//", "ToUnitCircle"}]}], "]"}], "//", "Values"}], ",", 
      RowBox[{"lf", "//", "Domain"}]}], "]"}], "-", 
    RowBox[{"Cauchy", "[", 
     RowBox[{
      RowBox[{"lf", "//", "ToUnitCircle"}], ",", 
      RowBox[{"MapToCircle", "[", 
       RowBox[{"lf", ",", "\[Infinity]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Hilbert", "[", "lf_LFun", "]"}], ":=", 
    RowBox[{"I", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cauchy", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "lf"}], "]"}], "+", 
       RowBox[{"Cauchy", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "lf"}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverse", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "lf_LFun"}], "]"}], ":=", 
   RowBox[{"Cauchy", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "lf"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverse", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "lf_LFun"}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"Cauchy", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "lf"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HilbertInverse", "[", "lf_LFun", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CauchyInverse", "[", 
       RowBox[{
        RowBox[{"+", "1"}], ",", "lf"}], "]"}], "-", 
      RowBox[{"CauchyInverse", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "lf"}], "]"}]}], ")"}]}]}], ";"}]}], "Input",
 
 InitializationCell->True]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["LFun CauchyBasis and Cauchy Matrix", "Section"],

Cell[CellGroupData[{

Cell["Cauchy basis", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RiemannHilbert`FPCauchyBasis", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`CauchyBasis", "[", 
    RowBox[{"_", ",", "_Integer", ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`CauchyBasisS", "[", 
     RowBox[{"_", ",", "_", ",", "_Integer", ",", 
      RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", "0"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{
     RowBox[{"f_", "?", "FunQ"}], ",", "k_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"CauchyBasis", "[", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], ",", "k", ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_", "?", "FunQ"}], ",", "k_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"s", ",", 
      RowBox[{"f", "//", "Domain"}], ",", "k", ",", "x"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisS", "[", 
    RowBox[{
     RowBox[{"f_", "?", "FunQ"}], ",", "k_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"CauchyBasisS", "[", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], ",", "k", ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisS", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_", "?", "FunQ"}], ",", "k_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"CauchyBasisS", "[", 
     RowBox[{"s", ",", 
      RowBox[{"f", "//", "Domain"}], ",", "k", ",", "x"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisS", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "UnitCircle", ",", 
     RowBox[{"k_", "?", "Negative"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"0", " ", "z"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisS", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "UnitCircle", ",", 
     RowBox[{"k_", "?", "Negative"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"-", 
    SuperscriptBox["z", "k"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisS", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "UnitCircle", ",", "0", ",", "z_List"}], "]"}], 
   ":=", 
   RowBox[{"OneVector", "[", 
    RowBox[{"Length", "[", "z", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisS", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "UnitCircle", ",", "0", ",", "z_"}], "]"}], ":=",
    "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisS", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "UnitCircle", ",", 
     RowBox[{"k_", "?", "NonNegative"}], ",", "z_"}], "]"}], ":=", 
   SuperscriptBox["z", "k"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisS", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "UnitCircle", ",", 
      RowBox[{"k_", "?", "NonNegative"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{"0", " ", "z"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{
     RowBox[{"d_", "?", "CircleDomainQ"}], ",", "k_Integer", ",", "z_List"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"d", ",", "k", ",", "#"}], "]"}], "&"}], "/@", "z"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{
      RowBox[{"s_", "?", "SignQ"}], ",", 
      RowBox[{"d_", "?", "CircleDomainQ"}], ",", "k_Integer", ",", "z_List"}],
      "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"s", ",", "d", ",", "k", ",", "#"}], "]"}], "&"}], "/@", 
     "z"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{"UnitCircle", ",", "k_Integer", ",", 
     RowBox[{"z_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "#", "]"}], "<=", "1."}], "&"}], ")"}]}]}], 
    "]"}], ":=", 
   RowBox[{"CauchyBasisS", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "UnitCircle", ",", "k", ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"UnitCircle", ",", "k_Integer", ",", 
      RowBox[{"z_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "#", "]"}], ">", "1."}], "&"}], ")"}]}]}], 
     "]"}], ":=", 
    RowBox[{"CauchyBasisS", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "UnitCircle", ",", "k", ",", "z"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{"s_", ",", "UnitCircle", ",", "k_Integer", ",", 
     RowBox[{"z_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DomainMemberQ", "[", 
         RowBox[{"UnitCircle", ",", "#"}], "]"}], "&"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"CauchyBasisS", "[", 
    RowBox[{"s", ",", "UnitCircle", ",", "k", ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"s_", ",", "UnitCircle", ",", "k_Integer", ",", "z_"}], "]"}], ":=", 
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"UnitCircle", ",", "k", ",", "z"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{
     RowBox[{"d", ":", 
      RowBox[{"Curve", "[", "_LFun", "]"}]}], ",", "0", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"UnitCircle", ",", "0", ",", 
       RowBox[{"ComplexMapToCircle", "[", 
        RowBox[{"d", ",", "z"}], "]"}]}], "]"}], "]"}], "-", 
    RowBox[{"Total", "[", 
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"UnitCircle", ",", "0", ",", 
       RowBox[{"ComplexMapToCircle", "[", 
        RowBox[{"d", ",", 
         SuperscriptBox["10", "18"]}], "]"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{
      RowBox[{"d", ":", 
       RowBox[{"Curve", "[", "_LFun", "]"}]}], ",", "k_Integer", ",", "z_"}], 
     "]"}], ":=", 
    RowBox[{"Total", "[", 
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"UnitCircle", ",", "k", ",", 
       RowBox[{"ComplexMapToCircle", "[", 
        RowBox[{"d", ",", "z"}], "]"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", 
     RowBox[{"d", ":", 
      RowBox[{"Curve", "[", "_LFun", "]"}]}], ",", "0", ",", "z_"}], "]"}], ":=",
    
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"s", ",", "UnitCircle", ",", "0", ",", 
       RowBox[{"ComplexMapToCircle", "[", 
        RowBox[{"d", ",", "z"}], "]"}]}], "]"}], "]"}], "-", 
    RowBox[{"Total", "[", 
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"UnitCircle", ",", "0", ",", 
       RowBox[{"ComplexMapToCircle", "[", 
        RowBox[{"d", ",", 
         SuperscriptBox["10", "18"]}], "]"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{
      RowBox[{"s_", "?", "SignQ"}], ",", 
      RowBox[{"d", ":", 
       RowBox[{"Curve", "[", "_LFun", "]"}]}], ",", "k_Integer", ",", "z_"}], 
     "]"}], ":=", 
    RowBox[{"Total", "[", 
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"s", ",", "UnitCircle", ",", "k", ",", 
       RowBox[{"ComplexMapToCircle", "[", 
        RowBox[{"d", ",", "z"}], "]"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{
      RowBox[{"s_", "?", "SignQ"}], ",", 
      RowBox[{"d", ":", 
       RowBox[{"Curve", "[", "_LFun", "]"}]}], ",", 
      RowBox[{"i_Integer", ";;", "j_Integer"}], ",", "z_List"}], "]"}], ":=", 
    
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Total", "/@", 
           RowBox[{"CauchyBasis", "[", 
            RowBox[{"s", ",", "UnitCircle", ",", 
             RowBox[{"i", ";;", "j"}], ",", "#"}], "]"}]}], ")"}], "&"}], "/@", 
        RowBox[{"ComplexMapToCircle", "[", 
         RowBox[{"d", ",", "z"}], "]"}]}], "//", "Transpose"}], ")"}], "-", 
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{"ComplexMapToCircle", "[", 
         RowBox[{"d", ",", 
          SuperscriptBox["10", "18"]}], "]"}], ",", 
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "#", "]"}], "<", "1"}], "&"}], ")"}]}]}], 
       "]"}], "  ", 
      RowBox[{"ToList", "[", 
       RowBox[{"BasisShiftList", "[", 
        RowBox[{
         RowBox[{"i", ";;", "j"}], ",", "0"}], "]"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{
     RowBox[{"f_", "?", "CircleDomainQ"}], ",", "k_Integer", ",", "z_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"UnitCircle", ",", "k", ",", 
      RowBox[{"MapToCircle", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"UnitCircle", ",", "k", ",", 
      RowBox[{"MapToCircle", "[", 
       RowBox[{"f", ",", "\[Infinity]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{"s_", ",", 
     RowBox[{"f_", "?", "CircleDomainQ"}], ",", "k_Integer", ",", "z_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"s", ",", "UnitCircle", ",", "k", ",", 
      RowBox[{"MapToCircle", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"UnitCircle", ",", "k", ",", 
      RowBox[{"MapToCircle", "[", 
       RowBox[{"f", ",", "\[Infinity]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisS", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_", "?", "CircleDomainQ"}], ",", "k_Integer", ",", "z_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"CauchyBasisS", "[", 
      RowBox[{"s", ",", "UnitCircle", ",", "k", ",", 
       RowBox[{"MapToCircle", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"UnitCircle", ",", "k", ",", 
       RowBox[{"MapToCircle", "[", 
        RowBox[{"f", ",", "\[Infinity]"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisS", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", 
     RowBox[{"d_", "?", "CircleDomainQ"}], ",", 
     RowBox[{"i_", ";;", "j_"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "k", "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"CauchyBasisS", "[", 
        RowBox[{"s", ",", "d", ",", "k", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "i", ",", "j"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{
     RowBox[{"d_", "?", "CircleDomainQ"}], ",", 
     RowBox[{"i_", ";;", "j_"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "k", "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"CauchyBasis", "[", 
        RowBox[{"d", ",", "k", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "i", ",", "j"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", 
     RowBox[{"d_", "?", "CircleDomainQ"}], ",", 
     RowBox[{"i_", ";;", "j_"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "k", "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"CauchyBasis", "[", 
        RowBox[{"s", ",", "d", ",", "k", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "i", ",", "j"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["FP and Cauchy Matrx", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_", "?", "FunQ"}], ",", "k_", ",", 
      RowBox[{"g_", "?", "FunQ"}]}], "]"}], ":=", 
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{"s", ",", 
      RowBox[{"f", "//", "Domain"}], ",", "k", ",", "g"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"s_", "?", "SignQ"}], ",", 
       RowBox[{"d_", "?", "CircleDomainQ"}], ",", 
       RowBox[{"i_", ";;", "j_"}], ",", "lf_"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"Domain", "[", "lf", "]"}], "~", "NEqual", "~", "d"}]}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"LFun", "[", 
       RowBox[{"#", ",", 
        RowBox[{"lf", "//", "Domain"}]}], "]"}], "&"}], "/@", 
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"s", ",", "d", ",", 
       RowBox[{"i", ";;", "j"}], ",", 
       RowBox[{"lf", "//", "Points"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`CauchyMatrix", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", 
     RowBox[{"lf_LFun", "?", "ScalarFunQ"}], ",", "lf2_LFun"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"(", 
      RowBox[{"FiniteValues", "/@", 
       RowBox[{"FPCauchyBasis", "[", 
        RowBox[{"s", ",", "lf", ",", 
         RowBox[{"Span", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lf", "//", "FFT"}], "//", "IndexRange"}], ")"}]}], ",", 
         "lf2"}], "]"}]}], ")"}], "]"}], ".", 
    RowBox[{"FiniteTransformMatrix", "[", "lf", "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SpecialFunctions", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Psi]p", ",", "\[Psi]m", ",", "\[Phi]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", 
    RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}], " ", 
    SuperscriptBox["z", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "]"}]}], " ", "+", " ", 
      "1"}]], " ", 
    RowBox[{"LerchPhi", "[", 
     RowBox[{
      SuperscriptBox["z", "2"], ",", "1", ",", 
      RowBox[{
       FractionBox["1", "2"], "+", " ", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "]"}]}]}], " ", 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]", "[", 
    RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ArcTanh", "[", "z", "]"}], "-", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"n", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Mu]", "[", 
     RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
    RowBox[{"z", "~", "NEqual", "~", "1"}]}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"PolyGamma", "[", 
         RowBox[{"0", ",", 
          FractionBox["1", "2"]}], "]"}]}], "+", 
       RowBox[{"PolyGamma", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          FractionBox["1", "2"], "+", 
          RowBox[{"Floor", "[", 
           FractionBox[
            RowBox[{"1", "+", "n"}], "2"], "]"}]}]}], "]"}]}], ")"}]}], "//", 
    "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Mu]", "[", 
      RowBox[{"n_", ",", "z_"}], "]"}], "/;", 
     RowBox[{"z", "\[Equal]", 
      RowBox[{"-", "1"}]}]}], ":=", 
    RowBox[{"-", 
     RowBox[{"\[Mu]", "[", 
      RowBox[{"n", ",", "1"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]ms", "[", 
    RowBox[{"m_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"j", "=", "1"}], "m"], 
    FractionBox[
     RowBox[{"z", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "j"}], " ", "-", "1"}], ")"}]}], 
     RowBox[{
      RowBox[{"2", " ", "j"}], " ", "-", "1"}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Mu]S", "[", 
     RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
    RowBox[{"\[Mu]ms", "[", 
     RowBox[{
      RowBox[{"Floor", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "]"}], ",", "z"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`\[Psi]p", "[", 
     RowBox[{"0", ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ArcTanh", "[", "z", "]"}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"\[Psi]pS", ",", "Listable"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pS", "[", 
    RowBox[{"0", ",", "z_"}], "]"}], ":=", 
   RowBox[{"ArcTanh", "[", "z", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pS", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Positive"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"z", "^", "n"}], 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"ArcTanh", "[", "z", "]"}], "-", 
      RowBox[{"\[Mu]S", "[", 
       RowBox[{"n", ",", 
        RowBox[{"1", "/", "z"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pS", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Negative"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"z", "^", "n"}], 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"ArcTanh", "[", "z", "]"}], "-", 
      RowBox[{"\[Mu]S", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "n"}], "-", "1"}], ",", "z"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pS", "[", 
    RowBox[{
     RowBox[{"n_", "?", "EvenQ"}], ",", 
     RowBox[{"z_", "?", "ZeroQ"}]}], "]"}], ":=", "0."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]pS", "[", 
     RowBox[{
      RowBox[{"n_", "?", "OddQ"}], ",", 
      RowBox[{"z_", "?", "ZeroQ"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "n"]}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]p\[Phi]", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Positive"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"z", "^", "n"}], 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"ArcTanh", "[", "z", "]"}], "-", 
      RowBox[{"ArcTanh", "[", 
       RowBox[{"1", "/", "z"}], "]"}], "+", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"n", ",", 
        RowBox[{"1", "/", "z"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]p\[Phi]", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Negative"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"z", "^", "n"}], 
    RowBox[{"(", " ", 
     RowBox[{"\[Phi]", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "n"}], "-", "1"}], ",", "z"}], "]"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]m\[Phi]", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Positive"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"z", "^", "n"}], 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"\[Psi]m", "[", 
       RowBox[{"0", ",", "z"}], "]"}], "-", 
      RowBox[{"\[Mu]", "[", 
       RowBox[{"n", ",", 
        RowBox[{"1", "/", "z"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]m\[Phi]", "[", 
     RowBox[{
      RowBox[{"n_", "?", "Negative"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"z", "^", "n"}], 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"\[Psi]m", "[", 
        RowBox[{"0", ",", "z"}], "]"}], "-", 
       RowBox[{"\[Mu]", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "n"}], "-", "1"}], ",", "z"}], "]"}]}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pH", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Negative"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "n"}], ")"}], "/", "2"}], "]"}]}], "}"}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["z", 
        RowBox[{"n", "+", "1", "+", 
         RowBox[{"2", " ", "M"}]}]], 
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{"z", "^", "2"}]}]], " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{
          FractionBox["3", "2"], "+", "M"}], ",", 
         FractionBox[
          SuperscriptBox["z", "2"], 
          RowBox[{
           RowBox[{"z", "^", "2"}], "-", "1"}]]}], "]"}]}], 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "M"}]}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pH", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Positive"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "^", "n"}], "  ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ArcTanh", "[", "z", "]"}], "-", 
         RowBox[{"ArcTanh", "[", 
          RowBox[{"1", "/", "z"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "M"}]}]], 
       SuperscriptBox["z", 
        RowBox[{"n", "-", "1", "-", 
         RowBox[{"2", " ", "M"}]}]], " ", 
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{"z", "^", 
          RowBox[{"(", 
           RowBox[{"-", "2"}], ")"}]}]}]], " ", " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{
          FractionBox["3", "2"], "+", "M"}], ",", 
         FractionBox[
          SuperscriptBox["z", 
           RowBox[{"-", "2"}]], 
          RowBox[{
           RowBox[{"z", "^", 
            RowBox[{"(", 
             RowBox[{"-", "2"}], ")"}]}], "-", "1"}]]}], "]"}]}]}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"\[Psi]p", ",", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]p", "[", 
    RowBox[{
     RowBox[{"n_", "?", "EvenQ"}], ",", 
     RowBox[{"z_", "?", "ZeroQ"}]}], "]"}], ":=", "0."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]p", "[", 
     RowBox[{
      RowBox[{"n_", "?", "OddQ"}], ",", 
      RowBox[{"z_", "?", "ZeroQ"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "n"]}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]p", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Positive"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Psi]pS", "[", 
     RowBox[{"n", ",", 
      RowBox[{"z", "//", "N"}]}], "]"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]p", "[", 
     RowBox[{
      RowBox[{"n_", "?", "Negative"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"\[Psi]pH", "[", 
      RowBox[{"n", ",", 
       RowBox[{"z", "//", "N"}]}], "]"}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`\[Psi]m", "[", 
    RowBox[{"0", ",", "z_"}], "]"}], ":=", 
   RowBox[{"ArcTanh", "[", 
    RowBox[{"1", "/", "z"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]m", "[", 
    RowBox[{"n_", ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]m\[Phi]", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Negative"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "n"}], ")"}], "/", "2"}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "^", "n"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ArcTanh", "[", 
          RowBox[{"1", "/", "z"}], "]"}], "-", 
         RowBox[{"ArcTanh", "[", "z", "]"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "M"}]}]], 
       SuperscriptBox["z", 
        RowBox[{"n", "+", "1", "+", 
         RowBox[{"2", " ", "M"}]}]], " ", 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          FractionBox["1", "2"], " ", "+", "M"}], ",", 
         RowBox[{
          FractionBox["3", "2"], "+", "M"}], ",", 
         SuperscriptBox["z", "2"]}], "]"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]m\[Phi]", "[", 
     RowBox[{
      RowBox[{"n_", "?", "Positive"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M", "=", 
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "]"}]}], "}"}], ",", 
      FractionBox[
       RowBox[{
        SuperscriptBox["z", 
         RowBox[{"n", "-", "1", "-", 
          RowBox[{"2", " ", "M"}]}]], " ", 
        RowBox[{"Hypergeometric2F1", "[", 
         RowBox[{"1", ",", 
          RowBox[{
           FractionBox["1", "2"], "+", "M"}], ",", 
          RowBox[{
           FractionBox["3", "2"], "+", "M"}], ",", 
          FractionBox["1", 
           SuperscriptBox["z", "2"]]}], "]"}]}], 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "M"}]}]]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]m", "[", 
    RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"\[Psi]m\[Phi]", "[", 
    RowBox[{"n", ",", "z"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["IFun Cauchy Basis", "Section"],

Cell[CellGroupData[{

Cell["Basis", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{"UnitInterval", ",", "k_Integer", ",", "x_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "/", 
     RowBox[{"(", 
      RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Psi]p", "[", 
       RowBox[{
        RowBox[{"k", "-", "1"}], ",", 
        RowBox[{"IntervalToInnerCircle", "[", "x", "]"}]}], "]"}], "+", 
      RowBox[{"\[Psi]p", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "k"}], "+", "1"}], ",", 
        RowBox[{"IntervalToInnerCircle", "[", "x", "]"}]}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "UnitInterval", ",", "k_Integer", ",", "x_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "/", 
     RowBox[{"(", 
      RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Psi]p", "[", 
       RowBox[{
        RowBox[{"k", "-", "1"}], ",", 
        RowBox[{"IntervalToBottomCircle", "[", "x", "]"}]}], "]"}], "+", 
      RowBox[{"\[Psi]p", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "k"}], "+", "1"}], ",", 
        RowBox[{"IntervalToBottomCircle", "[", "x", "]"}]}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "UnitInterval", ",", "k_Integer", ",", "x_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"(", 
       RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Psi]p", "[", 
        RowBox[{
         RowBox[{"k", "-", "1"}], ",", 
         RowBox[{"IntervalToTopCircle", "[", "x", "]"}]}], "]"}], "+", 
       RowBox[{"\[Psi]p", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "k"}], "+", "1"}], ",", 
         RowBox[{"IntervalToTopCircle", "[", "x", "]"}]}], "]"}]}], ")"}]}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{
      RowBox[{"f_", "?", "RightEndpointInfinityQ"}], ",", "k_Integer", ",", 
      "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"UnitInterval", ",", "k", ",", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"UnitInterval", ",", "1", ",", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"I", " ", "\[Pi]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Mu]", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", "1."}], "]"}], "+", 
        RowBox[{"\[Mu]", "[", 
         RowBox[{
          RowBox[{"k", "-", "2"}], ",", "1."}], "]"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_", "?", "RightEndpointInfinityQ"}], ",", "k_Integer", ",", 
      "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"s", ",", "UnitInterval", ",", "k", ",", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"s", ",", "UnitInterval", ",", "1", ",", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"I", " ", "\[Pi]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Mu]", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", "1."}], "]"}], "+", 
        RowBox[{"\[Mu]", "[", 
         RowBox[{
          RowBox[{"k", "-", "2"}], ",", "1."}], "]"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{
      RowBox[{"f_", "?", "LeftEndpointInfinityQ"}], ",", "k_Integer", ",", 
      "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"UnitInterval", ",", "k", ",", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", "k", ")"}]}], 
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"UnitInterval", ",", "1", ",", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", "k", ")"}]}], 
       RowBox[{"I", " ", "\[Pi]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Mu]", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", 
          RowBox[{"-", "1."}]}], "]"}], "+", 
        RowBox[{"\[Mu]", "[", 
         RowBox[{
          RowBox[{"k", "-", "2"}], ",", 
          RowBox[{"-", "1."}]}], "]"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_", "?", "LeftEndpointInfinityQ"}], ",", "k_Integer", ",", 
      "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"s", ",", "UnitInterval", ",", "k", ",", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", "k", ")"}]}], 
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"s", ",", "UnitInterval", ",", "1", ",", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", "k", ")"}]}], 
       RowBox[{"I", " ", "\[Pi]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Mu]", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", 
          RowBox[{"-", "1."}]}], "]"}], "+", 
        RowBox[{"\[Mu]", "[", 
         RowBox[{
          RowBox[{"k", "-", "2"}], ",", 
          RowBox[{"-", "1."}]}], "]"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{
     RowBox[{"f_", "?", "IntervalDomainQ"}], ",", "k_Integer", ",", "z_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"UnitInterval", ",", "k", ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"UnitInterval", ",", "k", ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"f", ",", "\[Infinity]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasis", "[", 
    RowBox[{"s_", ",", 
     RowBox[{"f_", "?", "IntervalDomainQ"}], ",", "k_Integer", ",", "z_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"s", ",", "UnitInterval", ",", "k", ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"UnitInterval", ",", "k", ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"f", ",", "\[Infinity]"}], "]"}]}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivative", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]msD", "[", 
    RowBox[{"m_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"1", "+", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "2"}], "m"], 
     RowBox[{"z", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "j"}], " ", "-", "2"}], ")"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Mu]SD", "[", 
     RowBox[{"n_", ",", "z_"}], "]"}], ":=", 
    RowBox[{"\[Mu]msD", "[", 
     RowBox[{
      RowBox[{"Floor", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "]"}], ",", "z"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`\[Psi]pD", "[", 
     RowBox[{"0", ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"ArcTanh", "'"}], "[", "z", "]"}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"\[Psi]pSD", ",", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pSD", "[", 
    RowBox[{"0", ",", "z_"}], "]"}], ":=", 
   RowBox[{"ArcTanh", "[", "z", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pSD", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Positive"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"n", " ", 
     RowBox[{"z", "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}], 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"ArcTanh", "[", "z", "]"}], "-", 
       RowBox[{"\[Mu]S", "[", 
        RowBox[{"n", ",", 
         RowBox[{"1", "/", "z"}]}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["z", "n"], 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"ArcTanh", "'"}], "[", "z", "]"}], "+", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"z", "^", "2"}]}], 
        RowBox[{"\[Mu]SD", "[", 
         RowBox[{"n", ",", 
          RowBox[{"1", "/", "z"}]}], "]"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]pSD", "[", 
     RowBox[{
      RowBox[{"n_", "?", "Negative"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"n", " ", 
      RowBox[{"z", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}], 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"ArcTanh", "[", "z", "]"}], "-", 
        RowBox[{"\[Mu]S", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "n"}], "-", "1"}], ",", "z"}], "]"}]}], ")"}]}], "+", 
     
     RowBox[{
      RowBox[{"z", "^", "n"}], " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ArcTanh", "'"}], "[", "z", "]"}], "-", 
        RowBox[{"\[Mu]SD", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "n"}], "-", "1"}], ",", "z"}], "]"}]}], ")"}]}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pHD", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Negative"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "n"}], ")"}], "/", "2"}], "]"}]}], "}"}], ",", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "M"}]}]], 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", 
          SuperscriptBox["z", 
           RowBox[{"2", "+", 
            RowBox[{"2", " ", "M"}], "+", "n"}]], " ", 
          RowBox[{"Hypergeometric2F1", "[", 
           RowBox[{"1", ",", "1", ",", 
            RowBox[{
             FractionBox["3", "2"], "+", "M"}], ",", 
            FractionBox[
             SuperscriptBox["z", "2"], 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["z", "2"]}]]}], "]"}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["z", "2"]}], ")"}], "2"]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "M"}], "+", "n"}], ")"}], " ", 
          SuperscriptBox["z", 
           RowBox[{
            RowBox[{"2", " ", "M"}], "+", "n"}]], " ", 
          RowBox[{"Hypergeometric2F1", "[", 
           RowBox[{"1", ",", "1", ",", 
            RowBox[{
             FractionBox["3", "2"], "+", "M"}], ",", 
            FractionBox[
             SuperscriptBox["z", "2"], 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["z", "2"]}]]}], "]"}]}], 
         RowBox[{"1", "-", 
          SuperscriptBox["z", "2"]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["z", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "M"}], "+", "n"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"2", " ", 
               SuperscriptBox["z", "3"]}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["z", "2"]}], ")"}], "2"]]}], "+", 
            FractionBox[
             RowBox[{"2", " ", "z"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["z", "2"]}]]}], ")"}], " ", 
          RowBox[{"Hypergeometric2F1", "[", 
           RowBox[{"2", ",", "2", ",", 
            RowBox[{
             FractionBox["5", "2"], "+", "M"}], ",", 
            FractionBox[
             SuperscriptBox["z", "2"], 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["z", "2"]}]]}], "]"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox["3", "2"], "+", "M"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pHD", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Positive"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "]"}]}], "}"}], ",", 
     RowBox[{
      SuperscriptBox["z", "n"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"ArcTanh", "[", 
              FractionBox["1", "z"], "]"}]}], "+", 
            RowBox[{"ArcTanh", "[", "z", "]"}]}], ")"}]}], "z"], "-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["z", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "M"}]], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "n", "+", 
            SuperscriptBox["z", "2"], "-", 
            RowBox[{"n", " ", 
             SuperscriptBox["z", "2"]}], "+", 
            RowBox[{"2", " ", "M", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"Hypergeometric2F1", "[", 
           RowBox[{"1", ",", "1", ",", 
            RowBox[{
             FractionBox["3", "2"], "+", "M"}], ",", 
            FractionBox["1", 
             RowBox[{"1", "-", 
              SuperscriptBox["z", "2"]}]]}], "]"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]}]], "+", 
        FractionBox[
         RowBox[{"4", " ", 
          SuperscriptBox["z", 
           RowBox[{"2", "-", 
            RowBox[{"2", " ", "M"}]}]], " ", 
          RowBox[{"Hypergeometric2F1", "[", 
           RowBox[{"2", ",", "2", ",", 
            RowBox[{
             FractionBox["5", "2"], "+", "M"}], ",", 
            FractionBox["1", 
             RowBox[{"1", "-", 
              SuperscriptBox["z", "2"]}]]}], "]"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"3", "+", 
            RowBox[{"8", " ", "M"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["M", "2"]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "3"]}]]}], ")"}]}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"\[Psi]pD", ",", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pD", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Positive"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Psi]pSD", "[", 
     RowBox[{"n", ",", 
      RowBox[{"z", "//", "N"}]}], "]"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pD", "[", 
    RowBox[{
     RowBox[{"n_", "?", "Negative"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Psi]pHD", "[", 
     RowBox[{"n", ",", 
      RowBox[{"z", "//", "N"}]}], "]"}], "//", "N"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`CauchyBasisD", "[", 
    RowBox[{"_", ",", "_Integer", ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{"f_IFun", ",", "k_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{
     RowBox[{"f", "//", "Domain"}], ",", "k", ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"s_", ",", "f_IFun", ",", "k_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"s", ",", 
      RowBox[{"f", "//", "Domain"}], ",", "k", ",", "x"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{"UnitInterval", ",", "k_", ",", "x_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "/", 
     RowBox[{"(", 
      RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
    RowBox[{
     RowBox[{"IntervalToInnerCircle", "'"}], "[", "x", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Psi]pD", "[", 
       RowBox[{
        RowBox[{"k", "-", "1"}], ",", 
        RowBox[{"IntervalToInnerCircle", "[", "x", "]"}]}], "]"}], " ", "+", 
      RowBox[{"\[Psi]pD", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "k"}], "+", "1"}], ",", 
        RowBox[{"IntervalToInnerCircle", "[", "x", "]"}]}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "UnitInterval", ",", "k_", ",", "x_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "/", 
     RowBox[{"(", 
      RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
    RowBox[{
     RowBox[{"IntervalToBottomCircle", "'"}], "[", "x", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Psi]pD", "[", 
       RowBox[{
        RowBox[{"k", "-", "1"}], ",", 
        RowBox[{"IntervalToBottomCircle", "[", "x", "]"}]}], "]"}], "+", 
      RowBox[{"\[Psi]pD", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "k"}], "+", "1"}], ",", 
        RowBox[{"IntervalToBottomCircle", "[", "x", "]"}]}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "UnitInterval", ",", "k_", ",", "x_"}], "]"}], 
    ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"(", 
       RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
     RowBox[{"IntervalToTopCircle", "[", "x", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Psi]pD", "[", 
        RowBox[{
         RowBox[{"k", "-", "1"}], ",", 
         RowBox[{"IntervalToTopCircle", "[", "x", "]"}]}], "]"}], "+", 
       RowBox[{"\[Psi]pD", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "k"}], "+", "1"}], ",", 
         RowBox[{"IntervalToTopCircle", "[", "x", "]"}]}], "]"}]}], ")"}]}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{
      RowBox[{"f_", "?", "RightEndpointInfinityQ"}], ",", "k_", ",", "z_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"MapToIntervalD", "[", 
      RowBox[{"f", ",", "z"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CauchyBasisD", "[", 
        RowBox[{"UnitInterval", ",", "k", ",", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
       RowBox[{"CauchyBasisD", "[", 
        RowBox[{"UnitInterval", ",", "1", ",", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_", "?", "RightEndpointInfinityQ"}], ",", "k_", ",", "z_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"MapToIntervalD", "[", 
      RowBox[{"f", ",", "z"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CauchyBasisD", "[", 
        RowBox[{"s", ",", "UnitInterval", ",", "k", ",", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
       RowBox[{"CauchyBasisD", "[", 
        RowBox[{"s", ",", "UnitInterval", ",", "1", ",", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{
      RowBox[{"f_", "?", "LeftEndpointInfinityQ"}], ",", "k_", ",", "z_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"MapToIntervalD", "[", 
      RowBox[{"f", ",", "z"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CauchyBasisD", "[", 
        RowBox[{"UnitInterval", ",", "k", ",", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"(", "k", ")"}]}], 
        RowBox[{"CauchyBasisD", "[", 
         RowBox[{"UnitInterval", ",", "1", ",", 
          RowBox[{"MapToInterval", "[", 
           RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_", "?", "LeftEndpointInfinityQ"}], ",", "k_", ",", "z_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"MapToIntervalD", "[", 
      RowBox[{"f", ",", "z"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CauchyBasisD", "[", 
        RowBox[{"s", ",", "UnitInterval", ",", "k", ",", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"(", "k", ")"}]}], 
        RowBox[{"CauchyBasisD", "[", 
         RowBox[{"s", ",", "UnitInterval", ",", "1", ",", 
          RowBox[{"MapToInterval", "[", 
           RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{
     RowBox[{"f_", "?", "DomainQ"}], ",", "k_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapToIntervalD", "[", 
     RowBox[{"f", ",", "z"}], "]"}], " ", 
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"UnitInterval", ",", "k", ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{"s_", ",", 
     RowBox[{"f_", "?", "DomainQ"}], ",", "k_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapToIntervalD", "[", 
     RowBox[{"f", ",", "z"}], "]"}], " ", 
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"s", ",", "UnitInterval", ",", "k", ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Singularity Data", "Section"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RiemannHilbert`LeftSingularityDataBasis", "[", 
      RowBox[{"f_IFun", ",", "k_"}], "]"}], ":=", 
     RowBox[{"LeftSingularityDataBasis", "[", 
      RowBox[{
       RowBox[{"f", "//", "Domain"}], ",", "k"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeftSingularityDataBasis", "[", 
      RowBox[{"f_IFun", ",", "k_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"LeftSingularityDataBasis", "[", 
      RowBox[{
       RowBox[{"f", "//", "Domain"}], ",", "k", ",", "t"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeftSingularityDataBasis", "[", 
      RowBox[{"s_", ",", "f_IFun", ",", "k_"}], "]"}], ":=", 
     RowBox[{"LeftSingularityDataBasis", "[", 
      RowBox[{"s", ",", 
       RowBox[{"f", "//", "Domain"}], ",", "k"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannHilbert`RightSingularityDataBasis", "[", 
      RowBox[{"f_IFun", ",", "k_"}], "]"}], ":=", 
     RowBox[{"RightSingularityDataBasis", "[", 
      RowBox[{
       RowBox[{"f", "//", "Domain"}], ",", "k"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightSingularityDataBasis", "[", 
      RowBox[{"f_IFun", ",", "k_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"RightSingularityDataBasis", "[", 
      RowBox[{
       RowBox[{"f", "//", "Domain"}], ",", "k", ",", "t"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightSingularityDataBasis", "[", 
      RowBox[{"s_", ",", "f_IFun", ",", "k_"}], "]"}], ":=", 
     RowBox[{"RightSingularityDataBasis", "[", 
      RowBox[{"s", ",", 
       RowBox[{"f", "//", "Domain"}], ",", "k"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeftSingularityDataBasis", "[", 
      RowBox[{"UnitInterval", ",", "k_Integer"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"k", "-", "1"}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"Log", "[", "2", "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "I", " ", "\[Pi]"}], ")"}]}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"k", "-", "1"}], ")"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"I", " ", "\[Pi]"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Mu]", "[", 
            RowBox[{
             RowBox[{"k", "-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "]"}], "+", 
           RowBox[{"\[Mu]", "[", 
            RowBox[{
             RowBox[{"k", "-", "2"}], ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"k", "-", "1"}], ")"}]}]}], "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", "I", " ", "\[Pi]"}], ")"}]}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightSingularityDataBasis", "[", 
      RowBox[{"UnitInterval", ",", "k_Integer"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Log", "[", "2", "]"}]}], "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", "I", " ", "\[Pi]"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"I", " ", "\[Pi]"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Mu]", "[", 
            RowBox[{
             RowBox[{"k", "-", "1"}], ",", "1"}], "]"}], "+", 
           RowBox[{"\[Mu]", "[", 
            RowBox[{
             RowBox[{"k", "-", "2"}], ",", "1"}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", "I", " ", "\[Pi]"}], ")"}]}], ",", "1"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeftSingularityDataBasis", "[", 
      RowBox[{
       RowBox[{"f_", "?", "RightEndpointInfinityQ"}], ",", "k_Integer"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"LeftSingularityDataBasis", "[", 
       RowBox[{"UnitInterval", ",", "k"}], "]"}], "//", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "-", 
          RowBox[{
           RowBox[{"LeftSingularityDataBasis", "[", 
            RowBox[{"UnitInterval", ",", "1"}], "]"}], "\[LeftDoubleBracket]",
            "1", "\[RightDoubleBracket]"}], "-", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"I", " ", "\[Pi]"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Mu]", "[", 
              RowBox[{
               RowBox[{"k", "-", "1"}], ",", "1"}], "]"}], "+", 
             RowBox[{"\[Mu]", "[", 
              RowBox[{
               RowBox[{"k", "-", "2"}], ",", "1"}], "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", 
               RowBox[{"f", "//", "LeftEndpoint"}]}], "]"}], "]"}], "]"}]}]}],
          ",", 
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", 
            RowBox[{"Arg", "[", 
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", 
               RowBox[{"f", "//", "LeftEndpoint"}]}], "]"}], "]"}]}], 
           "]"}]}]}], "}"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightSingularityDataBasis", "[", 
      RowBox[{
       RowBox[{"f_", "?", "LeftEndpointInfinityQ"}], ",", "k_Integer"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"RightSingularityDataBasis", "[", 
       RowBox[{"UnitInterval", ",", "k"}], "]"}], "//", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "-", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"k", "-", "1"}], ")"}]}], " ", 
           RowBox[{
            RowBox[{"RightSingularityDataBasis", "[", 
             RowBox[{"UnitInterval", ",", "1"}], "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "-", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"k", "-", "1"}], ")"}]}], 
            RowBox[{"I", " ", "\[Pi]"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Mu]", "[", 
              RowBox[{
               RowBox[{"k", "-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "]"}], "+", 
             RowBox[{"\[Mu]", "[", 
              RowBox[{
               RowBox[{"k", "-", "2"}], ",", 
               RowBox[{"-", "1"}]}], "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", 
               RowBox[{"f", "//", "RightEndpoint"}]}], "]"}], "]"}], 
            "]"}]}]}], ",", 
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", 
            RowBox[{"Arg", "[", 
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", 
               RowBox[{"f", "//", "RightEndpoint"}]}], "]"}], "]"}]}], 
           "]"}]}]}], "}"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeftSingularityDataBasis", "[", 
      RowBox[{
       RowBox[{"f_", "?", "DomainQ"}], ",", "k_Integer"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"LeftSingularityDataBasis", "[", 
       RowBox[{"UnitInterval", ",", "k"}], "]"}], "//", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "-", 
          RowBox[{"CauchyBasis", "[", 
           RowBox[{"UnitInterval", ",", "k", ",", 
            RowBox[{"MapToInterval", "[", 
             RowBox[{"f", ",", "\[Infinity]"}], "]"}]}], "]"}], "+", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", 
               RowBox[{"f", "//", "LeftEndpoint"}]}], "]"}], "]"}], "]"}]}]}],
          ",", 
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", 
            RowBox[{"Arg", "[", 
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", 
               RowBox[{"f", "//", "LeftEndpoint"}]}], "]"}], "]"}]}], 
           "]"}]}]}], "}"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightSingularityDataBasis", "[", 
      RowBox[{
       RowBox[{"f_", "?", "DomainQ"}], ",", "k_Integer"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"RightSingularityDataBasis", "[", 
       RowBox[{"UnitInterval", ",", "k"}], "]"}], "//", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "-", 
          RowBox[{"CauchyBasis", "[", 
           RowBox[{"UnitInterval", ",", "k", ",", 
            RowBox[{"MapToInterval", "[", 
             RowBox[{"f", ",", "\[Infinity]"}], "]"}]}], "]"}], "+", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", 
               RowBox[{"f", "//", "RightEndpoint"}]}], "]"}], "]"}], 
            "]"}]}]}], ",", 
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", 
            RowBox[{"Arg", "[", 
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", 
               RowBox[{"f", "//", "RightEndpoint"}]}], "]"}], "]"}]}], 
           "]"}]}]}], "}"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeftSingularityDataBasis", "[", 
      RowBox[{
       RowBox[{"f_", "?", "DomainQ"}], ",", "k_Integer", ",", 
       RowBox[{"t_", "?", "ScalarQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"LeftSingularityDataBasis", "[", 
       RowBox[{"f", ",", "k"}], "]"}], "//", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           "I", " ", 
           RowBox[{"Arg", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", "t"}], "]"}]}], "]"}]}]}], ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "}"}],
        "&"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeftSingularityDataBasis", "[", 
      RowBox[{
       RowBox[{"s_", "?", "SignQ"}], ",", "f_", ",", "k_Integer"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"LeftSingularityDataBasis", "[", 
       RowBox[{"f", ",", "k"}], "]"}], "//", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "-", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           "I", " ", "s", " ", "\[Pi]"}]}], ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "}"}],
        "&"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightSingularityDataBasis", "[", 
      RowBox[{
       RowBox[{"f_", "?", "DomainQ"}], ",", "k_Integer", ",", 
       RowBox[{"t_", "?", "ScalarQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"RightSingularityDataBasis", "[", 
       RowBox[{"f", ",", "k"}], "]"}], "//", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           "I", " ", 
           RowBox[{"Arg", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", "t"}], "]"}]}], "]"}]}]}], ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "}"}],
        "&"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightSingularityDataBasis", "[", 
      RowBox[{
       RowBox[{"s_", "?", "SignQ"}], ",", "f_", ",", "k_Integer"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"RightSingularityDataBasis", "[", 
       RowBox[{"f", ",", "k"}], "]"}], "//", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           "I", " ", "s", " ", "\[Pi]"}]}], ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "}"}],
        "&"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannHilbert`LeftSingularityData", "[", "f_IFun", "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"MapDot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Most", "[", 
           RowBox[{"LeftSingularityDataBasis", "[", 
            RowBox[{"f", ",", "#"}], "]"}], "]"}], "&"}], ",", 
         RowBox[{"f", "//", "DCT"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LeftSingularityDataBasis", "[", 
          RowBox[{"f", ",", "1"}], "]"}], "//", "Last"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannHilbert`RightSingularityData", "[", "f_IFun", "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"MapDot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Most", "[", 
           RowBox[{"RightSingularityDataBasis", "[", 
            RowBox[{"f", ",", "#"}], "]"}], "]"}], "&"}], ",", 
         RowBox[{"f", "//", "DCT"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightSingularityDataBasis", "[", 
          RowBox[{"f", ",", "1"}], "]"}], "//", "Last"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeftSingularityData", "[", 
      RowBox[{"f_IFun", ",", 
       RowBox[{"t_", "?", "ScalarQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"LeftSingularityData", "[", "f", "]"}], "//", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           "I", " ", 
           RowBox[{"Arg", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", "t"}], "]"}]}], "]"}]}]}], ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "}"}],
        "&"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeftSingularityData", "[", 
      RowBox[{
       RowBox[{"s_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[Equal]", "1"}], "||", 
           RowBox[{"#", "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "&"}], ")"}]}], ",", "f_IFun"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"LeftSingularityData", "[", "f", "]"}], "//", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "-", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           "I", " ", "s", " ", "\[Pi]"}]}], ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "}"}],
        "&"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightSingularityData", "[", 
      RowBox[{"f_IFun", ",", 
       RowBox[{"t_", "?", "ScalarQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"RightSingularityData", "[", "f", "]"}], "//", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           "I", " ", 
           RowBox[{"Arg", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", "t"}], "]"}]}], "]"}]}]}], ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "}"}],
        "&"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightSingularityData", "[", 
      RowBox[{
       RowBox[{"s_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[Equal]", "1"}], "||", 
           RowBox[{"#", "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "&"}], ")"}]}], ",", "f_IFun"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"RightSingularityData", "[", "f", "]"}], "//", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           "I", " ", "s", " ", "\[Pi]"}]}], ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "}"}],
        "&"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Finite Part Cauchy Basis", "Section"],

Cell[CellGroupData[{

Cell["Same domains", "Subsection"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"+", "1"}], ",", "UnitInterval", ",", "k_Integer", ",", 
       RowBox[{"g_IFun", "?", "UnitIntervalFunQ"}]}], "]"}], ":=", 
     RowBox[{"IFun", "[", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "j", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"LeftSingularityDataBasis", "[", 
              RowBox[{
               RowBox[{"+", "1"}], ",", "UnitInterval", ",", "k"}], "]"}], "//",
              "First"}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ArcTanh", "[", 
                RowBox[{"IntervalToBottomCircle", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Points", "[", "g", "]"}], "//", "Rest"}], "//", 
                  "Most"}], "]"}], "]"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"I", " ", "\[Pi]"}], ")"}]}], " ", 
             RowBox[{"ChebyshevT", "[", 
              RowBox[{
               RowBox[{"k", "-", "1"}], ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Points", "[", "g", "]"}], "//", "Rest"}], "//", 
                "Most"}]}], "]"}]}], "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"PadRight", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", " ", 
                    RowBox[{"Riffle", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "j"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1.", ",", 
                    RowBox[{"k", "-", "1"}], ",", "2"}], "}"}]}], "]"}], 
                    "]"}], ",", "0"}], "]"}]}], "//", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"OddQ", "[", "k", "]"}], ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "0", "}"}], ",", "#"}], "]"}], ",", "#"}], 
                    "]"}], "&"}], ")"}]}], ",", 
                    RowBox[{"Length", "[", "g", "]"}]}], "]"}], ")"}], "//", 
                   "HalfFirst"}], "//", "InverseDCT"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"2", " ", "I", " ", "\[Pi]"}], ")"}]}], "//", 
               "Rest"}], "//", "Most"}], ")"}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RightSingularityDataBasis", "[", 
              RowBox[{
               RowBox[{"+", "1"}], ",", "UnitInterval", ",", "k"}], "]"}], "//",
              "First"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       
       RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "UnitInterval", ",", "k_Integer", ",", 
       RowBox[{"g_IFun", "?", "UnitIntervalFunQ"}]}], "]"}], ":=", 
     RowBox[{"IFun", "[", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "j", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"LeftSingularityDataBasis", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "UnitInterval", ",", "k"}], "]"}], "//",
              "First"}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ArcTanh", "[", 
                RowBox[{"IntervalToTopCircle", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Points", "[", "g", "]"}], "//", "Rest"}], "//", 
                  "Most"}], "]"}], "]"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"I", " ", "\[Pi]"}], ")"}]}], " ", 
             RowBox[{"ChebyshevT", "[", 
              RowBox[{
               RowBox[{"k", "-", "1"}], ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Points", "[", "g", "]"}], "//", "Rest"}], "//", 
                "Most"}]}], "]"}]}], "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"PadRight", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", " ", 
                    RowBox[{"Riffle", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "j"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1.", ",", 
                    RowBox[{"k", "-", "1"}], ",", "2"}], "}"}]}], "]"}], 
                    "]"}], ",", "0"}], "]"}]}], "//", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"OddQ", "[", "k", "]"}], ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "0", "}"}], ",", "#"}], "]"}], ",", "#"}], 
                    "]"}], "&"}], ")"}]}], ",", 
                    RowBox[{"Length", "[", "g", "]"}]}], "]"}], ")"}], "//", 
                   "HalfFirst"}], "//", "InverseDCT"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"2", " ", "I", " ", "\[Pi]"}], ")"}]}], "//", 
               "Rest"}], "//", "Most"}], ")"}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RightSingularityDataBasis", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "UnitInterval", ",", "k"}], "]"}], "//",
              "First"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       
       RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FPCauchyBasis", "[", 
       RowBox[{
        RowBox[{"s_", "?", "SignQ"}], ",", 
        RowBox[{"f_", "?", "RightEndpointInfinityQ"}], ",", "k_Integer", ",", 
        "g_IFun"}], "]"}], "/;", 
      RowBox[{"f", "~", "NEqual", "~", 
       RowBox[{"Domain", "[", "g", "]"}]}]}], ":=", 
     RowBox[{"IFun", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Values", "[", 
          RowBox[{"FPCauchyBasis", "[", 
           RowBox[{"s", ",", "UnitInterval", ",", "k", ",", 
            RowBox[{"g", "//", "ToUnitInterval"}]}], "]"}], "]"}], "-", 
         RowBox[{"Values", "[", 
          RowBox[{"FPCauchyBasis", "[", 
           RowBox[{"s", ",", "UnitInterval", ",", "1", ",", 
            RowBox[{"g", "//", "ToUnitInterval"}]}], "]"}], "]"}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"I", " ", "\[Pi]"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Mu]", "[", 
             RowBox[{
              RowBox[{"k", "-", "1"}], ",", "1."}], "]"}], "+", 
            RowBox[{"\[Mu]", "[", 
             RowBox[{
              RowBox[{"k", "-", "2"}], ",", "1."}], "]"}]}], ")"}]}]}], "//", 
        
        RowBox[{
         RowBox[{"#", "+", 
          RowBox[{
           RowBox[{
            RowBox[{"LeftSingularityDataBasis", "[", 
             RowBox[{"UnitInterval", ",", "k"}], "]"}], 
            "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", 
               RowBox[{"f", "//", "LeftEndpoint"}]}], "]"}], "]"}], "]"}], 
           " ", 
           RowBox[{
            RowBox[{"BasisVector", "[", 
             RowBox[{"Length", "[", "#", "]"}], "]"}], "[", "1", "]"}]}]}], 
         "&"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FPCauchyBasis", "[", 
       RowBox[{
        RowBox[{"s_", "?", "SignQ"}], ",", 
        RowBox[{"f_", "?", "LeftEndpointInfinityQ"}], ",", "k_Integer", ",", 
        "g_"}], "]"}], "/;", 
      RowBox[{"f", "~", "NEqual", "~", 
       RowBox[{"Domain", "[", "g", "]"}]}]}], ":=", 
     RowBox[{"IFun", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Values", "[", 
          RowBox[{"FPCauchyBasis", "[", 
           RowBox[{"s", ",", "UnitInterval", ",", "k", ",", 
            RowBox[{"g", "//", "ToUnitInterval"}]}], "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", "k", ")"}]}], 
          RowBox[{"Values", "[", 
           RowBox[{"FPCauchyBasis", "[", 
            RowBox[{"s", ",", "UnitInterval", ",", "1", ",", 
             RowBox[{"g", "//", "ToUnitInterval"}]}], "]"}], "]"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", "k", ")"}]}], 
           RowBox[{"I", " ", "\[Pi]"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Mu]", "[", 
             RowBox[{
              RowBox[{"k", "-", "1"}], ",", 
              RowBox[{"-", "1."}]}], "]"}], "+", 
            RowBox[{"\[Mu]", "[", 
             RowBox[{
              RowBox[{"k", "-", "2"}], ",", 
              RowBox[{"-", "1."}]}], "]"}]}], ")"}]}]}], "//", 
        RowBox[{
         RowBox[{"#", "+", 
          RowBox[{
           RowBox[{
            RowBox[{"RightSingularityDataBasis", "[", 
             RowBox[{"UnitInterval", ",", "k"}], "]"}], 
            "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", 
               RowBox[{"f", "//", "RightEndpoint"}]}], "]"}], "]"}], "]"}], 
           " ", 
           RowBox[{
            RowBox[{"BasisVector", "[", 
             RowBox[{"Length", "[", "#", "]"}], "]"}], "[", 
            RowBox[{"-", "1"}], "]"}]}]}], "&"}]}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FPCauchyBasis", "[", 
       RowBox[{
        RowBox[{"s_", "?", "SignQ"}], ",", 
        RowBox[{"f_", "?", "DomainQ"}], ",", "k_Integer", ",", "g_IFun"}], 
       "]"}], "/;", 
      RowBox[{"f", "~", "NEqual", "~", 
       RowBox[{"Domain", "[", "g", "]"}]}]}], ":=", 
     RowBox[{"IFun", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Values", "[", 
         RowBox[{"FPCauchyBasis", "[", 
          RowBox[{"s", ",", "UnitInterval", ",", "k", ",", 
           RowBox[{"g", "//", "ToUnitInterval"}]}], "]"}], "]"}], "-", 
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"UnitInterval", ",", "k", ",", 
          RowBox[{"MapToInterval", "[", 
           RowBox[{"f", ",", "\[Infinity]"}], "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"RightSingularityDataBasis", "[", 
           RowBox[{"UnitInterval", ",", "k"}], "]"}], "\[LeftDoubleBracket]", 
          "2", "\[RightDoubleBracket]"}], 
         RowBox[{"Log", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"MapToIntervalD", "[", 
            RowBox[{"f", ",", 
             RowBox[{"f", "//", "RightEndpoint"}]}], "]"}], "]"}], "]"}], " ", 
         RowBox[{
          RowBox[{"BasisVector", "[", 
           RowBox[{"Length", "[", "g", "]"}], "]"}], "[", 
          RowBox[{"-", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"LeftSingularityDataBasis", "[", 
           RowBox[{"UnitInterval", ",", "k"}], "]"}], "\[LeftDoubleBracket]", 
          "2", "\[RightDoubleBracket]"}], 
         RowBox[{"Log", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"MapToIntervalD", "[", 
            RowBox[{"f", ",", 
             RowBox[{"f", "//", "LeftEndpoint"}]}], "]"}], "]"}], "]"}], " ", 
         
         RowBox[{
          RowBox[{"BasisVector", "[", 
           RowBox[{"Length", "[", "g", "]"}], "]"}], "[", "1", "]"}]}]}], ",", 
       RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Endpoits equal", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"!", 
           RowBox[{"RightEndpointInfinityQ", "[", "#", "]"}]}], "&&", 
          RowBox[{"!", 
           RowBox[{"LeftEndpointInfinityQ", "[", "#", "]"}]}]}], "&"}], 
        ")"}]}], ",", "k_Integer", ",", "g_IFun"}], "]"}], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
      RowBox[{"LeftEndpoint", "[", "g", "]"}]}], "&&", 
     RowBox[{
      RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
      RowBox[{"RightEndpoint", "[", "g", "]"}]}]}]}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LeftSingularityDataBasis", "[", 
          RowBox[{"f", ",", "k", ",", 
           RowBox[{"LeftContourArg", "[", "g", "]"}]}], "]"}], "//", 
         "First"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"CauchyBasis", "[", 
        RowBox[{"f", ",", "k", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"g", "//", "Points"}], "//", "Rest"}], "//", "Most"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightSingularityDataBasis", "[", 
          RowBox[{"f", ",", "k", ",", 
           RowBox[{"RightContourArg", "[", "g", "]"}]}], "]"}], "//", 
         "First"}], "}"}]}], "]"}], ",", 
     RowBox[{"Domain", "[", "g", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"_", "?", "SignQ"}], ",", 
       RowBox[{"f_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"!", 
            RowBox[{"RightEndpointInfinityQ", "[", "#", "]"}]}], "&&", 
           RowBox[{"!", 
            RowBox[{"LeftEndpointInfinityQ", "[", "#", "]"}]}]}], "&"}], 
         ")"}]}], ",", "k_Integer", ",", "g_IFun"}], "]"}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
       RowBox[{"RightEndpoint", "[", "g", "]"}]}], "&&", 
      RowBox[{
       RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
       RowBox[{"LeftEndpoint", "[", "g", "]"}]}]}]}], ":=", 
    RowBox[{"IFun", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RightSingularityDataBasis", "[", 
           RowBox[{"f", ",", "k", ",", 
            RowBox[{"LeftContourArg", "[", "g", "]"}]}], "]"}], "//", 
          "First"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"f", ",", "k", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"g", "//", "Points"}], "//", "Rest"}], "//", "Most"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LeftSingularityDataBasis", "[", 
           RowBox[{"f", ",", "k", ",", 
            RowBox[{"RightContourArg", "[", "g", "]"}]}], "]"}], "//", 
          "First"}], "}"}]}], "]"}], ",", 
      RowBox[{"Domain", "[", "g", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", "DomainQ"}], ",", "k_Integer", ",", 
      RowBox[{"g_IFun", "?", "RightEndpointInfinityQ"}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
     RowBox[{"LeftEndpoint", "[", "g", "]"}]}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightSingularityDataBasis", "[", 
          RowBox[{"f", ",", "k", ",", 
           RowBox[{"LeftContourArg", "[", "g", "]"}]}], "]"}], "//", 
         "First"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"CauchyBasis", "[", 
        RowBox[{"f", ",", "k", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"g", "//", "Points"}], "//", "Rest"}], "//", "Most"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "0", "}"}]}], "]"}], ",", 
     RowBox[{"Domain", "[", "g", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", "DomainQ"}], ",", "k_Integer", ",", 
      RowBox[{"g_IFun", "?", "LeftEndpointInfinityQ"}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
     RowBox[{"RightEndpoint", "[", "g", "]"}]}]}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"CauchyBasis", "[", 
        RowBox[{"f", ",", "k", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"g", "//", "Points"}], "//", "Most"}], "//", "Rest"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LeftSingularityDataBasis", "[", 
          RowBox[{"f", ",", "k", ",", 
           RowBox[{"RightContourArg", "[", "g", "]"}]}], "]"}], "//", 
         "First"}], "}"}]}], "]"}], ",", 
     RowBox[{"Domain", "[", "g", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", "DomainQ"}], ",", "k_Integer", ",", 
      RowBox[{"g_IFun", "?", "LeftEndpointInfinityQ"}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
     RowBox[{"RightEndpoint", "[", "g", "]"}]}]}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"CauchyBasis", "[", 
        RowBox[{"f", ",", "k", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"g", "//", "Points"}], "//", "Most"}], "//", "Rest"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightSingularityDataBasis", "[", 
          RowBox[{"f", ",", "k", ",", 
           RowBox[{"RightContourArg", "[", "g", "]"}]}], "]"}], "//", 
         "First"}], "}"}]}], "]"}], ",", 
     RowBox[{"Domain", "[", "g", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"_", "?", "SignQ"}], ",", 
       RowBox[{"f_", "?", "DomainQ"}], ",", "k_Integer", ",", 
       RowBox[{"g_IFun", "?", "RightEndpointInfinityQ"}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
      RowBox[{"LeftEndpoint", "[", "g", "]"}]}]}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"IFun", "[", 
     RowBox[{
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LeftSingularityDataBasis", "[", 
           RowBox[{"f", ",", "k", ",", 
            RowBox[{"LeftContourArg", "[", "g", "]"}]}], "]"}], "//", 
          "First"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"f", ",", "k", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"g", "//", "Points"}], "//", "Rest"}], "//", "Most"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "0", "}"}]}], "]"}], ",", 
      RowBox[{"Domain", "[", "g", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"RightEndpointInfinityQ", "[", "#", "]"}]}], "&"}], ")"}]}],
       ",", "k_Integer", ",", "g_IFun"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
     RowBox[{"LeftEndpoint", "[", "g", "]"}]}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightSingularityDataBasis", "[", 
          RowBox[{"f", ",", "k", ",", 
           RowBox[{"LeftContourArg", "[", "g", "]"}]}], "]"}], "//", 
         "First"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"CauchyBasis", "[", 
        RowBox[{"f", ",", "k", ",", 
         RowBox[{
          RowBox[{"g", "//", "Points"}], "//", "Rest"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"Domain", "[", "g", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"LeftEndpointInfinityQ", "[", "#", "]"}]}], "&"}], ")"}]}], 
      ",", "k_Integer", ",", "g_IFun"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
     RowBox[{"RightEndpoint", "[", "g", "]"}]}]}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"f", ",", "k", ",", 
          RowBox[{
           RowBox[{"g", "//", "Points"}], "//", "Most"}]}], "]"}], ")"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LeftSingularityDataBasis", "[", 
          RowBox[{"f", ",", "k", ",", 
           RowBox[{"RightContourArg", "[", "g", "]"}]}], "]"}], "//", 
         "First"}], "}"}]}], "]"}], ",", 
     RowBox[{"Domain", "[", "g", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"RightEndpointInfinityQ", "[", "#", "]"}]}], "&"}], ")"}]}],
       ",", "k_Integer", ",", "g_IFun"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
     RowBox[{"RightEndpoint", "[", "g", "]"}]}]}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"f", ",", "k", ",", 
          RowBox[{
           RowBox[{"g", "//", "Points"}], "//", "Most"}]}], "]"}], ")"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightSingularityDataBasis", "[", 
          RowBox[{"f", ",", "k", ",", 
           RowBox[{"RightContourArg", "[", "g", "]"}]}], "]"}], "//", 
         "First"}], "}"}]}], "]"}], ",", 
     RowBox[{"Domain", "[", "g", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"LeftEndpointInfinityQ", "[", "#", "]"}]}], "&"}], ")"}]}], 
      ",", "k_Integer", ",", "g_IFun"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
     RowBox[{"LeftEndpoint", "[", "g", "]"}]}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LeftSingularityDataBasis", "[", 
          RowBox[{"f", ",", "k", ",", 
           RowBox[{"LeftContourArg", "[", "g", "]"}]}], "]"}], "//", 
         "First"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"f", ",", "k", ",", 
          RowBox[{
           RowBox[{"g", "//", "Points"}], "//", "Rest"}]}], "]"}], ")"}]}], 
      "]"}], ",", 
     RowBox[{"Domain", "[", "g", "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Disjoint", "Subsection"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", "DomainQ"}], ",", "k_Integer", ",", "g_IFun"}], 
     "]"}], ":=", 
    RowBox[{"ZeroAtInfinityIFun", "[", 
     RowBox[{
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"f", ",", "k", ",", 
        RowBox[{"g", "//", "FinitePoints"}]}], "]"}], ",", 
      RowBox[{"Domain", "[", "g", "]"}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Cauchy Range", "Section",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Cauchy Basis", "Subsection",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]pL", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i_", "?", "Negative"}], ";;", 
        RowBox[{"j_", "?", "Negative"}]}], ",", "x_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cur", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"cur", "=", 
           RowBox[{"\[Psi]p", "[", 
            RowBox[{"i", ",", "x"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"EvenQ", "[", "k", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"cur", " ", "=", " ", 
              RowBox[{"cur", " ", "x"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"cur", " ", "=", " ", 
              RowBox[{
               RowBox[{"cur", " ", "x"}], " ", "-", 
               RowBox[{"1", "/", "k"}]}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"i", "+", "1"}], ",", "j"}], "}"}]}], "]"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]pL", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i_", "?", "Positive"}], ";;", 
        RowBox[{"j_", "?", "Positive"}]}], ",", "x_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cur", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"cur", "=", 
           RowBox[{"\[Psi]p", "[", 
            RowBox[{"i", ",", "x"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"EvenQ", "[", "k", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"cur", " ", "=", " ", 
              RowBox[{"cur", " ", "x"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"cur", " ", "=", " ", 
              RowBox[{
               RowBox[{"cur", " ", "x"}], " ", "-", 
               RowBox[{"1", "/", "k"}]}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"i", "+", "1"}], ",", "j"}], "}"}]}], "]"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]pL", "[", 
      RowBox[{
       RowBox[{"0", ";;", 
        RowBox[{"j_", "?", "Positive"}]}], ",", "x_"}], "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Psi]p", "[", 
         RowBox[{"0", ",", "x"}], "]"}], "}"}], ",", 
       RowBox[{"\[Psi]pL", "[", 
        RowBox[{
         RowBox[{"1", ";;", "j"}], ",", "x"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]pL", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i_", "?", "Negative"}], ";;", "0"}], ",", "x_"}], "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"\[Psi]pL", "[", 
        RowBox[{
         RowBox[{"i", ";;", 
          RowBox[{"-", "1"}]}], ",", "x"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Psi]p", "[", 
         RowBox[{"0", ",", "x"}], "]"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]pL", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i_", "?", "Negative"}], ";;", 
        RowBox[{"j_", "?", "Positive"}]}], ",", "x_"}], "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"\[Psi]pL", "[", 
        RowBox[{
         RowBox[{"i", ";;", 
          RowBox[{"-", "1"}]}], ",", "x"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Psi]p", "[", 
         RowBox[{"0", ",", "x"}], "]"}], "}"}], ",", 
       RowBox[{"\[Psi]pL", "[", 
        RowBox[{
         RowBox[{";;", "j"}], ",", "x"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"UnitInterval", ",", 
       RowBox[{"i_", ";;", "k_"}], ",", "x_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Psi]pL", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "1"}], ";;", 
           RowBox[{"k", "-", "1"}]}], ",", 
          RowBox[{"IntervalToInnerCircle", "[", "x", "]"}]}], "]"}], "+", 
        RowBox[{"Reverse", "[", 
         RowBox[{"\[Psi]pL", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "k"}], "+", "1"}], ";;", 
            RowBox[{"1", "-", "i"}]}], ",", 
           RowBox[{"IntervalToInnerCircle", "[", "x", "]"}]}], "]"}], "]"}]}],
        ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasisS", "[", 
      RowBox[{
       RowBox[{"+", "1"}], ",", "UnitInterval", ",", 
       RowBox[{"i_", ";;", "k_"}], ",", "x_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Psi]pL", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "1"}], ";;", 
           RowBox[{"k", "-", "1"}]}], ",", 
          RowBox[{"IntervalToBottomCircle", "[", "x", "]"}]}], "]"}], "+", 
        RowBox[{"Reverse", "[", 
         RowBox[{"\[Psi]pL", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "k"}], "+", "1"}], ";;", 
            RowBox[{"1", "-", "i"}]}], ",", 
           RowBox[{"IntervalToBottomCircle", "[", "x", "]"}]}], "]"}], 
         "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasisS", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "UnitInterval", ",", 
       RowBox[{"i_", ";;", "k_"}], ",", "x_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Psi]pL", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "1"}], ";;", 
           RowBox[{"k", "-", "1"}]}], ",", 
          RowBox[{"IntervalToTopCircle", "[", "x", "]"}]}], "]"}], "+", 
        RowBox[{"Reverse", "[", 
         RowBox[{"\[Psi]pL", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "k"}], "+", "1"}], ";;", 
            RowBox[{"1", "-", "i"}]}], ",", 
           RowBox[{"IntervalToTopCircle", "[", "x", "]"}]}], "]"}], "]"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{
       RowBox[{"f", ":", 
        RowBox[{"Curve", "[", "_IFun", "]"}]}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_List"}], "]"}], ":=", 
     RowBox[{"MatrixMap", "[", 
      RowBox[{"Total", ",", 
       RowBox[{"CauchyBasis", "[", 
        RowBox[{"UnitInterval", ",", 
         RowBox[{"1", ";;", "k"}], ",", 
         RowBox[{"ComplexMapToInterval", "[", 
          RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"s_", ",", 
       RowBox[{"f", ":", 
        RowBox[{"Curve", "[", "_IFun", "]"}]}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_List"}], "]"}], ":=", 
     RowBox[{"MatrixMap", "[", 
      RowBox[{"Total", ",", 
       RowBox[{"CauchyBasis", "[", 
        RowBox[{"s", ",", "UnitInterval", ",", 
         RowBox[{"1", ";;", "k"}], ",", 
         RowBox[{"ComplexMapToInterval", "[", 
          RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{
       RowBox[{"f", ":", 
        RowBox[{"Curve", "[", "_IFun", "]"}]}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{"Total", "/@", 
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"UnitInterval", ",", 
        RowBox[{"1", ";;", "k"}], ",", 
        RowBox[{"ComplexMapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"s_", ",", 
       RowBox[{"f", ":", 
        RowBox[{"Curve", "[", "_IFun", "]"}]}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{"Total", "/@", 
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"s", ",", "UnitInterval", ",", 
        RowBox[{"1", ";;", "k"}], ",", 
        RowBox[{"ComplexMapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{
       RowBox[{"cr", ":", 
        RowBox[{"Curve", "[", 
         RowBox[{"cf_IFun", ",", 
          RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}]}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_List"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"MatrixMap", "[", 
       RowBox[{"Total", ",", 
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"UnitInterval", ",", 
          RowBox[{"1", ";;", "k"}], ",", 
          RowBox[{"ComplexMapToInterval", "[", 
           RowBox[{"cr", ",", "z"}], "]"}]}], "]"}]}], "]"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"cf", "//", "Length"}], ")"}], "-", "1"}], ")"}], 
       RowBox[{"CauchyBasis", "[", 
        RowBox[{"UnitInterval", ",", 
         RowBox[{";;", "k"}], ",", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", 
           "\[Infinity]"}], "]"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"s_", ",", 
       RowBox[{"cr", ":", 
        RowBox[{"Curve", "[", 
         RowBox[{"cf_IFun", ",", 
          RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}]}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_List"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"MatrixMap", "[", 
       RowBox[{"Total", ",", 
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"s", ",", "UnitInterval", ",", 
          RowBox[{"1", ";;", "k"}], ",", 
          RowBox[{"ComplexMapToInterval", "[", 
           RowBox[{"cr", ",", "z"}], "]"}]}], "]"}]}], "]"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"cf", "//", "Length"}], ")"}], "-", "1"}], ")"}], 
       RowBox[{"CauchyBasis", "[", 
        RowBox[{"UnitInterval", ",", 
         RowBox[{";;", "k"}], ",", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", 
           "\[Infinity]"}], "]"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{
       RowBox[{"cr", ":", 
        RowBox[{"Curve", "[", 
         RowBox[{"cf_IFun", ",", 
          RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}]}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Total", "/@", 
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"UnitInterval", ",", 
          RowBox[{"1", ";;", "k"}], ",", 
          RowBox[{"ComplexMapToInterval", "[", 
           RowBox[{"cr", ",", "z"}], "]"}]}], "]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"cf", "//", "Length"}], ")"}], "-", "1"}], ")"}], 
       RowBox[{"CauchyBasis", "[", 
        RowBox[{"UnitInterval", ",", 
         RowBox[{";;", "k"}], ",", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", 
           "\[Infinity]"}], "]"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"s_", ",", 
       RowBox[{"cr", ":", 
        RowBox[{"Curve", "[", 
         RowBox[{"cf_IFun", ",", 
          RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}]}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Total", "/@", 
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"s", ",", "UnitInterval", ",", 
          RowBox[{"1", ";;", "k"}], ",", 
          RowBox[{"ComplexMapToInterval", "[", 
           RowBox[{"cr", ",", "z"}], "]"}]}], "]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"cf", "//", "Length"}], ")"}], "-", "1"}], ")"}], 
       RowBox[{"CauchyBasis", "[", 
        RowBox[{"UnitInterval", ",", 
         RowBox[{";;", "k"}], ",", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", 
           "\[Infinity]"}], "]"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{
       RowBox[{"f_", "?", "RightEndpointInfinityQ"}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"UnitInterval", ",", 
        RowBox[{"1", ";;", "k"}], ",", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "//", 
      RowBox[{"Function", "[", 
       RowBox[{"mat", ",", 
        RowBox[{"mat", "-", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "mat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "+", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"I", " ", "\[Pi]"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Mu]", "[", 
                 RowBox[{
                  RowBox[{"#", "-", "1"}], ",", "1."}], "]"}], "+", 
                RowBox[{"\[Mu]", "[", 
                 RowBox[{
                  RowBox[{"#", "-", "2"}], ",", "1."}], "]"}]}], ")"}]}]}], 
            "&"}], ",", "k"}], "]"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{
       RowBox[{"f_", "?", "LeftEndpointInfinityQ"}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"UnitInterval", ",", 
        RowBox[{"1", ";;", "k"}], ",", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "//", 
      RowBox[{"Function", "[", 
       RowBox[{"mat", ",", 
        RowBox[{"mat", "+", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "^", 
              RowBox[{"(", "#", ")"}]}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "mat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
                FractionBox["1", 
                 RowBox[{"I", " ", "\[Pi]"}]], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Mu]", "[", 
                   RowBox[{
                    RowBox[{"#", "-", "1"}], ",", 
                    RowBox[{"-", "1."}]}], "]"}], "+", 
                  RowBox[{"\[Mu]", "[", 
                   RowBox[{
                    RowBox[{"#", "-", "2"}], ",", 
                    RowBox[{"-", "1."}]}], "]"}]}], ")"}]}]}], ")"}]}], "&"}],
            ",", "k"}], "]"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasisS", "[", 
      RowBox[{"s_", ",", 
       RowBox[{"f_", "?", "RightEndpointInfinityQ"}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"CauchyBasisS", "[", 
       RowBox[{"s", ",", "UnitInterval", ",", 
        RowBox[{"1", ";;", "k"}], ",", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "//", 
      RowBox[{"Function", "[", 
       RowBox[{"mat", ",", 
        RowBox[{"mat", "-", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "mat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "+", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"I", " ", "\[Pi]"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Mu]", "[", 
                 RowBox[{
                  RowBox[{"#", "-", "1"}], ",", "1."}], "]"}], "+", 
                RowBox[{"\[Mu]", "[", 
                 RowBox[{
                  RowBox[{"#", "-", "2"}], ",", "1."}], "]"}]}], ")"}]}]}], 
            "&"}], ",", "k"}], "]"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasisS", "[", 
      RowBox[{"s_", ",", 
       RowBox[{"f_", "?", "LeftEndpointInfinityQ"}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"CauchyBasisS", "[", 
       RowBox[{"s", ",", "UnitInterval", ",", 
        RowBox[{"1", ";;", "k"}], ",", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "//", 
      RowBox[{"Function", "[", 
       RowBox[{"mat", ",", 
        RowBox[{"mat", "+", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "^", 
              RowBox[{"(", "#", ")"}]}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "mat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
                FractionBox["1", 
                 RowBox[{"I", " ", "\[Pi]"}]], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Mu]", "[", 
                   RowBox[{
                    RowBox[{"#", "-", "1"}], ",", 
                    RowBox[{"-", "1."}]}], "]"}], "+", 
                  RowBox[{"\[Mu]", "[", 
                   RowBox[{
                    RowBox[{"#", "-", "2"}], ",", 
                    RowBox[{"-", "1."}]}], "]"}]}], ")"}]}]}], ")"}]}], "&"}],
            ",", "k"}], "]"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasisS", "[", 
      RowBox[{"s_", ",", 
       RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"CauchyBasisS", "[", 
       RowBox[{"s", ",", "UnitInterval", ",", 
        RowBox[{"1", ";;", "k"}], ",", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"UnitInterval", ",", 
        RowBox[{"1", ";;", "k"}], ",", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "\[Infinity]"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"s_", ",", 
       RowBox[{"d_", "?", "DomainQ"}], ",", "k_", ",", 
       RowBox[{"x_", "?", "MatrixQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"s", ",", "d", ",", "k", ",", "#"}], "]"}], "&"}], "/@", 
       "x"}], "//", "Transpose"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"s_", ",", 
       RowBox[{"d_", "?", "DomainQ"}], ",", "k_", ",", "x_List"}], "]"}], ":=",
      "\[IndentingNewLine]", 
     RowBox[{"RightJoin", "@@", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"DomainMemberQ", "[", 
            RowBox[{"d", ",", 
             RowBox[{"#", "//", "First"}]}], "]"}], ",", 
           RowBox[{"CauchyBasisS", "[", 
            RowBox[{"s", ",", "d", ",", "k", ",", "#"}], "]"}], ",", 
           RowBox[{"CauchyBasis", "[", 
            RowBox[{"d", ",", "k", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
        RowBox[{"SplitBy", "[", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"DomainMemberQ", "[", 
            RowBox[{"d", ",", "#"}], "]"}], "&"}]}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"s_", ",", 
        RowBox[{"d_", "?", "DomainQ"}], ",", "k_", ",", "x_"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"DomainMemberQ", "[", 
        RowBox[{"d", ",", "x"}], "]"}], ")"}]}], ":=", 
     RowBox[{"CauchyBasisS", "[", 
      RowBox[{"s", ",", "d", ",", "k", ",", "x"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"_", ",", 
       RowBox[{"d_", "?", "IntervalDomainQ"}], ",", "k_", ",", "x_"}], "]"}], 
     ":=", 
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"UnitInterval", ",", "k", ",", "x"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{
       RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"UnitInterval", ",", 
        RowBox[{";;", "k"}], ",", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"UnitInterval", ",", 
        RowBox[{";;", "k"}], ",", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "\[Infinity]"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyBasisS", "[", 
      RowBox[{"s_", ",", 
       RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
       RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"CauchyBasisS", "[", 
       RowBox[{"s", ",", "UnitInterval", ",", 
        RowBox[{";;", "k"}], ",", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "-", 
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"UnitInterval", ",", 
        RowBox[{";;", "k"}], ",", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "\[Infinity]"}], "]"}]}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Singularity Data", "Subsection",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LeftSingularityDataBasis", "[", 
     RowBox[{
      RowBox[{"f", ":", 
       RowBox[{"Curve", "[", "_IFun", "]"}]}], ",", 
      RowBox[{"1", ";;", "n_Integer"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pts", ",", "cb", ",", "lpD"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pts", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"ComplexMapToInterval", "[", 
           RowBox[{"f", ",", 
            RowBox[{"f", "//", "LeftEndpoint"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#", "+", "1"}], "]"}], "<", 
              RowBox[{"100", " ", "$MachineTolerance"}]}], ")"}]}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lpD", "=", 
        RowBox[{"MapToIntervalD", "[", 
         RowBox[{"f", ",", 
          RowBox[{"f", "//", "LeftEndpoint"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cb", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Total", ",", 
          RowBox[{"CauchyBasis", "[", 
           RowBox[{"UnitInterval", ",", 
            RowBox[{";;", "n"}], ",", "pts"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               " ", 
               RowBox[{"Log", "[", 
                RowBox[{"Abs", "[", "lpD", "]"}], "]"}]}]}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", 
                RowBox[{"Arg", "[", "lpD", "]"}]}], "]"}]}]}], "}"}], "&"}], "/@", 
          RowBox[{"LeftSingularityDataBasis", "[", 
           RowBox[{"UnitInterval", ",", 
            RowBox[{";;", "n"}]}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", "0", ",", "0"}], "}"}], "&"}], "/@", "cb"}], 
         ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightSingularityDataBasis", "[", 
     RowBox[{
      RowBox[{"f", ":", 
       RowBox[{"Curve", "[", "_IFun", "]"}]}], ",", 
      RowBox[{"1", ";;", "n_Integer"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pts", ",", "cb", ",", "lpD"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pts", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"ComplexMapToInterval", "[", 
           RowBox[{"f", ",", 
            RowBox[{"f", "//", "RightEndpoint"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#", "-", "1"}], "]"}], "<", 
              RowBox[{"100", " ", "$MachineTolerance"}]}], ")"}]}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lpD", "=", 
        RowBox[{"MapToIntervalD", "[", 
         RowBox[{"f", ",", 
          RowBox[{"f", "//", "RightEndpoint"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cb", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Total", ",", 
          RowBox[{"CauchyBasis", "[", 
           RowBox[{"UnitInterval", ",", 
            RowBox[{";;", "n"}], ",", "pts"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               " ", 
               RowBox[{"Log", "[", 
                RowBox[{"Abs", "[", "lpD", "]"}], "]"}]}]}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", 
                RowBox[{"Arg", "[", "lpD", "]"}]}], "]"}]}]}], "}"}], "&"}], "/@", 
          RowBox[{"RightSingularityDataBasis", "[", 
           RowBox[{"UnitInterval", ",", 
            RowBox[{";;", "n"}]}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", "0", ",", "0"}], "}"}], "&"}], "/@", "cb"}], 
         ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LeftSingularityDataBasis", "[", 
     RowBox[{
      RowBox[{"f", ":", 
       RowBox[{"Curve", "[", 
        RowBox[{"cf_IFun", ",", 
         RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}]}], ",", 
      RowBox[{"1", ";;", "n_Integer"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pts", ",", "cb", ",", "lpD", ",", "cbinf"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pts", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"ComplexMapToInterval", "[", 
           RowBox[{"f", ",", 
            RowBox[{"f", "//", "LeftEndpoint"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#", "+", "1"}], "]"}], "<", 
              RowBox[{"100", " ", "$MachineTolerance"}]}], ")"}]}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lpD", "=", 
        RowBox[{"MapToIntervalD", "[", 
         RowBox[{"f", ",", 
          RowBox[{"f", "//", "LeftEndpoint"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cb", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Total", ",", 
          RowBox[{"CauchyBasis", "[", 
           RowBox[{"UnitInterval", ",", 
            RowBox[{";;", "n"}], ",", "pts"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cbinf", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"cf", "//", "Length"}], ")"}], "-", "1"}], ")"}], 
         RowBox[{"CauchyBasis", "[", 
          RowBox[{"UnitInterval", ",", 
           RowBox[{";;", "n"}], ",", 
           RowBox[{"MapToInterval", "[", 
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
               RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", 
             "\[Infinity]"}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               " ", 
               RowBox[{"Log", "[", 
                RowBox[{"Abs", "[", "lpD", "]"}], "]"}]}]}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", 
                RowBox[{"Arg", "[", "lpD", "]"}]}], "]"}]}]}], "}"}], "&"}], "/@", 
          RowBox[{"LeftSingularityDataBasis", "[", 
           RowBox[{"UnitInterval", ",", 
            RowBox[{";;", "n"}]}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", "0", ",", "0"}], "}"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"cb", "-", "cbinf"}], ")"}]}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightSingularityDataBasis", "[", 
     RowBox[{
      RowBox[{"f", ":", 
       RowBox[{"Curve", "[", 
        RowBox[{"cf_IFun", ",", 
         RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}]}], ",", 
      RowBox[{"1", ";;", "n_Integer"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pts", ",", "cb", ",", "lpD", ",", "cbinf"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pts", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"ComplexMapToInterval", "[", 
           RowBox[{"f", ",", 
            RowBox[{"f", "//", "LeftEndpoint"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#", "-", "1"}], "]"}], "<", 
              RowBox[{"100", " ", "$MachineTolerance"}]}], ")"}]}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lpD", "=", 
        RowBox[{"MapToIntervalD", "[", 
         RowBox[{"f", ",", 
          RowBox[{"f", "//", "RightEndpoint"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cb", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Total", ",", 
          RowBox[{"CauchyBasis", "[", 
           RowBox[{"UnitInterval", ",", 
            RowBox[{";;", "n"}], ",", "pts"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cbinf", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"cf", "//", "Length"}], ")"}], "-", "1"}], ")"}], 
         RowBox[{"CauchyBasis", "[", 
          RowBox[{"UnitInterval", ",", 
           RowBox[{";;", "n"}], ",", 
           RowBox[{"MapToInterval", "[", 
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
               RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", 
             "\[Infinity]"}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               " ", 
               RowBox[{"Log", "[", 
                RowBox[{"Abs", "[", "lpD", "]"}], "]"}]}]}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", 
                RowBox[{"Arg", "[", "lpD", "]"}]}], "]"}]}]}], "}"}], "&"}], "/@", 
          RowBox[{"RightSingularityDataBasis", "[", 
           RowBox[{"UnitInterval", ",", 
            RowBox[{";;", "n"}]}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", "0", ",", "0"}], "}"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"cb", "-", "cbinf"}], ")"}]}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftSingularityDataBasis", "[", 
    RowBox[{
     RowBox[{"d_", "?", "IntervalDomainQ"}], ",", 
     RowBox[{"1", ";;", "k_Integer"}]}], "]"}], ":=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"LeftSingularityDataBasis", "[", 
       RowBox[{"d", ",", "#"}], "]"}], "&"}], ",", "k"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightSingularityDataBasis", "[", 
     RowBox[{
      RowBox[{"d_", "?", "IntervalDomainQ"}], ",", 
      RowBox[{"1", ";;", "k_Integer"}]}], "]"}], ":=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"RightSingularityDataBasis", "[", 
        RowBox[{"d", ",", "#"}], "]"}], "&"}], ",", "k"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftSingularityDataBasis", "[", 
    RowBox[{
     RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
     RowBox[{"1", ";;", "k_Integer"}], ",", 
     RowBox[{"t_", "?", "ScalarQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "+", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         " ", "I", " ", 
         RowBox[{"Arg", "[", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", "t"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "}"}], "&"}], "/@", 
    RowBox[{"LeftSingularityDataBasis", "[", 
     RowBox[{"f", ",", 
      RowBox[{";;", "k"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LeftSingularityDataBasis", "[", 
     RowBox[{
      RowBox[{"s_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
      RowBox[{"1", ";;", "k_"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "-", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           " ", "I", " ", "s", " ", "\[Pi]"}]}], ",", 
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
        "}"}], "&"}], "/@", 
     RowBox[{"LeftSingularityDataBasis", "[", 
      RowBox[{"f", ",", 
       RowBox[{";;", "k"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightSingularityDataBasis", "[", 
    RowBox[{
     RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
     RowBox[{"1", ";;", "k_Integer"}], ",", 
     RowBox[{"t_", "?", "ScalarQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "+", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         " ", "I", " ", 
         RowBox[{"Arg", "[", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", "t"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "}"}], "&"}], "/@", 
    RowBox[{"RightSingularityDataBasis", "[", 
     RowBox[{"f", ",", 
      RowBox[{";;", "k"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightSingularityDataBasis", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", "f_", ",", 
     RowBox[{"1", ";;", "k_"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "+", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         " ", "I", " ", "s", " ", "\[Pi]"}]}], ",", 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "}"}], "&"}], "/@", 
    RowBox[{"RightSingularityDataBasis", "[", 
     RowBox[{"f", ",", 
      RowBox[{";;", "k"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["FP Cauchy Basis", "Subsection",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Basis equals", "Subsubsection",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"+", "1"}], ",", "UnitInterval", ",", 
      RowBox[{"1", ";;", "n_Integer"}], ",", 
      RowBox[{"g_IFun", "?", "UnitIntervalFunQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mat", ",", "dctmat", ",", "j", ",", "k"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mat", "=", 
        RowBox[{"ToeplitzMatrix", "[", 
         RowBox[{
          RowBox[{"ZeroVector", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"4", " ", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"1", "/", "j"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"n", "-", "1"}], ",", "2"}], "}"}]}], "]"}], ",", 
              "0"}], "]"}]}], "//", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"OddQ", "[", "n", "]"}], ",", 
                 RowBox[{"Join", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", "0", "}"}]}], "]"}], ",", "#"}], "]"}]}], 
              "]"}], "&"}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dctmat", "=", 
        RowBox[{"ColumnMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"InverseDCT", "[", 
            RowBox[{"PadRight", "[", 
             RowBox[{
              RowBox[{"HalfFirst", "[", "#", "]"}], ",", 
              RowBox[{"g", "//", "Length"}]}], "]"}], "]"}], "&"}], ",", 
          "mat"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"IFun", "[", 
          RowBox[{"#", ",", "UnitInterval"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"LeftSingularityDataBasis", "[", 
                 RowBox[{
                  RowBox[{"+", "1"}], ",", "UnitInterval", ",", "k"}], "]"}], 
                "//", "First"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "n"}], "}"}]}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], "/", 
               RowBox[{"(", 
                RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
              RowBox[{"ArcTanh", "[", 
               RowBox[{"IntervalToBottomCircle", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"g", "//", "Points"}], "//", "Rest"}], "//", 
                 "Most"}], "]"}], "]"}], " ", 
              RowBox[{"ColumnMap", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "//", "InverseDCT"}], "//", "Rest"}], "//", 
                   "Most"}], ")"}], "&"}], ",", 
                RowBox[{"IdentityMatrix", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Length", "[", "g", "]"}], ",", "n"}], "}"}], 
                 "]"}]}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"ColumnMap", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#", "//", "Rest"}], "//", "Most"}], ")"}], "&"}], 
                ",", "dctmat"}], "]"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", "I", " ", "\[Pi]"}], ")"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"RightSingularityDataBasis", "[", 
                 RowBox[{
                  RowBox[{"+", "1"}], ",", "UnitInterval", ",", "k"}], "]"}], 
                "//", "First"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "n"}], "}"}]}], "]"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], "//", "Transpose"}], ")"}]}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "UnitInterval", ",", 
      RowBox[{"1", ";;", "n_Integer"}], ",", 
      RowBox[{"g_IFun", "?", "UnitIntervalFunQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mat", ",", "dctmat", ",", "j", ",", "k"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mat", "=", 
        RowBox[{"ToeplitzMatrix", "[", 
         RowBox[{
          RowBox[{"ZeroVector", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"4", " ", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"1", "/", "j"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"n", "-", "1"}], ",", "2"}], "}"}]}], "]"}], ",", 
              "0"}], "]"}]}], "//", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"OddQ", "[", "n", "]"}], ",", 
                 RowBox[{"Join", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", "0", "}"}]}], "]"}], ",", "#"}], "]"}]}], 
              "]"}], "&"}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dctmat", "=", 
        RowBox[{"ColumnMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"InverseDCT", "[", 
            RowBox[{"PadRight", "[", 
             RowBox[{
              RowBox[{"HalfFirst", "[", "#", "]"}], ",", 
              RowBox[{"g", "//", "Length"}]}], "]"}], "]"}], "&"}], ",", 
          "mat"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"IFun", "[", 
          RowBox[{"#", ",", "UnitInterval"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"LeftSingularityDataBasis", "[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "UnitInterval", ",", "k"}], "]"}], 
                "//", "First"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "n"}], "}"}]}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], "/", 
               RowBox[{"(", 
                RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
              RowBox[{"ArcTanh", "[", 
               RowBox[{"IntervalToTopCircle", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"g", "//", "Points"}], "//", "Rest"}], "//", 
                 "Most"}], "]"}], "]"}], " ", 
              RowBox[{"ColumnMap", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "//", "InverseDCT"}], "//", "Rest"}], "//", 
                   "Most"}], ")"}], "&"}], ",", 
                RowBox[{"IdentityMatrix", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Length", "[", "g", "]"}], ",", "n"}], "}"}], 
                 "]"}]}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"ColumnMap", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#", "//", "Rest"}], "//", "Most"}], ")"}], "&"}], 
                ",", "dctmat"}], "]"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", "I", " ", "\[Pi]"}], ")"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"RightSingularityDataBasis", "[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "UnitInterval", ",", "k"}], "]"}], 
                "//", "First"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "n"}], "}"}]}], "]"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], "//", "Transpose"}], ")"}]}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"s_", "?", "SignQ"}], ",", 
       RowBox[{"f", ":", 
        RowBox[{"Curve", "[", "_IFun", "]"}]}], ",", 
       RowBox[{"1", ";;", "k_Integer"}], ",", "g_IFun"}], "]"}], "/;", 
     RowBox[{"f", "~", "NEqual", "~", 
      RowBox[{"Domain", "[", "g", "]"}]}]}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lD", ",", "rD", ",", "pts", ",", "vals", ",", "\[Psi]B"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lD", ",", "rD"}], "}"}], "=", 
        RowBox[{"MapToIntervalD", "[", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f", "//", "LeftEndpoint"}], ",", 
            RowBox[{"f", "//", "RightEndpoint"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"pt", ",", 
           RowBox[{"Select", "[", 
            RowBox[{"pt", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"DomainMemberQ", "[", 
                 RowBox[{"UnitInterval", ",", "#"}], "]"}]}], ")"}], "&"}]}], 
            "]"}]}], "]"}], "/@", 
         RowBox[{"ComplexMapToInterval", "[", 
          RowBox[{"f", ",", 
           RowBox[{"Points", "[", "g", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"IFun", "[", 
          RowBox[{"#", ",", 
           RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Values", "/@", 
            RowBox[{"FPCauchyBasis", "[", 
             RowBox[{"s", ",", "UnitInterval", ",", 
              RowBox[{";;", "k"}], ",", 
              RowBox[{"g", "//", "ToUnitInterval"}]}], "]"}]}], ")"}], "+", 
          RowBox[{"MatrixMap", "[", 
           RowBox[{"Total", ",", 
            RowBox[{"CauchyBasis", "[", 
             RowBox[{"UnitInterval", ",", 
              RowBox[{";;", "k"}], ",", "pts"}], "]"}]}], "]"}], " ", "+", 
          "\[IndentingNewLine]", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"RightSingularityDataBasis", "[", 
                 RowBox[{"UnitInterval", ",", "#"}], "]"}], 
                "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               RowBox[{"Log", "[", 
                RowBox[{"Abs", "[", "rD", "]"}], "]"}], " ", 
               RowBox[{
                RowBox[{"BasisVector", "[", 
                 RowBox[{"Length", "[", "g", "]"}], "]"}], "[", 
                RowBox[{"-", "1"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{
                RowBox[{"LeftSingularityDataBasis", "[", 
                 RowBox[{"UnitInterval", ",", "#"}], "]"}], 
                "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               RowBox[{"Log", "[", 
                RowBox[{"Abs", "[", "lD", "]"}], "]"}], " ", 
               RowBox[{
                RowBox[{"BasisVector", "[", 
                 RowBox[{"Length", "[", "g", "]"}], "]"}], "[", "1", 
                "]"}]}]}], "&"}], ",", "k"}], "]"}]}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"s_", "?", "SignQ"}], ",", 
       RowBox[{"f", ":", 
        RowBox[{"Curve", "[", 
         RowBox[{"cf_IFun", ",", 
          RowBox[{"Stretch", "\[Rule]", "L_"}]}], "]"}]}], ",", 
       RowBox[{"1", ";;", "k_Integer"}], ",", "g_IFun"}], "]"}], "/;", 
     RowBox[{"f", "~", "NEqual", "~", 
      RowBox[{"Domain", "[", "g", "]"}]}]}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lD", ",", "rD", ",", "pts", ",", "vals", ",", "\[Psi]B"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lD", ",", "rD"}], "}"}], "=", 
        RowBox[{"MapToIntervalD", "[", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f", "//", "LeftEndpoint"}], ",", 
            RowBox[{"f", "//", "RightEndpoint"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"pt", ",", 
           RowBox[{"Select", "[", 
            RowBox[{"pt", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"DomainMemberQ", "[", 
                 RowBox[{"UnitInterval", ",", "#"}], "]"}]}], ")"}], "&"}]}], 
            "]"}]}], "]"}], "/@", 
         RowBox[{"ComplexMapToInterval", "[", 
          RowBox[{"f", ",", 
           RowBox[{"Points", "[", "g", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"IFun", "[", 
          RowBox[{"#", ",", 
           RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Values", "/@", 
            RowBox[{"FPCauchyBasis", "[", 
             RowBox[{"s", ",", "UnitInterval", ",", 
              RowBox[{";;", "k"}], ",", 
              RowBox[{"g", "//", "ToUnitInterval"}]}], "]"}]}], ")"}], "+", 
          RowBox[{"MatrixMap", "[", 
           RowBox[{"Total", ",", 
            RowBox[{"CauchyBasis", "[", 
             RowBox[{"UnitInterval", ",", 
              RowBox[{";;", "k"}], ",", "pts"}], "]"}]}], "]"}], " ", "+", 
          "\[IndentingNewLine]", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"RightSingularityDataBasis", "[", 
                 RowBox[{"UnitInterval", ",", "#"}], "]"}], 
                "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               RowBox[{"Log", "[", 
                RowBox[{"Abs", "[", "rD", "]"}], "]"}], " ", 
               RowBox[{
                RowBox[{"BasisVector", "[", 
                 RowBox[{"Length", "[", "g", "]"}], "]"}], "[", 
                RowBox[{"-", "1"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{
                RowBox[{"LeftSingularityDataBasis", "[", 
                 RowBox[{"UnitInterval", ",", "#"}], "]"}], 
                "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               RowBox[{"Log", "[", 
                RowBox[{"Abs", "[", "lD", "]"}], "]"}], " ", 
               RowBox[{
                RowBox[{"BasisVector", "[", 
                 RowBox[{"Length", "[", "g", "]"}], "]"}], "[", "1", 
                "]"}]}]}], "&"}], ",", "k"}], "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"cf", "//", "Length"}], ")"}], "-", "1"}], ")"}], 
           RowBox[{"CauchyBasis", "[", 
            RowBox[{"UnitInterval", ",", 
             RowBox[{";;", "k"}], ",", 
             RowBox[{"MapToInterval", "[", 
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                 RowBox[{"Stretch", "\[Rule]", "L"}]}], "]"}], ",", 
               "\[Infinity]"}], "]"}]}], "]"}]}]}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", " ", 
    RowBox[{"TODO", ":", " ", 
     RowBox[{
     "Works", " ", "because", " ", "RightENdpointInfinityQ", " ", "returns", 
      " ", "false", " ", "for", " ", "real", " ", 
      RowBox[{"line", ".", "  ", "This"}], " ", "should", " ", "be", " ", 
      "made", " ", "consistent"}]}]}], " ", "**)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"s_", "?", "SignQ"}], ",", 
       RowBox[{"f_", "?", "RightEndpointInfinityQ"}], ",", 
       RowBox[{"1", ";;", "k_Integer"}], ",", "g_IFun"}], "]"}], "/;", 
     RowBox[{"f", "~", "NEqual", "~", 
      RowBox[{"Domain", "[", "g", "]"}]}]}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"IFun", "[", 
       RowBox[{"#", ",", 
        RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Values", "/@", 
         RowBox[{"FPCauchyBasis", "[", 
          RowBox[{"s", ",", "UnitInterval", ",", 
           RowBox[{"1", ";;", "k"}], ",", 
           RowBox[{"g", "//", "ToUnitInterval"}]}], "]"}]}], ")"}], "//", 
       RowBox[{"Function", "[", 
        RowBox[{"mat", ",", 
         RowBox[{"mat", "-", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "mat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
               FractionBox["1", 
                RowBox[{"I", " ", "\[Pi]"}]], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Mu]", "[", 
                  RowBox[{
                   RowBox[{"#", "-", "1"}], ",", "1."}], "]"}], "+", 
                 RowBox[{"\[Mu]", "[", 
                  RowBox[{
                   RowBox[{"#", "-", "2"}], ",", "1."}], "]"}]}], ")"}]}], 
              "-", 
              RowBox[{
               RowBox[{
                RowBox[{"LeftSingularityDataBasis", "[", 
                 RowBox[{"UnitInterval", ",", "#"}], "]"}], 
                "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
               RowBox[{"Log", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"MapToIntervalD", "[", 
                  RowBox[{"f", ",", 
                   RowBox[{"f", "//", "LeftEndpoint"}]}], "]"}], "]"}], "]"}],
                " ", 
               RowBox[{
                RowBox[{"BasisVector", "[", 
                 RowBox[{"Length", "[", "g", "]"}], "]"}], "[", "1", 
                "]"}]}]}], "&"}], ",", "k"}], "]"}]}]}], "]"}]}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"s_", "?", "SignQ"}], ",", 
       RowBox[{"f_", "?", "LeftEndpointInfinityQ"}], ",", 
       RowBox[{"1", ";;", "k_Integer"}], ",", "g_IFun"}], "]"}], "/;", 
     RowBox[{"f", "~", "NEqual", "~", 
      RowBox[{"Domain", "[", "g", "]"}]}]}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"IFun", "[", 
       RowBox[{"#", ",", 
        RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Values", "/@", 
         RowBox[{"FPCauchyBasis", "[", 
          RowBox[{"s", ",", "UnitInterval", ",", 
           RowBox[{"1", ";;", "k"}], ",", 
           RowBox[{"g", "//", "ToUnitInterval"}]}], "]"}]}], ")"}], "//", 
       RowBox[{"Function", "[", 
        RowBox[{"mat", ",", 
         RowBox[{"mat", "+", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", 
                RowBox[{"(", "#", ")"}]}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "mat", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "+", 
                 RowBox[{
                  FractionBox["1", 
                   RowBox[{"I", " ", "\[Pi]"}]], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Mu]", "[", 
                    RowBox[{
                    RowBox[{"#", "-", "1"}], ",", 
                    RowBox[{"-", "1."}]}], "]"}], "+", 
                    RowBox[{"\[Mu]", "[", 
                    RowBox[{
                    RowBox[{"#", "-", "2"}], ",", 
                    RowBox[{"-", "1."}]}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{
                RowBox[{"RightSingularityDataBasis", "[", 
                 RowBox[{"UnitInterval", ",", "#"}], "]"}], 
                "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
               RowBox[{"Log", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"MapToIntervalD", "[", 
                  RowBox[{"f", ",", 
                   RowBox[{"f", "//", "RightEndpoint"}]}], "]"}], "]"}], 
                "]"}], " ", 
               RowBox[{
                RowBox[{"BasisVector", "[", 
                 RowBox[{"Length", "[", "g", "]"}], "]"}], "[", 
                RowBox[{"-", "1"}], "]"}]}]}], "&"}], ",", "k"}], "]"}]}]}], 
        "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"s_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
      RowBox[{"1", ";;", "k_Integer"}], ",", "g_IFun"}], "]"}], "/;", 
    RowBox[{"f", "~", "NEqual", "~", 
     RowBox[{"Domain", "[", "g", "]"}]}]}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"IFun", "[", 
      RowBox[{"#", ",", 
       RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Values", "/@", 
        RowBox[{"FPCauchyBasis", "[", 
         RowBox[{"s", ",", "UnitInterval", ",", 
          RowBox[{";;", "k"}], ",", 
          RowBox[{"g", "//", "ToUnitInterval"}]}], "]"}]}], ")"}], "-", 
      RowBox[{"CauchyBasis", "[", 
       RowBox[{"UnitInterval", ",", 
        RowBox[{";;", "k"}], ",", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "\[Infinity]"}], "]"}]}], "]"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"RightSingularityDataBasis", "[", 
             RowBox[{"UnitInterval", ",", "#"}], "]"}], 
            "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", 
               RowBox[{"f", "//", "RightEndpoint"}]}], "]"}], "]"}], "]"}], 
           " ", 
           RowBox[{
            RowBox[{"BasisVector", "[", 
             RowBox[{"Length", "[", "g", "]"}], "]"}], "[", 
            RowBox[{"-", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"LeftSingularityDataBasis", "[", 
             RowBox[{"UnitInterval", ",", "#"}], "]"}], 
            "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", 
               RowBox[{"f", "//", "LeftEndpoint"}]}], "]"}], "]"}], "]"}], 
           " ", 
           RowBox[{
            RowBox[{"BasisVector", "[", 
             RowBox[{"Length", "[", "g", "]"}], "]"}], "[", "1", "]"}]}]}], 
         "&"}], ",", "k"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Endpoints equal", "Subsubsection",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"_", "?", "SignQ"}], ",", 
       RowBox[{"f_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"IntervalDomainQ", "[", "#", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"RightEndpointInfinityQ", "[", "#", "]"}]}], "&&", 
           RowBox[{"!", 
            RowBox[{"LeftEndpointInfinityQ", "[", "#", "]"}]}]}], "&"}], 
         ")"}]}], ",", 
       RowBox[{"1", ";;", "k_Integer"}], ",", "g_IFun"}], "]"}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
       RowBox[{"LeftEndpoint", "[", "g", "]"}]}], "&&", 
      RowBox[{
       RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
       RowBox[{"RightEndpoint", "[", "g", "]"}]}]}]}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"IFun", "[", 
       RowBox[{"#", ",", 
        RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"First", "/@", 
          RowBox[{"LeftSingularityDataBasis", "[", 
           RowBox[{"f", ",", 
            RowBox[{";;", "k"}], ",", 
            RowBox[{"LeftContourArg", "[", "g", "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Transpose", "[", 
         RowBox[{"CauchyBasis", "[", 
          RowBox[{"f", ",", 
           RowBox[{";;", "k"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"g", "//", "Points"}], "//", "Most"}], "//", "Rest"}]}], 
          "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"First", "/@", 
          RowBox[{"RightSingularityDataBasis", "[", 
           RowBox[{"f", ",", 
            RowBox[{";;", "k"}], ",", 
            RowBox[{"RightContourArg", "[", "g", "]"}]}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"_", "?", "SignQ"}], ",", 
       RowBox[{"f_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"IntervalDomainQ", "[", "#", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"RightEndpointInfinityQ", "[", "#", "]"}]}], "&&", 
           RowBox[{"!", 
            RowBox[{"LeftEndpointInfinityQ", "[", "#", "]"}]}]}], "&"}], 
         ")"}]}], ",", 
       RowBox[{"1", ";;", "k_Integer"}], ",", "g_IFun"}], "]"}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
       RowBox[{"RightEndpoint", "[", "g", "]"}]}], "&&", 
      RowBox[{
       RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
       RowBox[{"LeftEndpoint", "[", "g", "]"}]}]}]}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"IFun", "[", 
       RowBox[{"#", ",", 
        RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"First", "/@", 
          RowBox[{"RightSingularityDataBasis", "[", 
           RowBox[{"f", ",", 
            RowBox[{";;", "k"}], ",", 
            RowBox[{"LeftContourArg", "[", "g", "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Transpose", "[", 
         RowBox[{"CauchyBasis", "[", 
          RowBox[{"f", ",", 
           RowBox[{";;", "k"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"g", "//", "Points"}], "//", "Most"}], "//", "Rest"}]}], 
          "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"First", "/@", 
          RowBox[{"LeftSingularityDataBasis", "[", 
           RowBox[{"f", ",", 
            RowBox[{";;", "k"}], ",", 
            RowBox[{"RightContourArg", "[", "g", "]"}]}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"_", "?", "SignQ"}], ",", 
       RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
       RowBox[{"1", ";;", "k_Integer"}], ",", 
       RowBox[{"g_IFun", "?", "RightEndpointInfinityQ"}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
      RowBox[{"LeftEndpoint", "[", "g", "]"}]}]}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"IFun", "[", 
       RowBox[{"#", ",", 
        RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"First", "/@", 
          RowBox[{"RightSingularityDataBasis", "[", 
           RowBox[{"f", ",", 
            RowBox[{";;", "k"}], ",", 
            RowBox[{"LeftContourArg", "[", "g", "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Transpose", "[", 
         RowBox[{"CauchyBasis", "[", 
          RowBox[{"f", ",", 
           RowBox[{";;", "k"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"g", "//", "Points"}], "//", "Rest"}], "//", "Most"}]}], 
          "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"ZeroVector", "[", "k", "]"}], "}"}]}], "]"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"_", "?", "SignQ"}], ",", 
       RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
       RowBox[{"1", ";;", "k_Integer"}], ",", 
       RowBox[{"g_IFun", "?", "LeftEndpointInfinityQ"}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
      RowBox[{"RightEndpoint", "[", "g", "]"}]}]}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"IFun", "[", 
       RowBox[{"#", ",", 
        RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ZeroVector", "[", "k", "]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Transpose", "[", 
         RowBox[{"CauchyBasis", "[", 
          RowBox[{"f", ",", 
           RowBox[{";;", "k"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"g", "//", "Points"}], "//", "Rest"}], "//", "Most"}]}], 
          "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"First", "/@", 
          RowBox[{"LeftSingularityDataBasis", "[", 
           RowBox[{"f", ",", 
            RowBox[{";;", "k"}], ",", 
            RowBox[{"RightContourArg", "[", "g", "]"}]}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
      RowBox[{"1", ";;", "k_Integer"}], ",", 
      RowBox[{"g_IFun", "?", "LeftEndpointInfinityQ"}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
     RowBox[{"RightEndpoint", "[", "g", "]"}]}]}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IFun", "[", 
      RowBox[{"#", ",", 
       RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ZeroVector", "[", "k", "]"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Transpose", "[", 
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"f", ",", 
          RowBox[{";;", "k"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"g", "//", "Points"}], "//", "Rest"}], "//", "Most"}]}], 
         "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"First", "/@", 
         RowBox[{"RightSingularityDataBasis", "[", 
          RowBox[{"f", ",", 
           RowBox[{";;", "k"}], ",", 
           RowBox[{"RightContourArg", "[", "g", "]"}]}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"_", "?", "SignQ"}], ",", 
       RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
       RowBox[{"1", ";;", "k_Integer"}], ",", 
       RowBox[{"g_IFun", "?", "RightEndpointInfinityQ"}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
      RowBox[{"LeftEndpoint", "[", "g", "]"}]}]}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"IFun", "[", 
       RowBox[{"#", ",", 
        RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"First", "/@", 
          RowBox[{"LeftSingularityDataBasis", "[", 
           RowBox[{"f", ",", 
            RowBox[{";;", "k"}], ",", 
            RowBox[{"LeftContourArg", "[", "g", "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Transpose", "[", 
         RowBox[{"CauchyBasis", "[", 
          RowBox[{"f", ",", 
           RowBox[{";;", "k"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"g", "//", "Points"}], "//", "Rest"}], "//", "Most"}]}], 
          "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"ZeroVector", "[", "k", "]"}], "}"}]}], "]"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]",
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"_", "?", "SignQ"}], ",", 
       RowBox[{"f_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"IntervalDomainQ", "[", "#", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"RightEndpointInfinityQ", "[", "#", "]"}]}]}], "&"}], 
         ")"}]}], ",", 
       RowBox[{"1", ";;", "k_Integer"}], ",", "g_IFun"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
      RowBox[{"RightEndpoint", "[", "g", "]"}]}]}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"IFun", "[", 
       RowBox[{"#", ",", 
        RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"CauchyBasis", "[", 
          RowBox[{"f", ",", 
           RowBox[{";;", "k"}], ",", 
           RowBox[{
            RowBox[{"g", "//", "Points"}], "//", "Most"}]}], "]"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"First", "/@", 
          RowBox[{"RightSingularityDataBasis", "[", 
           RowBox[{"f", ",", 
            RowBox[{";;", "k"}], ",", 
            RowBox[{"RightContourArg", "[", "g", "]"}]}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"IntervalDomainQ", "[", "#", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"RightEndpointInfinityQ", "[", "#", "]"}]}]}], "&"}], 
        ")"}]}], ",", 
      RowBox[{"1", ";;", "k_Integer"}], ",", "g_IFun"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
     RowBox[{"LeftEndpoint", "[", "g", "]"}]}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IFun", "[", 
      RowBox[{"#", ",", 
       RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"First", "/@", 
         RowBox[{"RightSingularityDataBasis", "[", 
          RowBox[{"f", ",", 
           RowBox[{";;", "k"}], ",", 
           RowBox[{"LeftContourArg", "[", "g", "]"}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Transpose", "[", 
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"f", ",", 
          RowBox[{";;", "k"}], ",", 
          RowBox[{
           RowBox[{"g", "//", "Points"}], "//", "Rest"}]}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchyBasis", "[", 
     RowBox[{
      RowBox[{"_", "?", "SignQ"}], ",", 
      RowBox[{"f_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"IntervalDomainQ", "[", "#", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"LeftEndpointInfinityQ", "[", "#", "]"}]}]}], "&"}], 
        ")"}]}], ",", 
      RowBox[{"1", ";;", "k_Integer"}], ",", "g_IFun"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
     RowBox[{"RightEndpoint", "[", "g", "]"}]}]}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IFun", "[", 
      RowBox[{"#", ",", 
       RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"CauchyBasis", "[", 
         RowBox[{"f", ",", 
          RowBox[{";;", "k"}], ",", 
          RowBox[{
           RowBox[{"g", "//", "Points"}], "//", "Most"}]}], "]"}], "]"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"First", "/@", 
         RowBox[{"LeftSingularityDataBasis", "[", 
          RowBox[{"f", ",", 
           RowBox[{";;", "k"}], ",", 
           RowBox[{"RightContourArg", "[", "g", "]"}]}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchyBasis", "[", 
      RowBox[{
       RowBox[{"_", "?", "SignQ"}], ",", 
       RowBox[{"f_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"IntervalDomainQ", "[", "#", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"LeftEndpointInfinityQ", "[", "#", "]"}]}]}], "&"}], 
         ")"}]}], ",", 
       RowBox[{"1", ";;", "k_Integer"}], ",", "g_IFun"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", 
      RowBox[{"LeftEndpoint", "[", "g", "]"}]}]}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"IFun", "[", 
       RowBox[{"#", ",", 
        RowBox[{"g", "//", "Domain"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"First", "/@", 
          RowBox[{"LeftSingularityDataBasis", "[", 
           RowBox[{"f", ",", 
            RowBox[{";;", "k"}], ",", 
            RowBox[{"LeftContourArg", "[", "g", "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Transpose", "[", 
         RowBox[{"CauchyBasis", "[", 
          RowBox[{"f", ",", 
           RowBox[{";;", "k"}], ",", 
           RowBox[{
            RowBox[{"g", "//", "Points"}], "//", "Rest"}]}], "]"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FPCauchyBasis", "[", 
    RowBox[{
     RowBox[{"_", "?", "SignQ"}], ",", 
     RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
     RowBox[{"1", ";;", "k_Integer"}], ",", 
     RowBox[{"g_IFun", "?", "LeftEndpointInfinityQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroAtInfinityIFun", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Domain", "[", "g", "]"}]}], "]"}], "&"}], "/@", 
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"f", ",", 
      RowBox[{"1", ";;", "k"}], ",", 
      RowBox[{
       RowBox[{"g", "//", "Points"}], "//", "Rest"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FPCauchyBasis", "[", 
    RowBox[{
     RowBox[{"_", "?", "SignQ"}], ",", 
     RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
     RowBox[{"1", ";;", "k_Integer"}], ",", 
     RowBox[{"g_IFun", "?", "RightEndpointInfinityQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroAtInfinityIFun", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Domain", "[", "g", "]"}]}], "]"}], "&"}], "/@", 
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"f", ",", 
      RowBox[{"1", ";;", "k"}], ",", 
      RowBox[{
       RowBox[{"g", "//", "Points"}], "//", "Most"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FPCauchyBasis", "[", 
    RowBox[{
     RowBox[{"_", "?", "SignQ"}], ",", 
     RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
     RowBox[{"1", ";;", "k_Integer"}], ",", "g_IFun"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"IFun", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Domain", "[", "g", "]"}]}], "]"}], "&"}], "/@", 
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"f", ",", 
      RowBox[{";;", "k"}], ",", 
      RowBox[{"g", "//", "Points"}]}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivative", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pLD", "[", 
    RowBox[{
     RowBox[{"0", ";;", 
      RowBox[{"m_", "?", "Positive"}]}], ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cur", ",", "ph"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ph", "=", 
       RowBox[{"\[Psi]pL", "[", 
        RowBox[{
         RowBox[{"0", ";;", "m"}], ",", "x"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cur", "=", 
          RowBox[{"\[Psi]pD", "[", 
           RowBox[{"0", ",", "x"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"cur", "=", 
           RowBox[{
            RowBox[{"cur", " ", "x"}], "+", 
            RowBox[{
            "ph", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "m"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pLD", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"l_", "?", "Negative"}], ";;", 
      RowBox[{"m_", "?", "Negative"}]}], ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cur", ",", "ph"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ph", "=", 
       RowBox[{"\[Psi]pL", "[", 
        RowBox[{
         RowBox[{"l", ";;", "m"}], ",", "x"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cur", "=", 
          RowBox[{"\[Psi]pD", "[", 
           RowBox[{"l", ",", "x"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"cur", "=", 
           RowBox[{
            RowBox[{"cur", " ", "x"}], "+", 
            RowBox[{"ph", "\[LeftDoubleBracket]", 
             RowBox[{"i", "-", "l"}], "\[RightDoubleBracket]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"l", "+", "1"}], ",", "m"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]pLD", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"i_", "?", "Negative"}], ";;", "0"}], ",", "x_"}], "]"}], ":=", 
   
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"\[Psi]pLD", "[", 
      RowBox[{
       RowBox[{"i", ";;", 
        RowBox[{"-", "1"}]}], ",", "x"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Psi]pD", "[", 
       RowBox[{"0", ",", "x"}], "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]pLD", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"i_", "?", "Negative"}], ";;", 
       RowBox[{"j_", "?", "Positive"}]}], ",", "x_"}], "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"\[Psi]pLD", "[", 
       RowBox[{
        RowBox[{"i", ";;", 
         RowBox[{"-", "1"}]}], ",", "x"}], "]"}], ",", 
      RowBox[{"\[Psi]pLD", "[", 
       RowBox[{
        RowBox[{"0", ";;", "j"}], ",", "x"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{"UnitInterval", ",", 
     RowBox[{"i_", ";;", "k_"}], ",", "x_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "/", 
     RowBox[{"(", 
      RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
    RowBox[{
     RowBox[{"IntervalToInnerCircle", "'"}], "[", "x", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Psi]pLD", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "-", "1"}], ";;", 
         RowBox[{"k", "-", "1"}]}], ",", 
        RowBox[{"IntervalToInnerCircle", "[", "x", "]"}]}], "]"}], "+", 
      RowBox[{"Reverse", "[", 
       RowBox[{"\[Psi]pLD", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "k"}], "+", "1"}], ";;", 
          RowBox[{"1", "-", "i"}]}], ",", 
         RowBox[{"IntervalToInnerCircle", "[", "x", "]"}]}], "]"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "UnitInterval", ",", 
     RowBox[{"i_", ";;", "k_"}], ",", "x_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "/", 
     RowBox[{"(", 
      RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
    RowBox[{
     RowBox[{"IntervalToBottomCircle", "'"}], "[", "x", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Psi]pLD", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "-", "1"}], ";;", 
         RowBox[{"k", "-", "1"}]}], ",", 
        RowBox[{"IntervalToBottomCircle", "[", "x", "]"}]}], "]"}], "+", 
      RowBox[{"Reverse", "[", 
       RowBox[{"\[Psi]pLD", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "k"}], "+", "1"}], ";;", 
          RowBox[{"1", "-", "i"}]}], ",", 
         RowBox[{"IntervalToBottomCircle", "[", "x", "]"}]}], "]"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "UnitInterval", ",", 
      RowBox[{"i_", ";;", "k_"}], ",", "x_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"(", 
       RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
     RowBox[{
      RowBox[{"IntervalToTopCircle", "'"}], "[", "x", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Psi]pLD", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "-", "1"}], ";;", 
          RowBox[{"k", "-", "1"}]}], ",", 
         RowBox[{"IntervalToTopCircle", "[", "x", "]"}]}], "]"}], "+", 
       RowBox[{"Reverse", "[", 
        RowBox[{"\[Psi]pLD", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "k"}], "+", "1"}], ";;", 
           RowBox[{"1", "-", "i"}]}], ",", 
          RowBox[{"IntervalToTopCircle", "[", "x", "]"}]}], "]"}], "]"}]}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{"UnitInterval", ",", 
     RowBox[{"i_", ";;", "k_"}], ",", "x_List"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
      RowBox[{
       RowBox[{"IntervalToInnerCircle", "'"}], "[", "x", "]"}], " ", "#"}], 
     "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Psi]pLD", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "-", "1"}], ";;", 
         RowBox[{"k", "-", "1"}]}], ",", 
        RowBox[{"IntervalToInnerCircle", "[", "x", "]"}]}], "]"}], "+", 
      RowBox[{"Reverse", "[", 
       RowBox[{"\[Psi]pLD", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "k"}], "+", "1"}], ";;", 
          RowBox[{"1", "-", "i"}]}], ",", 
         RowBox[{"IntervalToInnerCircle", "[", "x", "]"}]}], "]"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "UnitInterval", ",", 
     RowBox[{"i_", ";;", "k_"}], ",", "x_List"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
      RowBox[{
       RowBox[{"IntervalToBottomCircle", "'"}], "[", "x", "]"}], "#"}], "&"}],
     "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Psi]pLD", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "-", "1"}], ";;", 
         RowBox[{"k", "-", "1"}]}], ",", 
        RowBox[{"IntervalToBottomCircle", "[", "x", "]"}]}], "]"}], "+", 
      RowBox[{"Reverse", "[", 
       RowBox[{"\[Psi]pLD", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "k"}], "+", "1"}], ";;", 
          RowBox[{"1", "-", "i"}]}], ",", 
         RowBox[{"IntervalToBottomCircle", "[", "x", "]"}]}], "]"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "UnitInterval", ",", 
      RowBox[{"i_", ";;", "k_"}], ",", "x_List"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", 
        RowBox[{"(", 
         RowBox[{"I", " ", "\[Pi]"}], ")"}]}], 
       RowBox[{
        RowBox[{"IntervalToTopCircle", "'"}], "[", "x", "]"}], "#"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Psi]pLD", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "-", "1"}], ";;", 
          RowBox[{"k", "-", "1"}]}], ",", 
         RowBox[{"IntervalToTopCircle", "[", "x", "]"}]}], "]"}], "+", 
       RowBox[{"Reverse", "[", 
        RowBox[{"\[Psi]pLD", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "k"}], "+", "1"}], ";;", 
           RowBox[{"1", "-", "i"}]}], ",", 
          RowBox[{"IntervalToTopCircle", "[", "x", "]"}]}], "]"}], "]"}]}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{
     RowBox[{"f_", "?", "RightEndpointInfinityQ"}], ",", 
     RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapToIntervalD", "[", 
     RowBox[{"f", ",", "z"}], "]"}], 
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"UnitInterval", ",", 
      RowBox[{"1", ";;", "k"}], ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{
      RowBox[{"f_", "?", "LeftEndpointInfinityQ"}], ",", 
      RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"MapToIntervalD", "[", 
      RowBox[{"f", ",", "z"}], "]"}], 
     RowBox[{"CauchyBasisD", "[", 
      RowBox[{"UnitInterval", ",", 
       RowBox[{"1", ";;", "k"}], ",", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{
      RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
      RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"MapToIntervalD", "[", 
      RowBox[{"f", ",", "z"}], "]"}], " ", 
     RowBox[{"CauchyBasisD", "[", 
      RowBox[{"UnitInterval", ",", 
       RowBox[{"1", ";;", "k"}], ",", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
      RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"MapToIntervalD", "[", 
      RowBox[{"f", ",", "z"}], "]"}], " ", 
     RowBox[{"CauchyBasisD", "[", 
      RowBox[{"s", ",", "UnitInterval", ",", 
       RowBox[{"1", ";;", "k"}], ",", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{"s_", ",", 
     RowBox[{"f_", "?", "RightEndpointInfinityQ"}], ",", 
     RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapToIntervalD", "[", 
     RowBox[{"f", ",", "z"}], "]"}], 
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"s", ",", "UnitInterval", ",", 
      RowBox[{"1", ";;", "k"}], ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_", "?", "LeftEndpointInfinityQ"}], ",", 
      RowBox[{"1", ";;", "k_"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"MapToIntervalD", "[", 
      RowBox[{"f", ",", "z"}], "]"}], 
     RowBox[{"CauchyBasisD", "[", 
      RowBox[{"s", ",", "UnitInterval", ",", 
       RowBox[{"1", ";;", "k"}], ",", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{
     RowBox[{"f_", "?", "RightEndpointInfinityQ"}], ",", 
     RowBox[{"1", ";;", "k_"}], ",", "z_List"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MapToIntervalD", "[", 
       RowBox[{"f", ",", "z"}], "]"}], "#"}], "&"}], "/@", 
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"UnitInterval", ",", 
      RowBox[{"1", ";;", "k"}], ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{
      RowBox[{"f_", "?", "LeftEndpointInfinityQ"}], ",", 
      RowBox[{"1", ";;", "k_"}], ",", "z_List"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MapToIntervalD", "[", 
        RowBox[{"f", ",", "z"}], "]"}], "#"}], "&"}], "/@", 
     RowBox[{"CauchyBasisD", "[", 
      RowBox[{"UnitInterval", ",", 
       RowBox[{"1", ";;", "k"}], ",", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{
     RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
     RowBox[{"1", ";;", "k_"}], ",", "z_List"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MapToIntervalD", "[", 
       RowBox[{"f", ",", "z"}], "]"}], " ", "#"}], "&"}], "/@", 
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"UnitInterval", ",", 
      RowBox[{"1", ";;", "k"}], ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_", "?", "IntervalDomainQ"}], ",", 
      RowBox[{"1", ";;", "k_"}], ",", "z_List"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MapToIntervalD", "[", 
        RowBox[{"f", ",", "z"}], "]"}], " ", "#"}], "&"}], "/@", 
     RowBox[{"CauchyBasisD", "[", 
      RowBox[{"s", ",", "UnitInterval", ",", 
       RowBox[{"1", ";;", "k"}], ",", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyBasisD", "[", 
    RowBox[{"s_", ",", 
     RowBox[{"f_", "?", "RightEndpointInfinityQ"}], ",", 
     RowBox[{"1", ";;", "k_"}], ",", "z_List"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MapToIntervalD", "[", 
       RowBox[{"f", ",", "z"}], "]"}], "#"}], "&"}], "/@", 
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"s", ",", "UnitInterval", ",", 
      RowBox[{"1", ";;", "k"}], ",", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_", "?", "LeftEndpointInfinityQ"}], ",", 
      RowBox[{"1", ";;", "k_"}], ",", "z_List"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MapToIntervalD", "[", 
        RowBox[{"f", ",", "z"}], "]"}], "#"}], "&"}], "/@", 
     RowBox[{"CauchyBasisD", "[", 
      RowBox[{"s", ",", "UnitInterval", ",", 
       RowBox[{"1", ";;", "k"}], ",", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cauchy and FPCauchy", "Section"],

Cell[CellGroupData[{

Cell["Functionss", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{"f_IFun", ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   RowBox[{"0", " ", 
    RowBox[{"First", "[", "f", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{"f_List", ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   RowBox[{"0", " ", 
    RowBox[{"First", "[", 
     RowBox[{"First", "[", "f", "]"}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{"f_IFun", ",", "x_"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", "x"}], "&&", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"First", "[", "f", "]"}], "]"}], "~", "NEqual", "~", "0."}]}],
      ")"}]}], ":=", 
   RowBox[{
    RowBox[{"f", "//", "LeftSingularityData"}], "//", "First"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cauchy", "[", 
      RowBox[{
       RowBox[{"_", "?", "SignQ"}], ",", "f_IFun", ",", "x_"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", "x"}], "&&", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"First", "[", "f", "]"}], "]"}], "~", "NEqual", "~", 
        "0."}]}], ")"}]}], ":=", 
    RowBox[{
     RowBox[{"f", "//", "LeftSingularityData"}], "//", "First"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{"f_IFun", ",", "x_"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", "x"}], 
     ")"}]}], ":=", "\[Infinity]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cauchy", "[", 
      RowBox[{
       RowBox[{"_", "?", "SignQ"}], ",", "f_IFun", ",", "x_"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"LeftEndpoint", "[", "f", "]"}], "~", "NEqual", "~", "x"}], 
      ")"}]}], ":=", "\[Infinity]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{"f_IFun", ",", "x_"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", "x"}], "&&", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"Last", "[", "f", "]"}], "]"}], "~", "NEqual", "~", "0."}]}], 
     ")"}]}], ":=", 
   RowBox[{
    RowBox[{"f", "//", "RightSingularityData"}], "//", "First"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cauchy", "[", 
      RowBox[{
       RowBox[{"_", "?", "SignQ"}], ",", "f_IFun", ",", "x_"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", "x"}], "&&", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{"First", "[", "f", "]"}], "]"}], "~", "NEqual", "~", 
        "0."}]}], ")"}]}], ":=", 
    RowBox[{
     RowBox[{"f", "//", "RightSingularityData"}], "//", "First"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{"f_IFun", ",", "x_"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", "x"}], 
     ")"}]}], ":=", "\[Infinity]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cauchy", "[", 
      RowBox[{
       RowBox[{"_", "?", "SignQ"}], ",", "f_IFun", ",", "x_"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RightEndpoint", "[", "f", "]"}], "~", "NEqual", "~", "x"}], 
      ")"}]}], ":=", "\[Infinity]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{"f_IFun", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CauchyBasis", "[", 
     RowBox[{"f", ",", 
      RowBox[{";;", 
       RowBox[{"Length", "[", "f", "]"}]}], ",", "x"}], "]"}], ".", 
    RowBox[{"(", 
     RowBox[{"f", "//", "DCT"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{"s_", ",", "f_IFun", ",", "x_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"CauchyBasis", "[", 
      RowBox[{"s", ",", "f", ",", 
       RowBox[{";;", 
        RowBox[{"Length", "[", "f", "]"}]}], ",", "x"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"f", "//", "DCT"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{"f_IFun", ",", "xv_List"}], "]"}], ":=", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"x", ",", 
           RowBox[{"x", " ", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}],
        "&"}], "/@", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"CauchyBasis", "[", 
          RowBox[{"f", ",", 
           RowBox[{";;", 
            RowBox[{"Length", "[", "f", "]"}]}], ",", "xv"}], "]"}], ",", 
         RowBox[{"DCT", "[", "f", "]"}]}], "}"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{"s_", ",", "f_IFun", ",", "xv_List"}], "]"}], ":=", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"x", ",", 
            RowBox[{"x", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
           "]"}], ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}], "/@", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"CauchyBasis", "[", 
           RowBox[{"s", ",", "f", ",", 
            RowBox[{";;", 
             RowBox[{"Length", "[", "f", "]"}]}], ",", "xv"}], "]"}], ",", 
          RowBox[{"DCT", "[", "f", "]"}]}], "}"}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{"f_List", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cauchy", "[", 
         RowBox[{"#", ",", "x"}], "]"}], "&"}], "/@", "f"}], ")"}]}]}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{"s_", ",", "f_List", ",", "x_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DomainMemberQ", "[", 
          RowBox[{"#", ",", "x"}], "]"}], ",", 
         RowBox[{"Cauchy", "[", 
          RowBox[{"s", ",", "#", ",", "x"}], "]"}], ",", 
         RowBox[{"Cauchy", "[", 
          RowBox[{"#", ",", "x"}], "]"}]}], "]"}], "&"}], "/@", "f"}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{"s_", ",", "f_List", ",", "x_List"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"U", ",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"DomainMemberQ", "[", 
                RowBox[{"U", ",", 
                 RowBox[{"#", "//", "First"}]}], "]"}], ",", 
               RowBox[{"Cauchy", "[", 
                RowBox[{"s", ",", "U", ",", "#"}], "]"}], ",", 
               RowBox[{"Cauchy", "[", 
                RowBox[{"U", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
            RowBox[{"SplitBy", "[", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"DomainMemberQ", "[", 
                RowBox[{"U", ",", "#"}], "]"}], "&"}]}], "]"}]}], 
           "\[IndentingNewLine]", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
        "]"}], "/@", "f"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hilbert", "[", 
    RowBox[{"lf_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"I", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cauchy", "[", 
       RowBox[{
        RowBox[{"+", "1"}], ",", "lf", ",", "z"}], "]"}], "+", 
      RowBox[{"Cauchy", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "lf", ",", "z"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Hilbert", "[", "lf_", "]"}], ":=", 
    RowBox[{"I", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cauchy", "[", 
        RowBox[{
         RowBox[{"+", "1"}], ",", "lf"}], "]"}], "+", 
       RowBox[{"Cauchy", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "lf"}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`FPCauchy", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", "f_IFun", ",", "g_IFun"}], "]"}], ":=", 
   RowBox[{"IFun", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"(", 
        RowBox[{"Values", "/@", 
         RowBox[{"FPCauchyBasis", "[", 
          RowBox[{"s", ",", "f", ",", 
           RowBox[{";;", 
            RowBox[{"Length", "[", "f", "]"}]}], ",", "g"}], "]"}]}], ")"}], 
       "]"}], ".", 
      RowBox[{"DCT", "[", "f", "]"}]}], ",", 
     RowBox[{"g", "//", "Domain"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FPCauchy", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", "f_List", ",", "g_IFun"}], "]"}], ":=", 
   RowBox[{"FastPlus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"FPCauchy", "[", 
        RowBox[{"s", ",", "#", ",", "g"}], "]"}], "&"}], "/@", "f"}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FPCauchy", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", "f_List", ",", 
     RowBox[{"g", ":", 
      RowBox[{"{", "__IFun", "}"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"FPCauchy", "[", 
      RowBox[{"s", ",", "f", ",", "#"}], "]"}], "&"}], "/@", "g"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPCauchy", "[", 
     RowBox[{
      RowBox[{"s_", "?", "SignQ"}], ",", "f_"}], "]"}], ":=", 
    RowBox[{"FPCauchy", "[", 
     RowBox[{"s", ",", "f", ",", "f"}], "]"}]}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyBoundedQ", "[", "l_List", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"x", ",", "\[IndentingNewLine]", 
             RowBox[{"Plus", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Which", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"LeftEndpoint", "[", "#", "]"}], "~", "NEqual", 
                    "~", "x"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"First", "[", "#", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"RightEndpoint", "[", "#", "]"}], "~", "NEqual", 
                    "~", "x"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"-", 
                    RowBox[{"Last", "[", "#", "]"}]}], ",", 
                   "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
                   
                   RowBox[{"0", " ", 
                    RowBox[{"First", "[", "#", "]"}]}]}], "]"}], "&"}], "/@", 
                "l"}], ")"}]}]}], "]"}], "/@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Union", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LeftEndpoint", "[", "#", "]"}], ",", 
                   RowBox[{"RightEndpoint", "[", "#", "]"}]}], "}"}], "&"}], "/@",
                 "l"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"InfinityQ", "[", "#", "]"}]}], "&"}]}], "]"}]}], 
          ")"}], "//", "Abs"}], "//", "Max"}], ")"}], "/", "10"}], "//", 
     "NZeroQ"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cauchy", "[", 
    RowBox[{"s_", ",", 
     RowBox[{"f_List", "?", "CauchyBoundedQ"}], ",", 
     RowBox[{"g", ":", 
      RowBox[{"{", "__IFun", "}"}]}]}], "]"}], ":=", 
   RowBox[{"FPCauchy", "[", 
    RowBox[{"s", ",", "f", ",", "g"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cauchy", "[", 
     RowBox[{"s_", ",", "f_List"}], "]"}], ":=", 
    RowBox[{"Cauchy", "[", 
     RowBox[{"s", ",", "f", ",", "f"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyOperator", "[", 
    RowBox[{"s_", ",", "f_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "mat", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mat", "=", 
       RowBox[{"CauchyMatrix", "[", 
        RowBox[{"s", ",", "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FromValueList", "[", 
        RowBox[{"#", ",", 
         RowBox[{"mat", ".", 
          RowBox[{"ToValueList", "[", "#", "]"}]}]}], "]"}], "&"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddIdentityMatrix", "[", "l_IFun", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", "#"}], ")"}], "&"}], "/@",
     "l"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddIdentityMatrix", "[", "l_List", "]"}], ":=", 
   RowBox[{"AddIdentityMatrix", "/@", "l"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ders", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`CauchyD", "[", 
     RowBox[{"f_IFun", ",", 
      RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
    RowBox[{"0", " ", 
     RowBox[{"First", "[", "f", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyD", "[", 
    RowBox[{"f_IFun", ",", "xv_List"}], "]"}], ":=", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"x", ",", 
           RowBox[{"x", " ", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}],
        "&"}], "/@", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"CauchyBasisD", "[", 
          RowBox[{"f", ",", 
           RowBox[{";;", 
            RowBox[{"Length", "[", "f", "]"}]}], ",", "xv"}], "]"}], ",", 
         RowBox[{"DCT", "[", "f", "]"}]}], "}"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyD", "[", 
     RowBox[{"s_", ",", "f_IFun", ",", "xv_List"}], "]"}], ":=", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"x", ",", 
            RowBox[{"x", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
           "]"}], ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}], "/@", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"CauchyBasisD", "[", 
           RowBox[{"s", ",", "f", ",", 
            RowBox[{";;", 
             RowBox[{"Length", "[", "f", "]"}]}], ",", "xv"}], "]"}], ",", 
          RowBox[{"DCT", "[", "f", "]"}]}], "}"}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyD", "[", 
     RowBox[{"f_List", ",", 
      RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
    RowBox[{"0", " ", 
     RowBox[{"First", "[", 
      RowBox[{"First", "[", "f", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyD", "[", 
    RowBox[{"f_IFun", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CauchyBasisD", "[", 
     RowBox[{"f", ",", 
      RowBox[{";;", 
       RowBox[{"Length", "[", "f", "]"}]}], ",", "x"}], "]"}], ".", 
    RowBox[{"(", 
     RowBox[{"f", "//", "DCT"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyD", "[", 
     RowBox[{"s_", ",", "f_IFun", ",", "x_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"CauchyBasisD", "[", 
      RowBox[{"s", ",", "f", ",", 
       RowBox[{";;", 
        RowBox[{"Length", "[", "f", "]"}]}], ",", "x"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"f", "//", "DCT"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyD", "[", 
     RowBox[{"f_List", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CauchyD", "[", 
         RowBox[{"#", ",", "x"}], "]"}], "&"}], "/@", "f"}], ")"}]}]}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyD", "[", 
     RowBox[{"s_", ",", "f_List", ",", "x_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DomainMemberQ", "[", 
           RowBox[{"#", ",", "x"}], "]"}], ",", 
          RowBox[{"CauchyD", "[", 
           RowBox[{"s", ",", "#", ",", "x"}], "]"}], ",", 
          RowBox[{"CauchyD", "[", 
           RowBox[{"#", ",", "x"}], "]"}]}], "]"}], "&"}], "/@", "f"}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyD", "[", 
    RowBox[{"s_", ",", "f_List", ",", "x_List"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"U", ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"DomainMemberQ", "[", 
               RowBox[{"U", ",", 
                RowBox[{"#", "//", "First"}]}], "]"}], ",", 
              RowBox[{"CauchyD", "[", 
               RowBox[{"s", ",", "U", ",", "#"}], "]"}], ",", 
              RowBox[{"CauchyD", "[", 
               RowBox[{"U", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
           RowBox[{"SplitBy", "[", 
            RowBox[{"x", ",", 
             RowBox[{
              RowBox[{"DomainMemberQ", "[", 
               RowBox[{"U", ",", "#"}], "]"}], "&"}]}], "]"}]}], 
          "\[IndentingNewLine]", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], "/@", "f"}], ")"}]}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["CauchyMatrix", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyMatrix", "[", 
     RowBox[{
      RowBox[{"s_", "?", "SignQ"}], ",", 
      RowBox[{"f_IFun", "?", "ScalarFunQ"}], ",", "g_IFun"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"(", 
       RowBox[{"FiniteValues", "/@", 
        RowBox[{"FPCauchyBasis", "[", 
         RowBox[{"s", ",", "f", ",", 
          RowBox[{";;", 
           RowBox[{"Length", "[", "f", "]"}]}], ",", "g"}], "]"}]}], ")"}], 
      "]"}], ".", 
     RowBox[{"FiniteTransformMatrix", "[", "f", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ScalarToVectorMatrix", ":=", 
   RowBox[{
    RowBox[{"BlockDiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{"#", ",", "#"}], "}"}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarToMatrixMatrix", ":=", 
    RowBox[{
     RowBox[{"BlockDiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"#", ",", "#", ",", "#", ",", "#"}], "}"}], "]"}], "&"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyMatrix", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", 
     RowBox[{"f_IFun", "?", "VectorFunQ"}], ",", "g_IFun"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CauchyMatrix", "[", 
     RowBox[{"s", ",", 
      RowBox[{"f", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", "g"}], "]"}], "//", "ScalarToVectorMatrix"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyMatrix", "[", 
     RowBox[{
      RowBox[{"s_", "?", "SignQ"}], ",", 
      RowBox[{"f_IFun", "?", "MatrixFunQ"}], ",", "g_IFun"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"CauchyMatrix", "[", 
      RowBox[{"s", ",", 
       RowBox[{"f", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", "g"}], "]"}],
      "//", "ScalarToMatrixMatrix"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyMatrix", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", 
     RowBox[{"l", ":", 
      RowBox[{"{", 
       RowBox[{"__", "?", "MatrixFunQ"}], "}"}]}], ",", "g_IFun"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CauchyMatrix", "[", 
     RowBox[{"s", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "&"}], "/@", 
       "l"}], ",", "g"}], "]"}], "//", "ScalarToMatrixMatrix"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyMatrix", "[", 
     RowBox[{
      RowBox[{"s_", "?", "SignQ"}], ",", 
      RowBox[{"l", ":", 
       RowBox[{"{", 
        RowBox[{"__", "?", "MatrixFunQ"}], "}"}]}], ",", "l2_List"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"CauchyMatrix", "[", 
      RowBox[{"s", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "&"}], "/@", 
        "l"}], ",", "l2"}], "]"}], "//", "ScalarToMatrixMatrix"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyMatrix", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", 
     RowBox[{"l", ":", 
      RowBox[{"{", 
       RowBox[{"__", "?", "VectorFunQ"}], "}"}]}], ",", "g_IFun"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CauchyMatrix", "[", 
     RowBox[{"s", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "&"}], "/@", "l"}], ",", "g"}], "]"}], "//", 
    "ScalarToVectorMatrix"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyMatrix", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", 
     RowBox[{"l", ":", 
      RowBox[{"{", 
       RowBox[{"__", "?", "VectorFunQ"}], "}"}]}], ",", "l2_List"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CauchyMatrix", "[", 
     RowBox[{"s", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "&"}], "/@", "l"}], ",", "l2"}], "]"}], "//", 
    "ScalarToVectorMatrix"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyMatrix", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", 
     RowBox[{"l", ":", 
      RowBox[{"{", "__IFun", "}"}]}], ",", "g_IFun"}], "]"}], ":=", 
   RowBox[{"RightJoin", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"CauchyMatrix", "[", 
        RowBox[{"s", ",", "#", ",", "g"}], "]"}], "&"}], "/@", "l"}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyMatrix", "[", 
     RowBox[{
      RowBox[{"s_", "?", "SignQ"}], ",", 
      RowBox[{"l", ":", 
       RowBox[{"{", "__IFun", "}"}]}], ",", 
      RowBox[{"l2", ":", 
       RowBox[{"{", "__IFun", "}"}]}]}], "]"}], ":=", 
    RowBox[{"Join", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CauchyMatrix", "[", 
         RowBox[{"s", ",", "l", ",", "#"}], "]"}], "&"}], "/@", "l2"}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyMatrix", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", "f_IFun"}], "]"}], ":=", 
   RowBox[{"CauchyMatrix", "[", 
    RowBox[{"s", ",", "f", ",", "f"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyMatrix", "[", 
    RowBox[{
     RowBox[{"s_", "?", "SignQ"}], ",", 
     RowBox[{"f", ":", 
      RowBox[{"{", "__IFun", "}"}]}]}], "]"}], ":=", 
   RowBox[{"CauchyMatrix", "[", 
    RowBox[{"s", ",", "f", ",", "f"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["RHSolve", "Section"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MakeMachineNumber", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"x", ",", "$MinMachineNumber"}], "]"}], "//", "N"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RHSolverTop", "[", 
      RowBox[{
       RowBox[{"GGIn", ":", 
        RowBox[{"{", "__IFun", "}"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], " ", "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"RHSolverTop", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CauchyMatrix", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "&"}], "/@", 
           "GGIn"}]}], "]"}], "//", "MakeMachineNumber"}], ",", "opts"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RHSolverTop", "[", 
       RowBox[{"matmS_", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", 
          RowBox[{"{", 
           RowBox[{"SowCondition", "\[Rule]", "False"}], "}"}], "]"}]}]}], 
       "]"}], "[", 
      RowBox[{"GG_", ",", 
       RowBox[{"GR", ":", 
        RowBox[{"{", "__List", "}"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"matt", ",", "solv", ",", "sol", ",", "cond", ",", "matm"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"matm", "=", 
         RowBox[{"matmS", "//", "ScalarToVectorMatrix"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"matt", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"SparseIdentityMatrix", "[", 
            RowBox[{"Length", "[", "matm", "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"SparseIdentityMatrix", "[", 
               RowBox[{"Length", "[", "matm", "]"}], "]"}], "-", 
              RowBox[{"MakeMachineNumber", "[", 
               RowBox[{"RightMatrixMultVectorFun", "[", "GG", "]"}], "]"}]}], 
             ")"}], ".", "matm"}]}], "//", "MakeMachineNumber"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "SowCondition", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"cond", "=", 
            RowBox[{
            "LinearAlgebra`MatrixConditionNumber", "[", "matt", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Sow", "[", "cond", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"solv", "=", 
         RowBox[{"LinearSolve", "[", "matt", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sol", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"FromValueList", "[", 
            RowBox[{"#", ",", 
             RowBox[{"solv", "[", 
              RowBox[{
               RowBox[{"#", "//", "ToValueList"}], "//", 
               "MakeMachineNumber"}], "]"}]}], "]"}], "&"}], "/@", 
          "GR"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RHSolverTop", "[", 
       RowBox[{"matm_", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "[", "GG_", "]"}], 
     " ", ":=", " ", 
     RowBox[{
      RowBox[{"RHSolverTop", "[", 
       RowBox[{"matm", ",", "opts"}], "]"}], "[", 
      RowBox[{"GG", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "All"}], "\[RightDoubleBracket]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "-", 
              RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "&"}], "/@", "#"}],
            "&"}], "/@", "GG"}], ")"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RHSolverTop", "[", 
       RowBox[{"matm_", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "[", 
      RowBox[{"GG_", ",", "GR_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"RHSolverTop", "[", 
        RowBox[{"matm", ",", "opts"}], "]"}], "[", 
       RowBox[{"GG", ",", 
        RowBox[{"{", "GR", "}"}]}], "]"}], "//", "First"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RHSolveTop", "[", 
      RowBox[{"GG_List", ",", "GI_List", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"matp", ",", "matm", ",", "GITop"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RHSolverTop", "[", 
         RowBox[{"GG", ",", "opts"}], "]"}], "[", 
        RowBox[{"GG", ",", "GI"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RHSolveTop", "[", 
      RowBox[{"GG_List", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"RHSolveTop", "[", 
      RowBox[{"GG", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "All"}], "\[RightDoubleBracket]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "-", 
              RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "&"}], "/@", "#"}],
            "&"}], "/@", "GG"}], ")"}]}], ",", "opts"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RHSolver", "[", 
      RowBox[{"GGIn_List", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "rsolvt", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rsolvt", "=", 
         RowBox[{"RHSolverTop", "[", 
          RowBox[{"GGIn", ",", "opts"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"RHSolver", "[", "rsolvt", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RHSolver", "[", "rsolvt_RHSolverTop", "]"}], "[", 
      RowBox[{"GG_", ",", "GR_"}], "]"}], " ", ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"ToArrayFun", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ToArrayOfFuns", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ToArrayOfFuns", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}], "}"}]}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"Thread", "[", 
       RowBox[{"rsolvt", "[", 
        RowBox[{"GG", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "All"}], "\[RightDoubleBracket]"}], "&"}], "/@",
             "GR"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "All"}], "\[RightDoubleBracket]"}], "&"}], "/@",
             "GR"}]}], "}"}]}], "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RHSolver", "[", "rsolvt_RHSolverTop", "]"}], "[", "GG_", "]"}],
      ":=", 
     RowBox[{
      RowBox[{"RHSolver", "[", "rsolvt", "]"}], "[", 
      RowBox[{"GG", ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "-", 
             RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "&"}], "/@", "#"}], 
          "&"}], "/@", "GG"}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RHSolve", "[", 
      RowBox[{"GG_List", ",", "GI_List", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RHSolver", "[", 
       RowBox[{"GG", ",", "opts"}], "]"}], "[", 
      RowBox[{"GG", ",", "GI"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RHSolve", "[", 
      RowBox[{"GG_List", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"RHSolve", "[", 
      RowBox[{"GG", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "-", 
            RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "&"}], "/@", "#"}], 
         "&"}], "/@", "GG"}], ",", "opts"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FunValueListOperator", "[", 
       RowBox[{"mat_", ",", "g_"}], "]"}], "[", 
      RowBox[{"f", ":", 
       RowBox[{"{", 
        RowBox[{"__", "?", "ScalarFunQ"}], "}"}]}], "]"}], ":=", 
     RowBox[{"FromValueList", "[", 
      RowBox[{"g", ",", 
       RowBox[{"mat", ".", 
        RowBox[{"ToValueList", "[", "f", "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FunValueListOperator", "[", 
       RowBox[{"mat_", ",", "g_"}], "]"}], "[", 
      RowBox[{"f", ":", 
       RowBox[{"{", 
        RowBox[{"__", "?", "VectorFunQ"}], "}"}]}], "]"}], ":=", 
     RowBox[{"FromValueList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "&"}], "/@", "#"}], "&"}], "/@", 
        "g"}], ",", 
       RowBox[{
        RowBox[{"ScalarToVectorMatrix", "[", "mat", "]"}], ".", 
        RowBox[{"ToValueList", "[", "f", "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FunValueListOperator", "[", 
       RowBox[{"mat_", ",", "g_"}], "]"}], "[", 
      RowBox[{"f", ":", 
       RowBox[{"{", 
        RowBox[{"__", "?", "MatrixFunQ"}], "}"}]}], "]"}], ":=", 
     RowBox[{"FromValueList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", GridBox[{
              {"0", "0"},
              {"0", "0"}
             }], ")"}], "&"}], "/@", "#"}], "&"}], "/@", "g"}], ",", 
       RowBox[{
        RowBox[{"ScalarToMatrixMatrix", "[", "mat", "]"}], ".", 
        RowBox[{"ToValueList", "[", "f", "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FunValueListOperator", "[", "mat_", "]"}], "[", "f_", "]"}], ":=", 
     RowBox[{
      RowBox[{"FunValueListOperator", "[", 
       RowBox[{"mat", ",", "f"}], "]"}], "[", "f", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SetDomain", "[", 
      RowBox[{"op_FunValueListOperator", ",", "d_"}], "]"}], ":=", 
     RowBox[{"FunValueListOperator", "[", 
      RowBox[{
       RowBox[{"op", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"SetDomain", "[", 
        RowBox[{
         RowBox[{"op", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
          ",", "d"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyOperator", "[", 
      RowBox[{"1", ",", "R_RHSolverTop"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"FunValueListOperator", "[", 
      RowBox[{
       RowBox[{"R", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "+", 
       RowBox[{"SparseIdentityMatrix", "[", 
        RowBox[{"Length", "[", 
         RowBox[{"R", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyOperator", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "R_RHSolverTop"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"FunValueListOperator", "[", 
      RowBox[{"R", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyOperator", "[", 
      RowBox[{"s_", ",", "R_RHSolver"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"CauchyOperator", "[", 
      RowBox[{"s", ",", 
       RowBox[{"R", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["CauchyInverse IFun", "Section",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Basis and evals", "Subsection",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`CauchyInverse", "::", "usage"}], "=", 
    "\"\<CauchyInverse[f,z] computes the function \[Phi][z] such that the \
Cauchy transform of \[Phi]^+\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`CauchyInverseBasis", "[", 
    RowBox[{"d_", ",", "1", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "-", 
    RowBox[{
     RowBox[{"MapToInterval", "[", 
      RowBox[{"d", ",", "z"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"MapToInterval", "[", 
          RowBox[{"d", ",", "z"}], "]"}], "+", "1"}], "]"}], " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"MapToInterval", "[", 
          RowBox[{"d", ",", "z"}], "]"}], "-", "1"}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverseBasis", "[", 
    RowBox[{"d_", ",", "k_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"IntervalToInnerCircle", "[", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"d", ",", "z"}], "]"}], "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"k", "-", "1"}], ")"}]}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverseBasis", "[", 
    RowBox[{"s_", ",", "d_", ",", "1", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "+", 
    RowBox[{"s", " ", "I", 
     FractionBox[
      RowBox[{"MapToInterval", "[", 
       RowBox[{"d", ",", "z"}], "]"}], 
      RowBox[{"2", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"MapToInterval", "[", 
           RowBox[{"d", ",", "z"}], "]"}], "^", "2"}]}], "]"}]}]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverseBasis", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "d_", ",", "k_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"IntervalToBottomCircle", "[", 
      RowBox[{"MapToInterval", "[", 
       RowBox[{"d", ",", "z"}], "]"}], "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"k", "-", "1"}], ")"}]}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverseBasis", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "d_", ",", "k_", ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"IntervalToTopCircle", "[", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"d", ",", "z"}], "]"}], "]"}], "^", 
      RowBox[{"(", 
       RowBox[{"k", "-", "1"}], ")"}]}], "/", "2"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverse", "[", 
    RowBox[{
     RowBox[{"f_IFun", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"NZeroQ", "[", 
         RowBox[{"Mean", "[", "#", "]"}], "]"}], "&"}], ")"}]}], ",", "z_"}], 
    "]"}], ":=", 
   RowBox[{"MapDot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseBasis", "[", 
       RowBox[{"f", ",", 
        RowBox[{"#", "+", "1"}], ",", "z"}], "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{"f", "//", "DCT"}], "//", "Rest"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverse", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_IFun", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"NZeroQ", "[", 
          RowBox[{"Mean", "[", "#", "]"}], "]"}], "&"}], ")"}]}], ",", "z_"}],
      "]"}], ":=", 
    RowBox[{"MapDot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"CauchyInverseBasis", "[", 
        RowBox[{"s", ",", "f", ",", 
         RowBox[{"#", "+", "1"}], ",", "z"}], "]"}], "&"}], ",", 
      RowBox[{
       RowBox[{"f", "//", "DCT"}], "//", "Rest"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverse", "[", 
    RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapDot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseBasis", "[", 
       RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
     RowBox[{"f", "//", "DCT"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverse", "[", 
     RowBox[{"s_", ",", "f_IFun", ",", "z_"}], "]"}], ":=", 
    RowBox[{"MapDot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"CauchyInverseBasis", "[", 
        RowBox[{"s", ",", "f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
      RowBox[{"f", "//", "DCT"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BoundedCauchyInverse", "[", 
     RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
    RowBox[{"MapDot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"IntervalToInnerCircle", "[", 
          RowBox[{"MapToInterval", "[", 
           RowBox[{"f", ",", "z"}], "]"}], "]"}], "^", 
         RowBox[{"(", 
          RowBox[{"#", "-", "1"}], ")"}]}], "/", "2"}], "&"}], ",", 
      RowBox[{"f", "//", "DCT"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`CauchyInversePlus", "[", 
     RowBox[{"f_IFun", ",", "z_"}], "]"}], "/;", 
    RowBox[{"DomainMemberQ", "[", 
     RowBox[{"f", ",", "z"}], "]"}]}], ":=", 
   RowBox[{"f", "[", "z", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInversePlus", "[", 
     RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
    RowBox[{"2", " ", 
     RowBox[{"CauchyInverse", "[", 
      RowBox[{"f", ",", "z"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`HilbertInverse", "[", 
     RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"MapToInterval", "[", 
          RowBox[{"f", ",", "z"}], "]"}], "^", "2"}]}], "]"}]}], " ", 
     RowBox[{"MapDot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ChebyshevU", "[", 
         RowBox[{
          RowBox[{"#", "-", "1"}], ",", 
          RowBox[{"MapToInterval", "[", 
           RowBox[{"f", ",", "z"}], "]"}]}], "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{"f", "//", "DCT"}], "//", "Rest"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`SPCauchyInverseIntegral", "[", 
     RowBox[{"f_IFun", "?", "IntervalFunQ"}], "]"}], ":=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"MapToIntervalD", "[", 
       RowBox[{"f", ",", "0."}], "]"}]], 
     RowBox[{"IFun", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", "2"}], "  ", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"MapOuter", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"#", "\[Equal]", "1"}], ",", "0", ",", 
                RowBox[{"#", "\[Equal]", "2"}], ",", 
                RowBox[{"2", "/", 
                 RowBox[{"(", 
                  RowBox[{"#", "-", "1"}], ")"}]}], ",", "True", ",", 
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"#", "-", "1"}], ")"}]}]}], "]"}], "&"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"DCT", "[", "f", "]"}], "//", "GrowShiftRight"}], 
              ")"}]}], "]"}], "-", 
           RowBox[{"PadRight", "[", 
            RowBox[{
             RowBox[{"MapOuter", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"#", "\[Equal]", "1"}], ",", "0", ",", 
                  RowBox[{"1", "/", 
                   RowBox[{"(", 
                    RowBox[{"#", "-", "1"}], ")"}]}]}], "]"}], "&"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"DCT", "[", "f", "]"}], "//", "GrowShiftLeft"}], 
                ")"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", "f", "]"}], "+", "1"}]}], "]"}]}], 
          ")"}]}], "//", "InverseDCT"}], ",", 
       RowBox[{"Domain", "[", "f", "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`CauchyInverseIntegral", "[", 
     RowBox[{
      RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CauchyInverse", "[", 
      RowBox[{
       RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], ",", "z"}], "]"}], 
     "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"4", " ", 
         RowBox[{"MapToIntervalD", "[", 
          RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
      RowBox[{
       RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], 
      RowBox[{"Log", "[", 
       RowBox[{"IntervalToInnerCircle", "[", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}], "]"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`CauchyInverseIntegralS", "[", 
     RowBox[{
      RowBox[{"s_", "?", "SignQ"}], ",", 
      RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CauchyInverse", "[", 
      RowBox[{"s", ",", 
       RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], ",", "z"}], "]"}], 
     "+", 
     RowBox[{"s", " ", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}], "]"}], 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"4", 
         RowBox[{"MapToIntervalD", "[", 
          RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
      RowBox[{
       RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "  ", "I"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CauchyInverseIntegral", "[", 
      RowBox[{
       RowBox[{"s_", "?", "SignQ"}], ",", 
       RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], "/;", 
     RowBox[{"DomainMemberQ", "[", 
      RowBox[{"f", ",", "z"}], "]"}]}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CauchyInverse", "[", 
      RowBox[{"s", ",", 
       RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], ",", "z"}], "]"}], 
     "+", 
     RowBox[{"s", " ", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}], "]"}], 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"4", 
         RowBox[{"MapToIntervalD", "[", 
          RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
      RowBox[{
       RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "  ", "I"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverseIntegral", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"NZeroQ", "[", 
      RowBox[{"Im", "[", "z", "]"}], "]"}], "&&", 
     RowBox[{
      RowBox[{"Re", "[", "z", "]"}], "\[LessEqual]", 
      RowBox[{"LeftEndpoint", "[", "f", "]"}]}]}]}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CauchyInverse", "[", 
     RowBox[{
      RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], ",", "z"}], "]"}], 
    "-", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", 
        RowBox[{"MapToIntervalD", "[", 
         RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
     RowBox[{
      RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"IntervalToInnerCircle", "[", 
          RowBox[{"MapToInterval", "[", 
           RowBox[{"f", ",", "z"}], "]"}], "]"}], "]"}], "]"}], "-", 
       RowBox[{"s", " ", "I", " ", "\[Pi]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverseIntegral", "[", 
     RowBox[{"_", ",", 
      RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{"CauchyInverseIntegral", "[", 
     RowBox[{"f", ",", "z"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`CauchyInverseIntegralPlus", "[", 
     RowBox[{
      RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], "/;", 
    RowBox[{"DomainMemberQ", "[", 
     RowBox[{"f", ",", "z"}], "]"}]}], ":=", 
   RowBox[{
    RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], "[", "z", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverseIntegralPlus", "[", 
     RowBox[{
      RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"NZeroQ", "[", 
      RowBox[{"Im", "[", "z", "]"}], "]"}], "&&", 
     RowBox[{
      RowBox[{"Re", "[", "z", "]"}], "\[LessEqual]", 
      RowBox[{"LeftEndpoint", "[", "f", "]"}]}]}]}], ":=", 
   RowBox[{
    RowBox[{"CauchyInversePlus", "[", 
     RowBox[{
      RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], ",", "z"}], "]"}], 
    "-", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"MapToIntervalD", "[", 
         RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
     RowBox[{
      RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], 
     RowBox[{"(", 
      RowBox[{"Log", "[", 
       RowBox[{"Abs", "[", 
        RowBox[{"IntervalToInnerCircle", "[", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"f", ",", "z"}], "]"}], "]"}], "]"}], "]"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverseIntegralPlus", "[", 
    RowBox[{
     RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"2", " ", 
    RowBox[{"CauchyInverseIntegral", "[", 
     RowBox[{"f", ",", "z"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrices", "Subsection",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverseMatrix", "[", 
    RowBox[{"s_", ",", "f_IFun"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CauchyInverseBasis", "[", 
         RowBox[{"s", ",", "f", ",", "#", ",", 
          RowBox[{"Points", "[", "f", "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"Length", "[", "f", "]"}]}], "]"}], "]"}], ".", 
    RowBox[{"TransformMatrix", "[", "f", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverseMatrix", "[", 
     RowBox[{"s_", ",", "f_IFun", ",", "g_IFun"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"Domain", "[", "f", "]"}], "\[Equal]", 
     RowBox[{"Domain", "[", "g", "]"}]}]}], ":=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CauchyInverseBasis", "[", 
         RowBox[{"s", ",", "f", ",", "#", ",", 
          RowBox[{"Points", "[", "g", "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"Length", "[", "f", "]"}]}], "]"}], "]"}], ".", 
    RowBox[{"TransformMatrix", "[", "f", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverseMatrix", "[", 
     RowBox[{"_", ",", "f_IFun", ",", "g_IFun"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CauchyInverseBasis", "[", 
          RowBox[{"f", ",", "#", ",", 
           RowBox[{"Points", "[", "g", "]"}]}], "]"}], "&"}], ",", 
        RowBox[{"Length", "[", "f", "]"}]}], "]"}], "]"}], ".", 
     RowBox[{"TransformMatrix", "[", "f", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInversePlusMatrix", "::", "usage"}], "=", 
   "\"\<Returns the matrix corresponding to a list {f,g} f^+ + g^+ + f^- + \
g^-\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInversePlusMatrix", "[", "l_List", "]"}], ":=", 
    RowBox[{"Join", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"RightJoin", "@@", "#"}], ")"}], "&"}], "/@", 
       RowBox[{"MatrixMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            " ", ",", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"Length", "[", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], "]"}], ",", 
            RowBox[{"2", " ", 
             RowBox[{"CauchyInverseMatrix", "[", 
              RowBox[{
               RowBox[{"+", "1"}], ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}]}]}], "]"}], "&"}], ",", 
         RowBox[{"Outer", "[", 
          RowBox[{"List", ",", "l", ",", "l"}], "]"}]}], "]"}]}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`CauchyInverseCurves", "[", "l_List", "]"}], ":=", 
    
    RowBox[{"FromValueList", "[", 
     RowBox[{"l", ",", 
      RowBox[{"LinearSolve", "[", 
       RowBox[{
        RowBox[{"CauchyInversePlusMatrix", "[", "l", "]"}], ",", 
        RowBox[{"l", "//", "ToValueList"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverse", "[", 
    RowBox[{"l_List", ",", "z_"}], "]"}], ":=", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"CauchyInverse", "[", 
        RowBox[{"#", ",", "z"}], "]"}], "&"}], "/@", 
      RowBox[{"CauchyInverseCurves", "[", "l", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverse", "[", 
     RowBox[{"s_", ",", "l_List", ",", "z_"}], "]"}], ":=", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DomainMemberQ", "[", 
           RowBox[{"#", ",", "z"}], "]"}], ",", 
          RowBox[{"CauchyInverse", "[", 
           RowBox[{"s", ",", "#", ",", "z"}], "]"}], ",", 
          RowBox[{"CauchyInverse", "[", 
           RowBox[{"#", ",", "z"}], "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"CauchyInverseCurves", "[", "l", "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "RiemannHilbert`CauchyInverseSeriesAtInfinity", "[", "f_IFun", "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
     "\[RightDoubleBracket]"}], 
    RowBox[{"4", " ", 
     RowBox[{"MapToIntervalSeriesAtInfinity", "[", 
      RowBox[{"f", ",", "1"}], "]"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverseSeriesAtInfinity", "[", "l_List", "]"}], ":=", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CauchyInverseSeriesAtInfinity", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"CauchyInverseCurves", "[", "l", "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverseIntegral", "[", 
    RowBox[{"l_List", ",", "z_"}], "]"}], ":=", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"CauchyInverseIntegral", "[", 
        RowBox[{"#", ",", "z"}], "]"}], "&"}], "/@", 
      RowBox[{"CauchyInverseCurves", "[", "l", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverseIntegral", "[", 
     RowBox[{
      RowBox[{"s_", "?", "SignQ"}], ",", "l_List", ",", "z_"}], "]"}], ":=", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CauchyInverseIntegral", "[", 
         RowBox[{"s", ",", "#", ",", "z"}], "]"}], "&"}], "/@", 
       RowBox[{"CauchyInverseCurves", "[", "l", "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverseIntegralPlus", "[", 
    RowBox[{"l_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"CauchyInverseIntegralPlus", "[", 
        RowBox[{"#", ",", "z"}], "]"}], "&"}], "/@", 
      RowBox[{"CauchyInverseCurves", "[", "l", "]"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell[" Basis D", "Subsection",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RiemannHilbert`CauchyInverseBasisD", "[", 
      RowBox[{"d_", ",", "1", ",", "z_"}], "]"}], ":=", 
     FractionBox[
      RowBox[{"MapToIntervalD", "[", 
       RowBox[{"d", ",", "z"}], "]"}], 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"MapToInterval", "[", 
           RowBox[{"d", ",", "z"}], "]"}]}], ")"}], 
        RowBox[{"3", "/", "2"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"MapToInterval", "[", 
           RowBox[{"d", ",", "z"}], "]"}]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyInverseBasisD", "[", 
      RowBox[{"s_", ",", "d_", ",", "1", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "s", 
      FractionBox[
       RowBox[{"MapToIntervalD", "[", 
        RowBox[{"d", ",", "z"}], "]"}], 
       RowBox[{"2", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"MapToInterval", "[", 
            RowBox[{"d", ",", "z"}], "]"}], "^", "2"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"MapToInterval", "[", 
            RowBox[{"d", ",", "z"}], "]"}], "^", "2"}], "-", "1"}], 
         ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyInverseBasisD", "[", 
      RowBox[{"d_", ",", "k_", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k", "-", "1"}], ")"}], 
      RowBox[{
       RowBox[{
        RowBox[{"IntervalToInnerCircle", "[", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"d", ",", "z"}], "]"}], "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"k", "-", "2"}], ")"}]}], "/", "2"}], 
      RowBox[{
       RowBox[{"IntervalToInnerCircle", "'"}], "[", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"d", ",", "z"}], "]"}], "]"}], " ", 
      RowBox[{"MapToIntervalD", "[", 
       RowBox[{"d", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyInverseBasisD", "[", 
      RowBox[{
       RowBox[{"+", "1"}], ",", "d_", ",", "k_", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k", "-", "1"}], ")"}], 
      RowBox[{
       RowBox[{
        RowBox[{"IntervalToBottomCircle", "[", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"d", ",", "z"}], "]"}], "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"k", "-", "2"}], ")"}]}], "/", "2"}], 
      RowBox[{
       RowBox[{"IntervalToBottomCircle", "'"}], "[", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"d", ",", "z"}], "]"}], "]"}], " ", 
      RowBox[{"MapToIntervalD", "[", 
       RowBox[{"d", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyInverseBasisD", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "d_", ",", "k_", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k", "-", "1"}], ")"}], 
      RowBox[{
       RowBox[{
        RowBox[{"IntervalToTopCircle", "[", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"d", ",", "z"}], "]"}], "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"k", "-", "2"}], ")"}]}], "/", "2"}], 
      RowBox[{
       RowBox[{"IntervalToTopCircle", "'"}], "[", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"d", ",", "z"}], "]"}], "]"}], " ", 
      RowBox[{"MapToIntervalD", "[", 
       RowBox[{"d", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RiemannHilbert`CauchyInverseBasisDomainD", "[", "spc__", "]"}],
       "[", 
      RowBox[{"d_", ",", "1", ",", "z_"}], "]"}], ":=", 
     FractionBox[
      RowBox[{
       RowBox[{"MapToIntervalDomainD", "[", "spc", "]"}], "[", 
       RowBox[{"d", ",", "z"}], "]"}], 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"MapToInterval", "[", 
           RowBox[{"d", ",", "z"}], "]"}]}], ")"}], 
        RowBox[{"3", "/", "2"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"MapToInterval", "[", 
           RowBox[{"d", ",", "z"}], "]"}]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseBasisDomainD", "[", "spc__", "]"}], "[", 
      RowBox[{"s_", ",", "d_", ",", "1", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "s", 
      FractionBox[
       RowBox[{
        RowBox[{"MapToIntervalDomainD", "[", "spc", "]"}], "[", 
        RowBox[{"d", ",", "z"}], "]"}], 
       RowBox[{"2", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"MapToInterval", "[", 
            RowBox[{"d", ",", "z"}], "]"}], "^", "2"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"MapToInterval", "[", 
            RowBox[{"d", ",", "z"}], "]"}], "^", "2"}], "-", "1"}], 
         ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseBasisDomainD", "[", "spc__", "]"}], "[", 
      RowBox[{"d_", ",", "k_", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k", "-", "1"}], ")"}], 
      RowBox[{
       RowBox[{
        RowBox[{"IntervalToInnerCircle", "[", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"d", ",", "z"}], "]"}], "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"k", "-", "2"}], ")"}]}], "/", "2"}], 
      RowBox[{
       RowBox[{"IntervalToInnerCircle", "'"}], "[", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"d", ",", "z"}], "]"}], "]"}], " ", 
      RowBox[{
       RowBox[{"MapToIntervalDomainD", "[", "spc", "]"}], "[", 
       RowBox[{"d", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseBasisDomainD", "[", "spc__", "]"}], "[", 
      RowBox[{
       RowBox[{"+", "1"}], ",", "d_", ",", "k_", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k", "-", "1"}], ")"}], 
      RowBox[{
       RowBox[{
        RowBox[{"IntervalToBottomCircle", "[", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"d", ",", "z"}], "]"}], "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"k", "-", "2"}], ")"}]}], "/", "2"}], 
      RowBox[{
       RowBox[{"IntervalToBottomCircle", "'"}], "[", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"d", ",", "z"}], "]"}], "]"}], " ", 
      RowBox[{
       RowBox[{"MapToIntervalDomainD", "[", "spc", "]"}], "[", 
       RowBox[{"d", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseBasisDomainD", "[", "spc__", "]"}], "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "d_", ",", "k_", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k", "-", "1"}], ")"}], 
      RowBox[{
       RowBox[{
        RowBox[{"IntervalToTopCircle", "[", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"d", ",", "z"}], "]"}], "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"k", "-", "2"}], ")"}]}], "/", "2"}], 
      RowBox[{
       RowBox[{"IntervalToTopCircle", "'"}], "[", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"d", ",", "z"}], "]"}], "]"}], " ", 
      RowBox[{
       RowBox[{"MapToIntervalDomainD", "[", "spc", "]"}], "[", 
       RowBox[{"d", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrices D", "Subsection",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverseMatrixD", "[", 
     RowBox[{
      RowBox[{"{", "spc__", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", 
    RowBox[{"_", ",", "f_IFun", ",", "g_IFun"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"CauchyInverseBasisDomainD", "[", "spc", "]"}], "[", 
         RowBox[{"f", ",", "#", ",", 
          RowBox[{"Points", "[", "g", "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"Length", "[", "f", "]"}]}], "]"}], "]"}], ".", 
    RowBox[{"TransformMatrix", "[", "f", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CauchyInverseMatrixD", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", "spc__", "}"}]}], "]"}], "[", 
     RowBox[{"_", ",", "f_IFun", ",", "g_IFun"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"CauchyInverseBasisD", "[", 
           RowBox[{"f", ",", "#", ",", 
            RowBox[{"Points", "[", "g", "]"}]}], "]"}], 
          RowBox[{
           RowBox[{"PointsD", "[", "spc", "]"}], "[", "g", "]"}]}], "&"}], 
        ",", 
        RowBox[{"Length", "[", "f", "]"}]}], "]"}], "]"}], ".", 
     RowBox[{"TransformMatrix", "[", "f", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CauchyInversePlusMatrixD", "[", "spca__", "]"}], "[", "fl_List",
      "]"}], ":=", 
    RowBox[{"Join", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"RightJoin", "@@", "#"}], ")"}], "&"}], "/@", 
       RowBox[{"MatrixMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            " ", ",", "\[IndentingNewLine]", 
            RowBox[{"ZeroMatrix", "[", 
             RowBox[{"Length", "[", 
              RowBox[{"#", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "\[Equal]", 
             
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "\[Equal]", 
             
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"ZeroMatrix", "[", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
              ",", 
              RowBox[{"Length", "[", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
             "]"}], ",", "\[IndentingNewLine]", "True", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"CauchyInverseMatrixD", "[", 
               RowBox[{
                RowBox[{"#", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"#", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], 
              "[", 
              RowBox[{
               RowBox[{"+", "1"}], ",", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
         RowBox[{"Outer", "[", 
          RowBox[{"List", ",", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"fl", ",", 
              RowBox[{"{", "spca", "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"fl", ",", 
              RowBox[{"{", "spca", "}"}]}], "}"}], "]"}], ",", "1"}], "]"}]}],
         "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`CauchyInverseCurvesD", "[", "spc__", "]"}], "[", 
    "l_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "plusmatin", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plusmatin", "=", 
       RowBox[{
        RowBox[{"CauchyInversePlusMatrix", "[", "l", "]"}], "//", 
        "Inverse"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"FromValueList", "[", 
       RowBox[{"l", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"plusmatin", ".", 
           RowBox[{
            RowBox[{"CauchyInversePlusMatrixD", "[", "spc", "]"}], "[", "l", 
            "]"}], ".", "plusmatin", ".", 
           RowBox[{"(", 
            RowBox[{"l", "//", "ToValueList"}], ")"}]}]}], "+", 
         RowBox[{"plusmatin", ".", 
          RowBox[{
           RowBox[{"ToValueListD", "[", "spc", "]"}], "[", "l", "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fucntions Domain D", "Subsection",
 InitializationCell->True],

Cell[BoxData[""], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseDomainGrad", "[", "spc__", "]"}], "[", 
      RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
     RowBox[{"MapDot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"CauchyInverseBasisDomainD", "[", "spc", "]"}], "[", 
         RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
       RowBox[{"f", "//", "DCT"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseDomainGrad", "[", "spc__", "]"}], "[", 
      RowBox[{"s_", ",", "f_IFun", ",", "z_"}], "]"}], ":=", 
     RowBox[{"MapDot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"CauchyInverseBasisDomainD", "[", "spc", "]"}], "[", 
         RowBox[{"s", ",", "f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
       RowBox[{"f", "//", "DCT"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseDomainD", "[", "spc__", "]"}], "[", 
      RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"CauchyInverseDomainGrad", "[", "spc", "]"}], "[", 
       RowBox[{"f", ",", "z"}], "]"}], "+", 
      RowBox[{"MapDot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CauchyInverseBasis", "[", 
          RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ValuesDomainD", "[", "spc", "]"}], "[", "f", "]"}], "//", 
         "DCT"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseDomainD", "[", "spc__", "]"}], "[", 
      RowBox[{"s_", ",", "f_IFun", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"CauchyInverseDomainGrad", "[", "spc", "]"}], "[", 
       RowBox[{"s", ",", "f", ",", "z"}], "]"}], "+", 
      RowBox[{"MapDot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CauchyInverseBasis", "[", 
          RowBox[{"s", ",", "f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ValuesDomainD", "[", "spc", "]"}], "[", "f", "]"}], "//", 
         "DCT"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "RiemannHilbert`CauchyInverseSeriesAtInfinityDomainD", "[", "spc__", 
       "]"}], "[", "f_IFun", "]"}], ":=", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"DCT", "[", 
         RowBox[{
          RowBox[{"ValuesDomainD", "[", "spc", "]"}], "[", "f", "]"}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       RowBox[{"4", " ", 
        RowBox[{"MapToIntervalSeriesAtInfinity", "[", 
         RowBox[{"f", ",", "1"}], "]"}]}]], "-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], " ", 
        RowBox[{
         RowBox[{"MapToIntervalSeriesAtInfinityD", "[", "spc", "]"}], "[", 
         RowBox[{"f", ",", "1"}], "]"}]}], 
       RowBox[{"4", " ", 
        RowBox[{
         RowBox[{"MapToIntervalSeriesAtInfinity", "[", 
          RowBox[{"f", ",", "1"}], "]"}], "^", "2"}]}]]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyInverseSeriesAtInfinityValuesD", "[", "f_IFun", "]"}], ":=", 
     FractionBox[
      RowBox[{
       RowBox[{"TransformMatrix", "[", "f", "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "All"}], "\[RightDoubleBracket]"}], 
      RowBox[{"4", " ", 
       RowBox[{"MapToIntervalSeriesAtInfinity", "[", 
        RowBox[{"f", ",", "1"}], "]"}]}]]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "RiemannHilbert`CauchyInverseSeriesAtInfinityD", "[", "spc__", "]"}], 
      "[", "fl_List", "]"}], ":=", 
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"DCT", "[", "#", "]"}], "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "/", 
            RowBox[{"(", 
             RowBox[{"4", " ", 
              RowBox[{"MapToIntervalSeriesAtInfinity", "[", 
               RowBox[{"#", ",", "1"}], "]"}]}], ")"}]}], "&"}], "/@", 
          RowBox[{
           RowBox[{"CauchyInverseCurvesD", "[", "spc", "]"}], "[", "fl", 
           "]"}]}], ")"}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "\[Equal]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", "0", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"DCT", "[", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              RowBox[{
               RowBox[{
                RowBox[{"MapToIntervalSeriesAtInfinityD", "[", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}], "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", "1"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{"4", " ", 
                 RowBox[{
                  RowBox[{"MapToIntervalSeriesAtInfinity", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "1"}], "]"}], "^", 
                  "2"}]}], ")"}]}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"CauchyInverseCurves", "[", "fl", "]"}], ",", 
             RowBox[{"{", "spc", "}"}]}], "}"}], "]"}]}], ")"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "RiemannHilbert`SPCauchyInverseIntegralDomainGrad", "[", "spc__", "]"}],
       "[", "f_", "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"MapToIntervalDDomainD", "[", "spc", "]"}], "[", 
         RowBox[{"f", ",", "0."}], "]"}], 
        RowBox[{
         RowBox[{"MapToIntervalD", "[", 
          RowBox[{"f", ",", "0."}], "]"}], "^", "2"}]]}], 
      RowBox[{"IFun", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "2"}], "  ", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"MapOuter", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"#", "\[Equal]", "1"}], ",", "0", ",", 
                 RowBox[{"#", "\[Equal]", "2"}], ",", 
                 RowBox[{"2", "/", 
                  RowBox[{"(", 
                   RowBox[{"#", "-", "1"}], ")"}]}], ",", "True", ",", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"#", "-", "1"}], ")"}]}]}], "]"}], "&"}], ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"DCT", "[", "f", "]"}], "//", "ShiftRight"}], ")"}]}],
              "]"}], "-", 
            RowBox[{"MapOuter", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", "\[Equal]", "1"}], ",", "0", ",", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"#", "-", "1"}], ")"}]}]}], "]"}], "&"}], ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"DCT", "[", "f", "]"}], "//", "GrowShiftLeft"}], 
               ")"}]}], "]"}]}], ")"}]}], "//", "InverseDCT"}], ",", 
        RowBox[{"Domain", "[", "f", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SPCauchyInverseIntegralDomainD", "[", "spc__", "]"}], "[", 
      "f_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"SPCauchyInverseIntegralDomainGrad", "[", "spc", "]"}], "[", 
       "f", "]"}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"MapToIntervalD", "[", 
         RowBox[{"f", ",", "0."}], "]"}]], 
       RowBox[{"IFun", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "2"}], "  ", 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"MapOuter", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{"#", "\[Equal]", "1"}], ",", "0", ",", 
                  RowBox[{"#", "\[Equal]", "2"}], ",", 
                  RowBox[{"2", "/", 
                   RowBox[{"(", 
                    RowBox[{"#", "-", "1"}], ")"}]}], ",", "True", ",", 
                  RowBox[{"1", "/", 
                   RowBox[{"(", 
                    RowBox[{"#", "-", "1"}], ")"}]}]}], "]"}], "&"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"DCT", "[", 
                  RowBox[{
                   RowBox[{"ValuesDomainD", "[", "spc", "]"}], "[", "f", 
                   "]"}], "]"}], "//", "ShiftRight"}], ")"}]}], "]"}], "-", 
             RowBox[{"MapOuter", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"#", "\[Equal]", "1"}], ",", "0", ",", 
                  RowBox[{"1", "/", 
                   RowBox[{"(", 
                    RowBox[{"#", "-", "1"}], ")"}]}]}], "]"}], "&"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"DCT", "[", 
                  RowBox[{
                   RowBox[{"ValuesDomainD", "[", "spc", "]"}], "[", "f", 
                   "]"}], "]"}], "//", "GrowShiftLeft"}], ")"}]}], "]"}]}], 
            ")"}]}], "//", "InverseDCT"}], ",", 
         RowBox[{"Domain", "[", "f", "]"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SPCauchyInverseIntegralValuesD", "[", 
      RowBox[{"f_IFun", "?", "IntervalFunQ"}], "]"}], ":=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"MapToIntervalD", "[", 
        RowBox[{"f", ",", "0."}], "]"}]], 
      RowBox[{
       RowBox[{"Inverse", "[", 
        RowBox[{"TransformMatrix", "[", "f", "]"}], "]"}], ".", 
       RowBox[{"ColumnMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", 
            RowBox[{"MapOuter", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"#", "\[Equal]", "1"}], ",", "0", ",", 
                 RowBox[{"#", "\[Equal]", "2"}], ",", 
                 RowBox[{"2", "/", 
                  RowBox[{"(", 
                   RowBox[{"#", "-", "1"}], ")"}]}], ",", "True", ",", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"#", "-", "1"}], ")"}]}]}], "]"}], "&"}], ",", 
              RowBox[{"(", 
               RowBox[{"#", "//", "ShiftRight"}], ")"}]}], "]"}]}], "-", 
           RowBox[{"MapOuter", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", "\[Equal]", "1"}], ",", "0", ",", 
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"#", "-", "1"}], ")"}]}]}], "]"}], "&"}], ",", 
             RowBox[{"(", 
              RowBox[{"#", "//", "GrowShiftLeft"}], ")"}]}], "]"}]}], "&"}], 
         ",", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"f", "//", "Length"}], "]"}]}], "]"}], ".", 
       RowBox[{"TransformMatrix", "[", "f", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseIntegralDomainGrad", "[", "spc__", "]"}], "[", 
      RowBox[{
       RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"MapDot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"CauchyInverseBasisDomainD", "[", "spc", "]"}], "[", 
          RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], "//", "DCT"}]}], 
       "]"}], "+", 
      RowBox[{"MapDot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CauchyInverseBasis", "[", 
          RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"SPCauchyInverseIntegralDomainGrad", "[", "spc", "]"}], "[",
           "f", "]"}], "//", "DCT"}]}], "]"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"MapToIntervalDDomainD", "[", "spc", "]"}], "[", 
            RowBox[{"f", ",", "0."}], "]"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"4", " ", 
            RowBox[{
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", "0."}], "]"}], "^", "2"}]}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], 
         RowBox[{"Log", "[", 
          RowBox[{"IntervalToInnerCircle", "[", 
           RowBox[{"MapToInterval", "[", 
            RowBox[{"f", ",", "z"}], "]"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"4", " ", 
            RowBox[{"MapToIntervalD", "[", 
             RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], 
         RowBox[{
          RowBox[{"IntervalToInnerCircle", "'"}], "[", 
          RowBox[{"MapToInterval", "[", 
           RowBox[{"f", ",", "z"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{
           RowBox[{"MapToIntervalDomainD", "[", "spc", "]"}], "[", 
           RowBox[{"f", ",", "z"}], "]"}], "/", 
          RowBox[{"IntervalToInnerCircle", "[", 
           RowBox[{"MapToInterval", "[", 
            RowBox[{"f", ",", "z"}], "]"}], "]"}]}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseIntegralDomainD", "[", "spc__", "]"}], "[", 
      RowBox[{
       RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"MapDot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"CauchyInverseBasisDomainD", "[", "spc", "]"}], "[", 
          RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], "//", "DCT"}]}], 
       "]"}], "+", 
      RowBox[{"MapDot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CauchyInverseBasis", "[", 
          RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"SPCauchyInverseIntegralDomainD", "[", "spc", "]"}], "[", 
          "f", "]"}], "//", "DCT"}]}], "]"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"MapToIntervalDDomainD", "[", "spc", "]"}], "[", 
            RowBox[{"f", ",", "0."}], "]"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"4", " ", 
            RowBox[{
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", "0."}], "]"}], "^", "2"}]}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], 
         RowBox[{"Log", "[", 
          RowBox[{"IntervalToInnerCircle", "[", 
           RowBox[{"MapToInterval", "[", 
            RowBox[{"f", ",", "z"}], "]"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"4", " ", 
            RowBox[{"MapToIntervalD", "[", 
             RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"DCT", "[", 
           RowBox[{
            RowBox[{"ValuesDomainD", "[", "spc", "]"}], "[", "f", "]"}], 
           "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         RowBox[{"Log", "[", 
          RowBox[{"IntervalToInnerCircle", "[", 
           RowBox[{"MapToInterval", "[", 
            RowBox[{"f", ",", "z"}], "]"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"4", " ", 
            RowBox[{"MapToIntervalD", "[", 
             RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], 
         RowBox[{
          RowBox[{"IntervalToInnerCircle", "'"}], "[", 
          RowBox[{"MapToInterval", "[", 
           RowBox[{"f", ",", "z"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{
           RowBox[{"MapToIntervalDomainD", "[", "spc", "]"}], "[", 
           RowBox[{"f", ",", "z"}], "]"}], "/", 
          RowBox[{"IntervalToInnerCircle", "[", 
           RowBox[{"MapToInterval", "[", 
            RowBox[{"f", ",", "z"}], "]"}], "]"}]}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"CauchyInverseIntegralDomainD", "[", "spc__", "]"}], "[", 
       RowBox[{
        RowBox[{"s_", "?", "SignQ"}], ",", 
        RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], "/;", 
      RowBox[{"DomainMemberQ", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], ":=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MapDot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"CauchyInverseBasisDomainD", "[", "spc", "]"}], "[", 
          RowBox[{"s", ",", "f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], "//", "DCT"}]}], 
       "]"}], "+", 
      RowBox[{"MapDot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CauchyInverseBasis", "[", 
          RowBox[{"s", ",", "f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"SPCauchyInverseIntegralDomainD", "[", "spc", "]"}], "[", 
          "f", "]"}], "//", "DCT"}]}], "]"}], "+", 
      RowBox[{"s", " ", 
       RowBox[{
        RowBox[{"ArcCos", "'"}], "[", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"MapToIntervalDomainD", "[", "spc", "]"}], "[", 
        RowBox[{"f", ",", "z"}], "]"}], 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"4", 
          RowBox[{"MapToIntervalD", "[", 
           RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
       RowBox[{
        RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], "  ", "I"}], "-", 
      RowBox[{"s", " ", 
       RowBox[{"ArcCos", "[", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}], "]"}], 
       RowBox[{
        RowBox[{
         RowBox[{"MapToIntervalDDomainD", "[", "spc", "]"}], "[", 
         RowBox[{"f", ",", "0."}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"4", 
          RowBox[{
           RowBox[{"MapToIntervalD", "[", 
            RowBox[{"f", ",", "0."}], "]"}], "^", "2"}]}], ")"}]}], " ", 
       RowBox[{
        RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], "  ", "I"}], "+", 
      RowBox[{"s", " ", 
       RowBox[{"ArcCos", "[", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}], "]"}], 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"4", 
          RowBox[{"MapToIntervalD", "[", 
           RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
       RowBox[{
        RowBox[{"DCT", "[", 
         RowBox[{
          RowBox[{"ValuesDomainD", "[", "spc", "]"}], "[", "f", "]"}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "  ", 
       "I"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"CauchyInverseIntegralDomainD", "[", "spc__", "]"}], "[", 
       RowBox[{"s_", ",", 
        RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"NZeroQ", "[", 
        RowBox[{"Im", "[", "z", "]"}], "]"}], "&&", 
       RowBox[{
        RowBox[{"Re", "[", "z", "]"}], "\[LessEqual]", 
        RowBox[{"LeftEndpoint", "[", "f", "]"}]}]}]}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MapDot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"CauchyInverseBasisDomainD", "[", "spc", "]"}], "[", 
          RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], "//", "DCT"}]}], 
       "]"}], "+", 
      RowBox[{"MapDot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CauchyInverseBasis", "[", 
          RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"SPCauchyInverseIntegralDomainD", "[", "spc", "]"}], "[", 
          "f", "]"}], "//", "DCT"}]}], "]"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"MapToIntervalDDomainD", "[", "spc", "]"}], "[", 
            RowBox[{"f", ",", "0."}], "]"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"4", " ", 
            RowBox[{
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", "0."}], "]"}], "^", "2"}]}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{"IntervalToInnerCircle", "[", 
              RowBox[{"MapToInterval", "[", 
               RowBox[{"f", ",", "z"}], "]"}], "]"}], "]"}], "]"}], "-", 
           RowBox[{"s", " ", "I", " ", "\[Pi]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"4", " ", 
            RowBox[{"MapToIntervalD", "[", 
             RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"DCT", "[", 
           RowBox[{
            RowBox[{"ValuesDomainD", "[", "spc", "]"}], "[", "f", "]"}], 
           "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{"IntervalToInnerCircle", "[", 
              RowBox[{"MapToInterval", "[", 
               RowBox[{"f", ",", "z"}], "]"}], "]"}], "]"}], "]"}], "-", 
           RowBox[{"s", " ", "I", " ", "\[Pi]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"4", " ", 
            RowBox[{"MapToIntervalD", "[", 
             RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"IntervalToInnerCircle", "'"}], "[", 
            RowBox[{"MapToInterval", "[", 
             RowBox[{"f", ",", "z"}], "]"}], "]"}], 
           RowBox[{
            RowBox[{
             RowBox[{"MapToIntervalDomainD", "[", "spc", "]"}], "[", 
             RowBox[{"f", ",", "z"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"IntervalToInnerCircle", "[", 
              RowBox[{"MapToInterval", "[", 
               RowBox[{"f", ",", "z"}], "]"}], "]"}], ")"}]}]}], ")"}]}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseIntegralDomainD", "[", "spc__", "]"}], "[", 
      RowBox[{"_", ",", 
       RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"CauchyInverseIntegralDomainD", "[", "spc", "]"}], "[", 
      RowBox[{"f", ",", "z"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "RiemannHilbert`CauchyInverseIntegralPlusDomainGrad", "[", "spc__", 
        "]"}], "[", 
       RowBox[{
        RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], "/;", 
      RowBox[{"DomainMemberQ", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"SPCauchyInverseIntegralDomainGrad", "[", "spc", "]"}], "[", 
       "f", "]"}], "[", "z", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"CauchyInverseIntegralPlusDomainGrad", "[", "spc__", "]"}], 
       "[", 
       RowBox[{
        RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"NZeroQ", "[", 
        RowBox[{"Im", "[", "z", "]"}], "]"}], "&&", 
       RowBox[{
        RowBox[{"Re", "[", "z", "]"}], "\[LessEqual]", 
        RowBox[{"LeftEndpoint", "[", "f", "]"}]}]}]}], ":=", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MapDot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"CauchyInverseBasisDomainD", "[", "spc", "]"}], "[", 
             RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
           RowBox[{
            RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], "//", 
            "DCT"}]}], "]"}], "+", 
         RowBox[{"MapDot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"CauchyInverseBasis", "[", 
             RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"SPCauchyInverseIntegralDomainGrad", "[", "spc", "]"}], 
             "[", "f", "]"}], "//", "DCT"}]}], "]"}]}], ")"}]}], "-", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"MapToIntervalDDomainD", "[", "spc", "]"}], "[", 
            RowBox[{"f", ",", "0."}], "]"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", "0."}], "]"}], "^", "2"}]}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], 
         RowBox[{"(", 
          RowBox[{"Log", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{"IntervalToInnerCircle", "[", 
             RowBox[{"MapToInterval", "[", 
              RowBox[{"f", ",", "z"}], "]"}], "]"}], "]"}], "]"}], ")"}]}], 
        "+", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", 
            RowBox[{"MapToIntervalD", "[", 
             RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"IntervalToInnerCircle", "'"}], "[", 
            RowBox[{"MapToInterval", "[", 
             RowBox[{"f", ",", "z"}], "]"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"MapToIntervalDomainD", "[", "spc", "]"}], "[", 
             RowBox[{"f", ",", "z"}], "]"}], "/", 
            RowBox[{"IntervalToInnerCircle", "[", 
             RowBox[{"MapToInterval", "[", 
              RowBox[{"f", ",", "z"}], "]"}], "]"}]}]}], ")"}]}]}], 
       "\[IndentingNewLine]", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseIntegralPlusDomainGrad", "[", "spc__", "]"}], "[", 
      RowBox[{
       RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"CauchyInverseIntegralDomainGrad", "[", "spc", "]"}], "[", 
       RowBox[{"f", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseIntegralPlus", "[", 
       RowBox[{
        RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"NZeroQ", "[", 
        RowBox[{"Im", "[", "z", "]"}], "]"}], "&&", 
       RowBox[{
        RowBox[{"Re", "[", "z", "]"}], "\[LessEqual]", 
        RowBox[{"LeftEndpoint", "[", "f", "]"}]}]}]}], ":=", 
     RowBox[{
      RowBox[{"CauchyInversePlus", "[", 
       RowBox[{
        RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], ",", "z"}], "]"}],
       "-", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", 
          RowBox[{"MapToIntervalD", "[", 
           RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
       RowBox[{
        RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], 
       RowBox[{"(", 
        RowBox[{"Log", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{"IntervalToInnerCircle", "[", 
           RowBox[{"MapToInterval", "[", 
            RowBox[{"f", ",", "z"}], "]"}], "]"}], "]"}], "]"}], ")"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyInverseIntegralPlus", "[", 
      RowBox[{
       RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{"2", " ", 
      RowBox[{"CauchyInverseIntegral", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "RiemannHilbert`CauchyInverseIntegralPlusDomainD", "[", "spc__", "]"}],
        "[", 
       RowBox[{
        RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], "/;", 
      RowBox[{"DomainMemberQ", "[", 
       RowBox[{"f", ",", "z"}], "]"}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"CauchyInverseIntegralPlusDomainGrad", "[", "spc", "]"}], "[", 
       
       RowBox[{"f", ",", "z"}], "]"}], "+", 
      RowBox[{
       RowBox[{"BaryDomainD", "[", "spc", "]"}], "[", 
       RowBox[{
        RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], ",", "z"}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"CauchyInverseIntegralPlusDomainD", "[", "spc__", "]"}], "[", 
       RowBox[{
        RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"NZeroQ", "[", 
        RowBox[{"Im", "[", "z", "]"}], "]"}], "&&", 
       RowBox[{
        RowBox[{"Re", "[", "z", "]"}], "\[LessEqual]", 
        RowBox[{"LeftEndpoint", "[", "f", "]"}]}]}]}], ":=", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MapDot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"CauchyInverseBasisDomainD", "[", "spc", "]"}], "[", 
             RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
           RowBox[{
            RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], "//", 
            "DCT"}]}], "]"}], "+", 
         RowBox[{"MapDot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"CauchyInverseBasis", "[", 
             RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"SPCauchyInverseIntegralDomainD", "[", "spc", "]"}], "[",
              "f", "]"}], "//", "DCT"}]}], "]"}]}], ")"}]}], "-", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"MapToIntervalDDomainD", "[", "spc", "]"}], "[", 
            RowBox[{"f", ",", "0."}], "]"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"MapToIntervalD", "[", 
              RowBox[{"f", ",", "0."}], "]"}], "^", "2"}]}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], 
         RowBox[{"(", 
          RowBox[{"Log", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{"IntervalToInnerCircle", "[", 
             RowBox[{"MapToInterval", "[", 
              RowBox[{"f", ",", "z"}], "]"}], "]"}], "]"}], "]"}], ")"}]}], 
        "+", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", 
            RowBox[{"MapToIntervalD", "[", 
             RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"DCT", "[", 
           RowBox[{
            RowBox[{"ValuesDomainD", "[", "spc", "]"}], "[", "f", "]"}], 
           "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         RowBox[{"(", 
          RowBox[{"Log", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{"IntervalToInnerCircle", "[", 
             RowBox[{"MapToInterval", "[", 
              RowBox[{"f", ",", "z"}], "]"}], "]"}], "]"}], "]"}], ")"}]}], 
        "+", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", 
            RowBox[{"MapToIntervalD", "[", 
             RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"IntervalToInnerCircle", "'"}], "[", 
            RowBox[{"MapToInterval", "[", 
             RowBox[{"f", ",", "z"}], "]"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"MapToIntervalDomainD", "[", "spc", "]"}], "[", 
             RowBox[{"f", ",", "z"}], "]"}], "/", 
            RowBox[{"IntervalToInnerCircle", "[", 
             RowBox[{"MapToInterval", "[", 
              RowBox[{"f", ",", "z"}], "]"}], "]"}]}]}], ")"}]}]}], 
       "\[IndentingNewLine]", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseIntegralPlusDomainD", "[", "spc__", "]"}], "[", 
      RowBox[{
       RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], ":=", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"CauchyInverseIntegralDomainD", "[", "spc", "]"}], "[", 
       RowBox[{"f", ",", "z"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fucntions  D", "Subsection",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverseD", "[", 
    RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapDot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseBasisD", "[", 
       RowBox[{"f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
     RowBox[{"f", "//", "DCT"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverseD", "[", 
    RowBox[{"s_", ",", "f_IFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"MapDot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CauchyInverseBasisD", "[", 
       RowBox[{"s", ",", "f", ",", "#", ",", "z"}], "]"}], "&"}], ",", 
     RowBox[{"f", "//", "DCT"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInversePlusD", "[", 
    RowBox[{"f_IFun", ",", "z_"}], "]"}], ":=", 
   RowBox[{"2", " ", 
    RowBox[{"CauchyInverseD", "[", 
     RowBox[{"f", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CauchyInversePlusD", "[", 
      RowBox[{"f_IFun", ",", "z_"}], "]"}], "/;", 
     RowBox[{"DomainMemberQ", "[", 
      RowBox[{"f", ",", "z"}], "]"}]}], ":=", 
    RowBox[{
     RowBox[{"f", "'"}], "[", "z", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverseIntegralD", "[", 
     RowBox[{
      RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CauchyInverseD", "[", 
      RowBox[{
       RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], ",", "z"}], "]"}], 
     "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"4", " ", 
         RowBox[{"MapToIntervalD", "[", 
          RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
      RowBox[{
       RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], 
      RowBox[{
       RowBox[{"IntervalToInnerCircle", "'"}], "[", 
       RowBox[{"MapToInterval", "[", 
        RowBox[{"f", ",", "z"}], "]"}], "]"}], 
      RowBox[{
       RowBox[{"MapToIntervalD", "[", 
        RowBox[{"f", ",", "z"}], "]"}], "/", 
       RowBox[{"IntervalToInnerCircle", "[", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}], "]"}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`CauchyInverseIntegralPlusD", "[", 
     RowBox[{
      RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], "/;", 
    RowBox[{"DomainMemberQ", "[", 
     RowBox[{"f", ",", "z"}], "]"}]}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], "'"}], "[", "z", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverseIntegralPlusD", "[", 
     RowBox[{
      RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"NZeroQ", "[", 
      RowBox[{"Im", "[", "z", "]"}], "]"}], "&&", 
     RowBox[{
      RowBox[{"Re", "[", "z", "]"}], "\[LessEqual]", 
      RowBox[{"LeftEndpoint", "[", "f", "]"}]}]}]}], ":=", 
   RowBox[{
    RowBox[{"CauchyInversePlusD", "[", 
     RowBox[{
      RowBox[{"SPCauchyInverseIntegral", "[", "f", "]"}], ",", "z"}], "]"}], 
    "-", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"MapToIntervalD", "[", 
         RowBox[{"f", ",", "0."}], "]"}]}], ")"}]}], " ", 
     RowBox[{
      RowBox[{"DCT", "[", "f", "]"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"IntervalToInnerCircle", "'"}], "[", 
        RowBox[{"MapToInterval", "[", 
         RowBox[{"f", ",", "z"}], "]"}], "]"}], 
       RowBox[{
        RowBox[{"MapToIntervalD", "[", 
         RowBox[{"f", ",", "z"}], "]"}], "/", 
        RowBox[{"IntervalToInnerCircle", "[", 
         RowBox[{"MapToInterval", "[", 
          RowBox[{"f", ",", "z"}], "]"}], "]"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyInverseIntegralPlusD", "[", 
     RowBox[{
      RowBox[{"f_IFun", "?", "IntervalFunQ"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{"2", " ", 
     RowBox[{"CauchyInverseIntegralD", "[", 
      RowBox[{"f", ",", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CauchyInverseIntegralPlusD", "[", 
    RowBox[{"l_List", ",", "z_"}], "]"}], ":=", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"CauchyInverseIntegralPlusD", "[", 
        RowBox[{"#", ",", "z"}], "]"}], "&"}], "/@", 
      RowBox[{"CauchyInverseCurves", "[", "l", "]"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["List", "Subsection",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CauchyInverseIntegralPlusDomainD", "[", "spc__", "]"}], "[", 
     RowBox[{"fl_List", ",", "z_"}], "]"}], ":=", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"DomainMemberQ", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
              "z"}], "]"}], "&&", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
            "\[Equal]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SPCauchyInverseIntegral", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}], "[", "z", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"DomainMemberQ", "[", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            "z"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"SPCauchyInverseIntegralDomainGrad", "[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
              "]"}], "[", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}], "[", "z", "]"}], "+", 
           RowBox[{
            RowBox[{"SPCauchyInverseIntegral", "[", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], "[", "z", "]"}], "+", 
           RowBox[{
            RowBox[{"BaryDomainD", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
             "]"}], "[", 
            RowBox[{
             RowBox[{"SPCauchyInverseIntegral", "[", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], ",", "z"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
           "\[Equal]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"CauchyInverseIntegralPlus", "[", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            "z"}], "]"}], ",", "\[IndentingNewLine]", "True", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"CauchyInverseIntegralPlusDomainGrad", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
             "]"}], "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
              "z"}], "]"}], "+", 
           RowBox[{"CauchyInverseIntegralPlus", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",",
              "z"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"CauchyInverseCurves", "[", "fl", "]"}], ",", 
          RowBox[{
           RowBox[{"CauchyInverseCurvesD", "[", "spc", "]"}], "[", "fl", 
           "]"}], ",", 
          RowBox[{"{", "spc", "}"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
      ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Fredholm Det", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`FredholmDet", "[", 
    RowBox[{"K_", ",", "a_", ",", "b_", ",", "m_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "w"}], "}"}], "=", 
       RowBox[{
        RowBox[{"GaussianQuadratureWeights", "[", 
         RowBox[{"m", ",", "a", ",", "b"}], "]"}], "//", "Thread"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w", "=", 
       RowBox[{"Sqrt", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Det", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "m", "]"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", "w", "}"}], "]"}], ".", 
           RowBox[{"{", "w", "}"}]}], ")"}], 
         RowBox[{"Outer", "[", 
          RowBox[{"K", ",", "x", ",", "x"}], "]"}]}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FredholmDet", "[", 
    RowBox[{"K_", ",", "a_", ",", "\[Infinity]", ",", "m_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ks", ",", "x", ",", "w", ",", "\[Phi]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", "s_", "]"}], "[", "x_", "]"}], ":=", 
       RowBox[{"s", "+", 
        RowBox[{"10", " ", 
         RowBox[{"Tan", "[", 
          RowBox[{"\[Pi]", " ", 
           RowBox[{"x", "/", "2"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Ks", "[", "s_", "]"}], "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]", "[", "s", "]"}], "'"}], "[", "x", "]"}], 
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]", "[", "s", "]"}], "'"}], "[", "y", "]"}]}], 
         "]"}], " ", 
        RowBox[{"K", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]", "[", "s", "]"}], "[", "x", "]"}], ",", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "s", "]"}], "[", "y", "]"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "w"}], "}"}], "=", 
       RowBox[{
        RowBox[{"GaussianQuadratureWeights", "[", 
         RowBox[{"m", ",", "0", ",", "1"}], "]"}], "//", "Thread"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w", "=", 
       RowBox[{"Sqrt", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "m", "]"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", "w", "}"}], "]"}], ".", 
           RowBox[{"{", "w", "}"}]}], ")"}], 
         RowBox[{"Outer", "[", 
          RowBox[{
           RowBox[{"Ks", "[", "a", "]"}], ",", "x", ",", "x"}], "]"}]}]}], "//",
        "Det"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Parametrices", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`DiagonalMatrixQ", "[", "DD_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{"DD", "-", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Diagonal", "[", "DD", "]"}], "]"}]}], "]"}], "\[Equal]", 
     "0"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`Parametrix", "[", 
    RowBox[{
     RowBox[{"DD_", "?", "DiagonalMatrixQ"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}]}], "}"}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "z"}]}], 
          RowBox[{
           RowBox[{"2", "z"}], " ", "-", "1"}]], ")"}], 
        RowBox[{
         FractionBox["I", 
          RowBox[{"2", " ", "\[Pi]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{"DD", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
            "]"}], "+", " ", 
           RowBox[{"I", " ", 
            RowBox[{"(", 
             RowBox[{"Arg", "[", 
              RowBox[{"DD", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
             ")"}]}]}], ")"}]}]], "0"},
      {"0", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "z"}]}], 
          RowBox[{
           RowBox[{"2", "z"}], " ", "-", "1"}]], ")"}], 
        RowBox[{
         FractionBox["I", 
          RowBox[{"2", " ", "\[Pi]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{"DD", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
            "]"}], "+", " ", 
           RowBox[{"I", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"Arg", "[", 
               RowBox[{"DD", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], "//", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", ">", "0"}], ",", 
                 RowBox[{"#", "-", 
                  RowBox[{"2", " ", "\[Pi]"}]}], ",", "#"}], "]"}], "&"}]}], 
             ")"}]}]}], ")"}]}]]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RiemannHilbert`ParametrixBranch", "[", 
     RowBox[{
      RowBox[{"DD_", "?", "DiagonalMatrixQ"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], ",", 
         RowBox[{"1", "/", "2"}]}], "}"}], "]"}], ",", "z_", ",", "t_"}], 
     "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"PowerBranch", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "z"}]}], 
           RowBox[{
            RowBox[{"2", "z"}], " ", "-", "1"}]], ",", 
          RowBox[{
           FractionBox["I", 
            RowBox[{"2", " ", "\[Pi]"}]], 
           RowBox[{"Log", "[", 
            RowBox[{"DD", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], ",",
           "t"}], "]"}], "0"},
       {"0", 
        RowBox[{"PowerBranch", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "z"}]}], 
           RowBox[{
            RowBox[{"2", "z"}], " ", "-", "1"}]], ",", 
          RowBox[{
           FractionBox["I", 
            RowBox[{"2", " ", "\[Pi]"}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{"DD", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
              "]"}], "+", " ", 
             RowBox[{"I", 
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"Arg", "[", 
                 RowBox[{"DD", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], "//", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"#", ">", "0"}], ",", 
                   RowBox[{"#", "-", 
                    RowBox[{"2", " ", "\[Pi]"}]}], ",", "#"}], "]"}], "&"}]}],
                ")"}]}]}], ")"}]}], ",", "t"}], "]"}]}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`ParametrixBranch", "[", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {"0", "1"},
        {
         RowBox[{"-", "1"}], "0"}
       }], ")"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "z_", ",", "t_"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Beta]", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]", "[", "p_", "]"}], ":=", 
       RowBox[{"PowerBranch", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"z", "-", "a"}], 
          RowBox[{"z", "-", "b"}]], ",", 
         RowBox[{"1", "/", "4"}], ",", "t"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(", GridBox[{
         {
          FractionBox[
           RowBox[{
            RowBox[{"\[Beta]", "[", "z", "]"}], "+", 
            RowBox[{"1", "/", 
             RowBox[{"\[Beta]", "[", "z", "]"}]}]}], "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"\[Beta]", "[", "z", "]"}], "-", 
            RowBox[{"1", "/", 
             RowBox[{"\[Beta]", "[", "z", "]"}]}]}], 
           RowBox[{"2", " ", "I"}]]},
         {
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"\[Beta]", "[", "z", "]"}], "-", 
             RowBox[{"1", "/", 
              RowBox[{"\[Beta]", "[", "z", "]"}]}]}], 
            RowBox[{"2", "I"}]]}], 
          FractionBox[
           RowBox[{
            RowBox[{"\[Beta]", "[", "z", "]"}], "+", 
            RowBox[{"1", "/", 
             RowBox[{"\[Beta]", "[", "z", "]"}]}]}], "2"]}
        }], ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`Parametrix", "[", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {"0", "1"},
        {
         RowBox[{"-", "1"}], "0"}
       }], ")"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Beta]", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]", "[", "p_", "]"}], ":=", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"p", "-", "b"}], 
          RowBox[{"p", "-", "a"}]], ")"}], 
        RowBox[{"1", "/", "4"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(", GridBox[{
         {
          FractionBox[
           RowBox[{
            RowBox[{"\[Beta]", "[", "z", "]"}], "+", 
            RowBox[{"1", "/", 
             RowBox[{"\[Beta]", "[", "z", "]"}]}]}], "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"\[Beta]", "[", "z", "]"}], "-", 
            RowBox[{"1", "/", 
             RowBox[{"\[Beta]", "[", "z", "]"}]}]}], 
           RowBox[{"2", " ", "I"}]]},
         {
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"\[Beta]", "[", "z", "]"}], "-", 
             RowBox[{"1", "/", 
              RowBox[{"\[Beta]", "[", "z", "]"}]}]}], 
            RowBox[{"2", "I"}]]}], 
          FractionBox[
           RowBox[{
            RowBox[{"\[Beta]", "[", "z", "]"}], "+", 
            RowBox[{"1", "/", 
             RowBox[{"\[Beta]", "[", "z", "]"}]}]}], "2"]}
        }], ")"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`Parametrix", "[", 
    RowBox[{
     RowBox[{"DD_", "?", "DiagonalMatrixQ"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}]}], "}"}], "]"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "z"}]}], 
          RowBox[{
           RowBox[{"2", "z"}], " ", "-", "1"}]], ")"}], 
        RowBox[{
         FractionBox["I", 
          RowBox[{"2", " ", "\[Pi]"}]], 
         RowBox[{"Log", "[", 
          RowBox[{"DD", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}]], 
       "0"},
      {"0", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "z"}]}], 
          RowBox[{
           RowBox[{"2", "z"}], " ", "-", "1"}]], ")"}], 
        RowBox[{
         FractionBox["I", 
          RowBox[{"2", " ", "\[Pi]"}]], 
         RowBox[{"Log", "[", 
          RowBox[{"DD", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}]]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`ParametrixBranch", "[", 
    RowBox[{
     RowBox[{"DD_", "?", "DiagonalMatrixQ"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}]}], "}"}], "]"}], ",", "z_", ",", "t_"}], 
    "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"PowerBranch", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "z"}]}], 
          RowBox[{
           RowBox[{"2", "z"}], " ", "-", "1"}]], ",", 
         RowBox[{
          FractionBox["I", 
           RowBox[{"2", " ", "\[Pi]"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"DD", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], ",", 
         "t"}], "]"}], "0"},
      {"0", 
       RowBox[{"PowerBranch", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "z"}]}], 
          RowBox[{
           RowBox[{"2", "z"}], " ", "-", "1"}]], ",", 
         RowBox[{
          FractionBox["I", 
           RowBox[{"2", " ", "\[Pi]"}]], 
          RowBox[{"Log", "[", 
           RowBox[{"DD", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], ",", 
         "t"}], "]"}]}
     }], ")"}]}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["RH Test", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`RHWellPosed", "[", 
    RowBox[{"GG_", ",", "Gg_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Dot", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"LeftEndpoint", "[", "#", "]"}], "~", "NEqual", "~", 
           RowBox[{"(", "Gg", ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"First", "[", "#", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Inverse", "[", 
           RowBox[{"Last", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
       "\[IndentingNewLine]", 
       RowBox[{"SelectWithPoint", "[", 
        RowBox[{"GG", ",", "Gg"}], "]"}]}], ")"}]}], "//", "Chop"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RHWellPosed", "[", "GG_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"RHWellPosed", "[", 
      RowBox[{"GG", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"Endpoints", "[", "GG", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`ZeroSumCondition", "[", 
    RowBox[{"GG_", ",", "Gg_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"LeftEndpoint", "[", "#", "]"}], "~", "NEqual", "~", 
           RowBox[{"(", "Gg", ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"First", "[", "#", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"-", 
           RowBox[{"Last", "[", "#", "]"}]}]}], "]"}], "&"}], "/@", 
       "\[IndentingNewLine]", 
       RowBox[{"SelectWithPoint", "[", 
        RowBox[{"GG", ",", "Gg"}], "]"}]}], ")"}]}], "//", "Chop"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroSumCondition", "[", "GG_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroSumCondition", "[", 
      RowBox[{"GG", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"Endpoints", "[", "GG", "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Scaled RHSolve", "Section"],

Cell[CellGroupData[{

Cell["Don\[CloseCurlyQuote]t save x", "Subsection"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IteratedRHSolver", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"z0_", ",", "sc_"}], "}"}], ",", "lsGs_"}], "}"}], ",", 
         "Grest___"}], "}"}], ",", 
       RowBox[{"{", "}"}], ",", "R_", ",", "gms_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Cus", ",", "uz0", ",", "usc", ",", "us", ",", "gl"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gl", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Fun", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"z", ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "[", 
                RowBox[{"z0", "+", 
                 FractionBox["z", "sc"]}], "]"}]}], "]"}], ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
             "]"}], "&"}], "/@", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"lsGs", ",", "gms"}], "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IteratedRHSolver", "[", 
         RowBox[{
          RowBox[{"{", "Grest", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"z0", ",", "sc", ",", 
             RowBox[{"R", "[", "gl", "]"}]}], "}"}], "}"}], ",", "R", ",", 
          "gms"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IteratedRHSolver", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "Uls_", ",", "_", ",", "_"}], "]"}], ":=", 
     "Uls"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IteratedRHSolver", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"z0_", ",", "sc_"}], "}"}], ",", "lsGs_"}], "}"}], ",", 
         "Grest___"}], "}"}], ",", "Uls_", ",", "R_", ",", "gms_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Cus", ",", "uz0", ",", "usc", ",", "us", ",", "gl"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gl", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Fun", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"z", ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "[", 
                RowBox[{"z0", "+", 
                 FractionBox["z", "sc"]}], "]"}]}], "]"}], ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
             "]"}], "&"}], "/@", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"lsGs", ",", "gms"}], "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Cus", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Dot", "@@", "#"}], ")"}], "&"}], "/@", 
          RowBox[{"Thread", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"uls", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"uz0", ",", "usc", ",", "us"}], "}"}], "=", "uls"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"FromValueList", "[", 
                 RowBox[{"gl", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Cauchy", "[", 
                    RowBox[{"us", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z0", "+", 
                    RowBox[{
                    RowBox[{"Points", "[", "gl", "]"}], "/", "sc"}]}], ")"}], 
                    "-", "uz0"}], ")"}], "usc"}]}], "]"}], "//", 
                    "ToMatrixOfLists"}], "//", "Flatten"}]}], "]"}], "//", 
                "AddIdentityMatrix"}]}]}], "\[IndentingNewLine]", "]"}], "/@",
             "Uls"}], "\[IndentingNewLine]", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IteratedRHSolver", "[", 
         RowBox[{
          RowBox[{"{", "Grest", "}"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"z0", ",", "sc", ",", 
               RowBox[{"R", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ".", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ".", 
                   RowBox[{"Inverse", "[", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}], "&"}], "/@", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"Cus", ",", "gl"}], "}"}], "]"}]}], "]"}]}], "}"}],
              "}"}], ",", "Uls"}], "]"}], ",", "R", ",", "gms"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OuterIteratedRHSolver", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "Uls_", ",", "_"}], "]"}], ":=", "Uls"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OuterIteratedRHSolver", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"scale_", ",", "domains_"}], "}"}], ",", "jumps_", ",", 
         "R_"}], "}"}], ",", "rest___"}], "}"}], ",", "Uls_", ",", "x_"}], 
    "]"}], ":=", 
   RowBox[{"OuterIteratedRHSolver", "[", 
    RowBox[{
     RowBox[{"{", "rest", "}"}], ",", 
     RowBox[{"IteratedRHSolver", "[", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"scale", "[", "x", "]"}], "//", "Transpose"}], ",", 
          RowBox[{"jumps", "//", "Transpose"}]}], "}"}], "]"}], ",", "Uls", 
       ",", "R", ",", "domains"}], "]"}], ",", "x"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConvertIteratedToStandardFunList", "[", "ifl_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"sfl", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{"Values", "[", "#", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "//", "Domain"}], ")"}], "/", 
              RowBox[{
              "sfl", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
              "+", 
             RowBox[{
             "sfl", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Last", "[", "sfl", "]"}]}]}], "]"}], "/@", "ifl"}], ")"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RiemannHilbert`ScaledRHSolver", "[", 
    RowBox[{"l", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], ".."}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"scale", ",", "domains"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ScaledRHSolver", "[", 
      RowBox[{"l", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"Gl", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"scale", ",", "domains"}], "}"}], "=", "Gl"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"RHSolver", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"domain", ",", 
               RowBox[{"Fun", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IdentityMatrix", "[", "2", "]"}], "&"}], ",", 
                 RowBox[{"Sequence", "@@", "domain"}]}], "]"}]}], "]"}], "/@",
              "domains"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], "/@", 
        "l"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ScaledRHSolver", "[", 
      RowBox[{
       RowBox[{"l", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}], ".."}], "}"}]}], ",", "Rs_"}], 
      "]"}], "[", 
     RowBox[{"x_", ",", "Gf_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"OuterIteratedRHSolver", "[", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"l", ",", "Gf", ",", "Rs"}], "}"}], "]"}], ",", 
       RowBox[{"{", "}"}], ",", "x"}], "]"}], "//", 
     "ConvertIteratedToStandardFunList"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ScaledRHSolver", "[", 
    RowBox[{"{", 
     RowBox[{"scs_", ",", "gms_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"ScaledRHSolver", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"scs", ",", "gms"}], "}"}], ",", 
     RowBox[{"RHSolver", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Fun", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "2", "]"}], "&"}], ",", 
          RowBox[{"Sequence", "@@", "##"}]}], "]"}], "&"}], "/@", "gms"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScaledRHSolver", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"scs_", ",", "gms_"}], "}"}], ",", "R_RHSolver"}], "]"}], "[", 
    
    RowBox[{"x_", ",", "gs_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"IteratedRHSolver", "[", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"scs", "[", "x", "]"}], "//", "Transpose"}], ",", 
         RowBox[{"gs", "//", "Transpose"}]}], "}"}], "]"}], ",", 
      RowBox[{"{", "}"}], ",", "R", ",", "gms"}], "]"}], "//", 
    "ConvertIteratedToStandardFunList"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConstructCurve", "[", 
    RowBox[{
     RowBox[{"crvs", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}], ",", 
     "x_"}], "]"}], ":=", 
   RowBox[{"Join", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ConstructCurve", "[", 
        RowBox[{"#", ",", "x"}], "]"}], "&"}], "/@", "crvs"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConstructCurve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"scs_", ",", "gfs_", ",", "domain_"}], "}"}], ",", "x_"}], 
    "]"}], ":=", 
   RowBox[{"Join", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ConstructCurve", "[", 
        RowBox[{"#", ",", "x", ",", "domain"}], "]"}], "&"}], "/@", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"scs", "[", "x", "]"}], "//", "Transpose"}], ",", 
         RowBox[{"gfs", "//", "Transpose"}]}], "}"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConstructCurve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z0_", ",", "sc_"}], "}"}], ",", "gs_"}], "}"}], ",", "x_", 
     ",", "domain_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"in", ",", 
      RowBox[{"Fun", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "in", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "[", 
          RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"in", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], "/",
            "sc"}], " ", "+", "z0"}], "]"}], ",", 
        RowBox[{"in", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], "]"}],
     "/@", 
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{"gs", ",", "domain"}], "}"}], "]"}]}]}], ";"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Save x", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CauchyMatrix", "[", 
    RowBox[{"s_", ",", 
     RowBox[{"l1", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "IntervalDomainQ"}], ",", "_Integer"}], "}"}], 
        ".."}], "}"}]}], ",", 
     RowBox[{"l2", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "IntervalDomainQ"}], ",", "_Integer"}], "}"}], 
        ".."}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"CauchyMatrix", "[", 
    RowBox[{"s", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"IFun", "[", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{"0", "&"}], ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}],
        "&"}], "/@", "l1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"IFun", "[", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{"0", "&"}], ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}],
        "&"}], "/@", "l2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyOperator", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"l1", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "IntervalDomainQ"}], ",", "_Integer"}], "}"}], 
         ".."}], "}"}]}], ",", 
      RowBox[{"l2", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "IntervalDomainQ"}], ",", "_Integer"}], "}"}], 
         ".."}], "}"}]}]}], "]"}], ":=", 
    RowBox[{"FunValueListOperator", "[", 
     RowBox[{
      RowBox[{"CauchyMatrix", "[", 
       RowBox[{"s", ",", "l1", ",", "l2"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"IFun", "[", 
         RowBox[{
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{"0", "&"}], ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}], "/@", "l2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "We", " ", "want", " ", "to", " ", "be", " ", "able", " ", "to", 
    " ", "change", " ", "the", " ", "domain", " ", "after", " ", "the", " ", 
    "fact", " ", "below"}], " ", "**)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyOperator", "[", 
     RowBox[{"s_", ",", 
      RowBox[{"l1", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "DomainQ"}], ",", "_Integer"}], "}"}], ".."}], 
        "}"}]}], ",", 
      RowBox[{"l2", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "DomainQ"}], ",", "_Integer"}], "}"}], ".."}], 
        "}"}]}], ",", 
      RowBox[{"l3", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "DomainQ"}], ",", "_Integer"}], "}"}], ".."}], 
        "}"}]}]}], "]"}], ":=", 
    RowBox[{"FunValueListOperator", "[", 
     RowBox[{
      RowBox[{"CauchyMatrix", "[", 
       RowBox[{"s", ",", "l1", ",", "l2"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"IFun", "[", 
         RowBox[{
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{"0", "&"}], ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}], "/@", "l3"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IteratedScaledCauchy", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z0_", ",", "sc_"}], "}"}], ",", "rest___"}], "}"}], ",", 
     RowBox[{"{", "}"}], ",", "gms_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"IteratedScaledCauchy", "[", 
    RowBox[{
     RowBox[{"{", "rest", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"z0", ",", "sc", ",", "i", ",", 
        RowBox[{"{", "}"}]}], "}"}], "}"}], ",", "gms", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IteratedScaledCauchy", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z0_", ",", "sc_"}], "}"}], ",", "rest___"}], "}"}], ",", 
     "Uls_", ",", "gms_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Cmats", ",", "uz0", ",", "usc", ",", "us", ",", "ugms", ",", "uCmats", 
       ",", "uR", ",", "uz0scs", ",", "ui"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cmats", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"ulscs", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"uz0", ",", "usc", ",", "ui", ",", "uCmats"}], "}"}], 
            "=", "ulscs"}], ";", "\[IndentingNewLine]", 
           RowBox[{"CauchyOperator", "[", 
            RowBox[{
             RowBox[{"+", "1"}], ",", 
             RowBox[{
             "gms", "\[LeftDoubleBracket]", "ui", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"usc", " ", 
                  RowBox[{"(", 
                   RowBox[{"z0", "+", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "/", "sc"}], "-", "uz0"}], 
                   ")"}]}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "}"}], "&"}], "/@", 
              RowBox[{
              "gms", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
              ",", 
             RowBox[{
             "gms", "\[LeftDoubleBracket]", "ui", "\[RightDoubleBracket]"}]}],
             "]"}]}]}], "\[IndentingNewLine]", "]"}], "/@", "Uls"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IteratedScaledCauchy", "[", 
       RowBox[{
        RowBox[{"{", "rest", "}"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{"Uls", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"z0", ",", "sc", ",", "i", ",", "Cmats"}], "}"}], "}"}]}],
          "]"}], ",", "gms", ",", "i"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IteratedScaledCauchy", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "Uls_", ",", "_", ",", "_"}], "]"}], ":=", 
   "Uls"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OuterIteratedScaledCauchy", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "Uls_", ",", "_", ",", "_", ",", "_"}], "]"}], ":=",
    "Uls"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OuterIteratedScaledCauchy", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"scales_", ",", "rest___"}], "}"}], ",", "Uls_", ",", "gms_", 
     ",", "i_", ",", "x_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"OuterIteratedScaledCauchy", "[", 
    RowBox[{
     RowBox[{"{", "rest", "}"}], ",", 
     RowBox[{"IteratedScaledCauchy", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"scales", "[", "x", "]"}], "//", "Transpose"}], ",", "Uls", 
       ",", "gms", ",", "i"}], "]"}], ",", "gms", ",", 
     RowBox[{"i", "+", "1"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IteratedRHSolver", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "Uls_", ",", "_", ",", "_"}], "]"}], ":=", 
   "Uls"}], ";", 
  RowBox[{
   RowBox[{"IteratedRHSolver", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z0_", ",", "sc_", ",", "i_", ",", "Cmats_"}], "}"}], ",", 
         "Gf_"}], "}"}], ",", "Grest___"}], "}"}], ",", 
     RowBox[{"{", "}"}], ",", "Rs_", ",", "gms_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "gl", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Fun", "[", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"z", ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "[", 
              RowBox[{"z0", "+", 
               FractionBox["z", "sc"]}], "]"}]}], "]"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
          "]"}], "&"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"Gf", ",", 
           RowBox[{
           "gms", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"IteratedRHSolver", "[", 
       RowBox[{
        RowBox[{"{", "Grest", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"z0", ",", "sc", ",", 
           RowBox[{
            RowBox[{
            "Rs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "[",
             "gl", "]"}]}], "}"}], "}"}], ",", "Rs", ",", "gms"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IteratedRHSolver", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z0_", ",", "sc_", ",", "i_", ",", "Cmats_"}], "}"}], ",", 
         "Gf_"}], "}"}], ",", "Grest___"}], "}"}], ",", "Uls_", ",", "Rs_", 
     ",", "gms_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Cus", ",", "uz0", ",", "usc", ",", "us", ",", "gl", ",", "Cs"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Fun", "[", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"z", ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "[", 
              RowBox[{"z0", "+", 
               FractionBox["z", "sc"]}], "]"}]}], "]"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
          "]"}], "&"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"Gf", ",", 
           RowBox[{
           "gms", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Cus", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Dot", "@@", "#"}], ")"}], "&"}], "/@", 
        RowBox[{"Thread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"uls", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"uz0", ",", "usc", ",", "us"}], "}"}], ",", "Cs"}], 
               "}"}], "=", "uls"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Cs", "[", "us", "]"}], "//", "AddIdentityMatrix"}]}]}],
            "\[IndentingNewLine]", "]"}], "/@", 
          RowBox[{"Reverse", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"Uls", ",", "Cmats"}], "}"}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"IteratedRHSolver", "[", 
       RowBox[{
        RowBox[{"{", "Grest", "}"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{"Uls", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"z0", ",", "sc", ",", 
             RowBox[{
              RowBox[{
              "Rs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ".", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 ".", 
                 RowBox[{"Inverse", "[", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "]"}]}], "&"}], "/@", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"Cus", ",", "gl"}], "}"}], "]"}]}], "]"}]}], "}"}], 
           "}"}]}], "]"}], ",", "Rs", ",", "gms"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScaledRHSolver", "[", 
     RowBox[{
      RowBox[{"l", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}], ".."}], "}"}]}], ",", "Rs_"}], 
     "]"}], "[", "x_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"ScaledRHSolver", "[", 
    RowBox[{
     RowBox[{"OuterIteratedScaledCauchy", "[", 
      RowBox[{
       RowBox[{"First", "/@", "l"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Last", "/@", "l"}], ",", "1", ",", "x"}], "]"}], ",", "Rs", 
     ",", 
     RowBox[{"Last", "/@", "l"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScaledRHSolver", "[", 
     RowBox[{
      RowBox[{"l", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}],
       ",", 
      RowBox[{"Rs", ":", 
       RowBox[{"{", "__RHSolver", "}"}]}], ",", 
      RowBox[{"gms", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "DomainQ"}], ",", "_"}], "}"}], ".."}], "}"}], 
         ".."}], "}"}]}]}], "]"}], "[", "Gl_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IteratedRHSolver", "[", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{"l", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Transpose", "/@", "Gl"}], ",", "1"}], "]"}]}], "}"}], 
       "]"}], ",", 
      RowBox[{"{", "}"}], ",", "Rs", ",", "gms"}], "]"}], "//", 
    "ConvertIteratedToStandardFunList"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScaledRHSolver", "[", 
     RowBox[{
      RowBox[{"l", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}],
       ",", "R_RHSolver", ",", 
      RowBox[{"gms", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "DomainQ"}], ",", "_"}], "}"}], ".."}], 
        "}"}]}]}], "]"}], "[", "Gl_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ScaledRHSolver", "[", 
     RowBox[{"l", ",", 
      RowBox[{"{", "R", "}"}], ",", 
      RowBox[{"{", "gms", "}"}]}], "]"}], "[", 
    RowBox[{"{", "Gl", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScaledRHSolver", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"scs_", ",", "gms_"}], "}"}], ",", "R_"}], "]"}], "[", "x_", 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"ScaledRHSolver", "[", 
    RowBox[{
     RowBox[{"OuterIteratedScaledCauchy", "[", 
      RowBox[{
       RowBox[{"{", "scs", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "gms", "}"}], ",", "1", ",", "x"}], "]"}], ",", "R", ",", 
     "gms"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[""], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"*", 
    RowBox[{"TODO", ":", " ", 
     RowBox[{
     "ScaledCauchyOperator", " ", "currently", " ", "only", " ", "works", " ",
       "with", " ", "two", " ", "symmetric", " ", "scaled", " ", 
      "graphs"}]}]}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", 
    RowBox[{"TODO", ":", " ", 
     RowBox[{
      RowBox[{"ScaledCauchyOperator", " ", "currently", " ", "returns", " ", 
       RowBox[{
        RowBox[{"C", "[", "u", "]"}], "[", "z", "]"}]}], " ", "+", " ", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}]}], " ", "**)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RiemannHilbert`ScaledCauchyOperator", "[", 
       RowBox[{"CmR_", ",", "Cmat_List"}], "]"}], "[", "Ucx_", "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"AddIdentityMatrix", "[", 
         RowBox[{
          RowBox[{
          "Cmat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "[", 
          RowBox[{
          "Ucx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "]"}], "]"}], "~", "FunListDot", "~", 
        RowBox[{"AddIdentityMatrix", "[", 
         RowBox[{"CmR", "[", 
          RowBox[{
          "Ucx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"AddIdentityMatrix", "[", 
         RowBox[{"CmR", "[", 
          RowBox[{
          "Ucx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "]"}], "]"}], "~", "FunListDot", "~", 
        RowBox[{"AddIdentityMatrix", "[", 
         RowBox[{
          RowBox[{
          "Cmat", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "[", 
          RowBox[{
          "Ucx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ScaledCauchyOperator", "[", 
      RowBox[{"s_", ",", "slvrx_ScaledRHSolver"}], "]"}], ":=", 
     RowBox[{"ScaledCauchyOperator", "[", 
      RowBox[{
       RowBox[{"CauchyOperator", "[", 
        RowBox[{"s", ",", 
         RowBox[{
         "slvrx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"SetDomain", "[", 
          RowBox[{
           RowBox[{"slvrx", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           "#"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"scs", ",", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"gm", ",", 
               RowBox[{"Fun", "[", 
                RowBox[{
                 RowBox[{"0", "&"}], ",", 
                 RowBox[{
                  RowBox[{
                  "scs", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "+", 
                  RowBox[{
                   RowBox[{
                   "scs", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{
                   "gm", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], ",", 
                 RowBox[{
                 "gm", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], "/@", 
             RowBox[{"Last", "[", "slvrx", "]"}]}]}], "]"}], "/@", 
          RowBox[{"First", "[", "slvrx", "]"}]}], ")"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CauchyOperator", "[", 
      RowBox[{"ScaledCauchyOperator", "[", 
       RowBox[{"CmR_", ",", "Cmat_List"}], "]"}], "]"}], ":=", 
     RowBox[{"FunValueListOperator", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"RightJoin", "[", 
          RowBox[{
           RowBox[{
           "CmR", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"Cmat", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RightJoin", "[", 
          RowBox[{
           RowBox[{"Cmat", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "CmR", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"Join", "@@", 
        RowBox[{"scCm", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "All", ",", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannHilbert`ConstructCurve", "[", 
      RowBox[{
       RowBox[{"crvs", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}], ".."}], "}"}]}], ",", "gls_List", 
       ",", "x_"}], "]"}], ":=", 
     RowBox[{"Join", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ConstructCurve", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", "#"}], ",", "x"}], "]"}], "&"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"crvs", ",", "gls"}], "}"}], "]"}]}], ")"}]}]}], ";", 
    RowBox[{
     RowBox[{"ConstructCurve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"scs_", ",", "domain_"}], "}"}], ",", "gfs_", ",", "x_"}], 
      "]"}], ":=", 
     RowBox[{"Join", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ConstructCurve", "[", 
          RowBox[{"#", ",", "domain"}], "]"}], "&"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"scs", "[", "x", "]"}], "//", "Transpose"}], ",", 
           RowBox[{"gfs", "//", "Transpose"}]}], "}"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ConstructCurve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z0_", ",", "sc_"}], "}"}], ",", "gs_"}], "}"}], ",", 
       "domain_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Fun", "[", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "/", "sc"}], 
          " ", "+", "z0"}], ",", 
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], "&"}], 
      "/@", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{"gs", ",", "domain"}], "}"}], "]"}]}]}], ";"}], 
   " "}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConstructCurve", "[", 
    RowBox[{
     RowBox[{"crvs", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}], ",", 
     "x_"}], "]"}], ":=", 
   RowBox[{"Join", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ConstructCurve", "[", 
        RowBox[{"#", ",", "x"}], "]"}], "&"}], "/@", "crvs"}], ")"}]}]}], 
  ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["With gl given", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IteratedRHSolver", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "Uls_", ",", "_"}], "]"}], ":=", "Uls"}], ";", 
  RowBox[{
   RowBox[{"IteratedRHSolver", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z0_", ",", "sc_", ",", "i_", ",", "Cmats_"}], "}"}], ",", 
         "gl_IFun"}], "}"}], ",", "Grest___"}], "}"}], ",", 
     RowBox[{"{", "}"}], ",", "Rs_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"IteratedRHSolver", "[", 
    RowBox[{
     RowBox[{"{", "Grest", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"z0", ",", "sc", ",", 
        RowBox[{
         RowBox[{"Rs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
          "[", "gl", "]"}]}], "}"}], "}"}], ",", "Rs"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IteratedRHSolver", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z0_", ",", "sc_", ",", "i_", ",", "Cmats_"}], "}"}], ",", 
         "gl_IFun"}], "}"}], ",", "Grest___"}], "}"}], ",", "Uls_", ",", 
     "Rs_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Cus", ",", "uz0", ",", "usc", ",", "us", ",", "Cs"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cus", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Dot", "@@", "#"}], ")"}], "&"}], "/@", 
        RowBox[{"Thread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"uls", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"uz0", ",", "usc", ",", "us"}], "}"}], ",", "Cs"}], 
               "}"}], "=", "uls"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"FromValueList", "[", 
               RowBox[{"gl", ",", 
                RowBox[{"Cs", ".", 
                 RowBox[{"ToValueList", "[", "us", "]"}]}]}], "]"}], "//", 
              "AddIdentityMatrix"}]}]}], "\[IndentingNewLine]", "]"}], "/@", 
          RowBox[{"Reverse", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"Uls", ",", "Cmats"}], "}"}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"IteratedRHSolver", "[", 
       RowBox[{
        RowBox[{"{", "Grest", "}"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{"Uls", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"z0", ",", "sc", ",", 
             RowBox[{
              RowBox[{
              "Rs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ".", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 ".", 
                 RowBox[{"Inverse", "[", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "]"}]}], "&"}], "/@", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"Cus", ",", "gl"}], "}"}], "]"}]}], "]"}]}], "}"}], 
           "}"}]}], "]"}], ",", "Rs"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IteratedRHSolver", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z0_", ",", "sc_", ",", "i_", ",", "Cmats_"}], "}"}], ",", 
         "gl_IFun", ",", "rl_IFun"}], "}"}], ",", "Grest___"}], "}"}], ",", 
     RowBox[{"{", "}"}], ",", "Rs_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"IteratedRHSolver", "[", 
    RowBox[{
     RowBox[{"{", "Grest", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"z0", ",", "sc", ",", 
        RowBox[{
         RowBox[{"Rs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
          "[", 
         RowBox[{"gl", ",", "rl"}], "]"}]}], "}"}], "}"}], ",", "Rs"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IteratedRHSolver", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z0_", ",", "sc_", ",", "i_", ",", "Cmats_"}], "}"}], ",", 
         "gl_IFun", ",", "rl_IFun"}], "}"}], ",", "Grest___"}], "}"}], ",", 
     "Uls_", ",", "Rs_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Cus", ",", "uz0", ",", "usc", ",", "us", ",", "Cs"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cus", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Dot", "@@", "#"}], ")"}], "&"}], "/@", 
        RowBox[{"Thread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"uls", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"uz0", ",", "usc", ",", "us"}], "}"}], ",", "Cs"}], 
               "}"}], "=", "uls"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"FromValueList", "[", 
               RowBox[{"gl", ",", 
                RowBox[{"Cs", ".", 
                 RowBox[{"ToValueList", "[", "us", "]"}]}]}], "]"}], "//", 
              "AddIdentityMatrix"}]}]}], "\[IndentingNewLine]", "]"}], "/@", 
          RowBox[{"Reverse", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"Uls", ",", "Cmats"}], "}"}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"IteratedRHSolver", "[", 
       RowBox[{
        RowBox[{"{", "Grest", "}"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{"Uls", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"z0", ",", "sc", ",", 
             RowBox[{
              RowBox[{
              "Rs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ".", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 ".", 
                 RowBox[{"Inverse", "[", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "]"}]}], "&"}], "/@", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"Cus", ",", "gl"}], "}"}], "]"}]}], "]"}]}], "}"}], 
           "}"}]}], "]"}], ",", "Rs"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScaledRHSolver", "[", 
     RowBox[{
      RowBox[{"l", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}],
       ",", 
      RowBox[{"Rs", ":", 
       RowBox[{"{", "__RHSolver", "}"}]}], ",", 
      RowBox[{"gms", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "DomainQ"}], ",", "_"}], "}"}], ".."}], "}"}], 
         ".."}], "}"}]}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"Gl", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "__IFun", "}"}], ".."}], "}"}]}], ",", 
     RowBox[{"Rl", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "__IFun", "}"}], ".."}], "}"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IteratedRHSolver", "[", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{"l", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Transpose", "/@", "Gl"}], ",", "1"}], "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Transpose", "/@", "Rl"}], ",", "1"}], "]"}]}], "}"}], 
       "]"}], ",", 
      RowBox[{"{", "}"}], ",", "Rs"}], "]"}], "//", 
    "ConvertIteratedToStandardFunList"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScaledRHSolver", "[", 
     RowBox[{
      RowBox[{"l", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}],
       ",", "R_RHSolver", ",", 
      RowBox[{"gms", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "DomainQ"}], ",", "_"}], "}"}], ".."}], 
        "}"}]}]}], "]"}], "[", 
    RowBox[{"Gl", ":", 
     RowBox[{"{", "__IFun", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ScaledRHSolver", "[", 
     RowBox[{"l", ",", 
      RowBox[{"{", "R", "}"}], ",", 
      RowBox[{"{", "gms", "}"}]}], "]"}], "[", 
    RowBox[{"{", "Gl", "}"}], "]"}]}], ";"}]}], "Input"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finish", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{839, 815},
WindowMargins->{{Automatic, -1085}, {-22, Automatic}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
ShowSelection->True,
TrackCellChangeTimes->False,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 6, \
2010)",
StyleDefinitions->"Default.nb"
]

