Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"`Private`PainleveIINegative", "[", "3", "]"}], " ", "=", 
   "`ScaledNegativePainleveII`ScaledPainleveIINegative"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`ScaledNegativePainleveII`\>\"", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["General routine for scaling", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ScaledRHSolver", "[", 
   RowBox[{"{", 
    RowBox[{"scs_", ",", "gs_", ",", "gms_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "standardf", ",", "pts", ",", "R", ",", "Uls", ",", "z0", ",", "sc", ",",
       "Cus", ",", "uz0", ",", "usc", ",", "us", ",", "gl", ",", "lsGs"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"standardf", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Fun", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "2", "]"}], "&"}], ",", 
          RowBox[{"Sequence", "@@", "##"}]}], "]"}], "&"}], "/@", "gms"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"pts", "=", 
      RowBox[{"standardf", "//", "Points"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"RHSolver", "[", "standardf", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Uls", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"ls", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"z0", ",", "sc"}], "}"}], ",", "lsGs"}], "}"}], "=", 
             "ls"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Cus", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Dot", "@@", "#"}], ")"}], "&"}], "/@", 
              RowBox[{"Thread", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{"uls", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"uz0", ",", "usc", ",", "us"}], "}"}], "=", 
                    "uls"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"FromValueList", "[", 
                    RowBox[{"standardf", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cauchy", "[", 
                    RowBox[{"us", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z0", "+", 
                    RowBox[{"pts", "/", 
                    RowBox[{"sc", "[", "x", "]"}]}]}], ")"}], "-", "uz0"}], 
                    ")"}], "usc"}]}], "]"}], "//", "ToMatrixOfLists"}], "//", 
                    "Flatten"}]}], "]"}], "//", "AddIdentityMatrix"}]}]}], 
                 "\[IndentingNewLine]", "]"}], "/@", "Uls"}], 
               "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"gl", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Fun", "[", 
                RowBox[{
                 RowBox[{"Function", "[", 
                  RowBox[{"z", ",", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"z0", "+", 
                    FractionBox["z", 
                    RowBox[{"sc", "[", "x", "]"}]]}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], "&"}], "/@", 
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{"lsGs", ",", "gms"}], "}"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Cus", "\[Equal]", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Uls", "=", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"z0", ",", 
                    RowBox[{"sc", "[", "x", "]"}], ",", 
                    RowBox[{"R", "[", "gl", "]"}]}], "}"}], "}"}], ",", 
                 "Uls"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Uls", "=", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"z0", ",", 
                    RowBox[{"sc", "[", "x", "]"}], ",", 
                    RowBox[{"R", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ".", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ".", 
                    RowBox[{"Inverse", "[", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}], "&"}], "/@", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{"Cus", ",", "gl"}], "}"}], "]"}]}], "]"}]}], 
                   "}"}], "}"}], ",", "Uls"}], "]"}]}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], "/@", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"scs", "//", "Transpose"}], ",", 
            RowBox[{"gs", "//", "Transpose"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               RowBox[{"DomainIntegrate", "[", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                "]"}], "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
              RowBox[{"\[Pi]", " ", "I", " ", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}]]}], "&"}], "/@", "Uls"}], ")"}], "//",
          "Total"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Negative x", "Section",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]", "[", "\[Lambda]_", "]"}], ":=", 
    RowBox[{
     FractionBox["2", "3"], " ", "\[ImaginaryI]", "  ", "\[Lambda]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["\[Lambda]", "2"]}]}], ")"}]}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G", "[", 
     RowBox[{"k_", "?", "EvenQ"}], "]"}], "[", 
    RowBox[{"s_", ",", "x_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        RowBox[{"s", "[", "k", "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "x"}], ")"}], 
            RowBox[{"3", "/", "2"}]]}], " ", 
          RowBox[{"\[Theta]", "[", "z", "]"}]}], "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G", "[", 
     RowBox[{"k_", "?", "OddQ"}], "]"}], "[", 
    RowBox[{"s_", ",", "x_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {
       RowBox[{
        RowBox[{"s", "[", "k", "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "x"}], ")"}], 
           RowBox[{"3", "/", "2"}]], " ", 
          RowBox[{"\[Theta]", "[", "z", "]"}]}], "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DD", "//", "Clear"}], ";", 
  RowBox[{
   RowBox[{"GL", "[", 
    RowBox[{"s_", ",", "x_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {
       RowBox[{
        FractionBox[
         RowBox[{"s", "[", "1", "]"}], 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"s", "[", "1", "]"}], " ", 
           RowBox[{"s", "[", "3", "]"}]}]}]], 
        RowBox[{"Exp", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "x"}], ")"}], 
           RowBox[{"3", "/", "2"}]], " ", 
          RowBox[{"\[Theta]", "[", "z", "]"}]}], "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GU", "[", 
    RowBox[{"s_", ",", "x_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        FractionBox[
         RowBox[{"s", "[", "1", "]"}], 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"s", "[", "1", "]"}], " ", 
           RowBox[{"s", "[", "3", "]"}]}]}]], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "x"}], ")"}], 
            RowBox[{"3", "/", "2"}]]}], " ", 
          RowBox[{"\[Theta]", "[", "z", "]"}]}], "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DD", "[", "s_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], " ", 
         RowBox[{"s", "[", "3", "]"}]}]}], "0"},
      {"0", 
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"s", "[", "1", "]"}], 
          RowBox[{"s", "[", "3", "]"}]}]}]]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"s_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"Parametrix", "[", 
    RowBox[{
     RowBox[{"DD", "[", "s", "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}]}], "}"}], "]"}], ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPhi]p", "[", 
    RowBox[{"s_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"ParametrixBranch", "[", 
    RowBox[{
     RowBox[{"DD", "[", "s", "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}]}], "}"}], "]"}], ",", "z", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "\[Pi]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPhi]m", "[", 
    RowBox[{"s_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"ParametrixBranch", "[", 
    RowBox[{
     RowBox[{"DD", "[", "s", "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}]}], "}"}], "]"}], ",", "z", ",", "0"}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GRF", "[", "_", "]"}], "[", 
    RowBox[{"_", ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GRF", "[", "6", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"s", ",", "z"}], "]"}], ".", 
    RowBox[{
     RowBox[{"G", "[", "6", "]"}], "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GRF", "[", "1", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"s", ",", "z"}], "]"}], ".", 
    RowBox[{
     RowBox[{"G", "[", "1", "]"}], "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GRF", "[", "2", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"s", ",", "z"}], "]"}], ".", 
    RowBox[{
     RowBox[{"G", "[", "2", "]"}], "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"GU", "[", 
      RowBox[{"s", ",", "x", ",", "z"}], "]"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GRF", "[", "5", "]"}], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"GL", "[", 
       RowBox[{"s", ",", "x", ",", "z"}], "]"}], "]"}], ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"\[CapitalPhi]", "[", 
       RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GRFC", "[", "1", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"GL", "[", 
      RowBox[{"s", ",", "x", ",", "z"}], "]"}], "]"}], ".", 
    RowBox[{
     RowBox[{"G", "[", "6", "]"}], "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{
     RowBox[{"G", "[", "1", "]"}], "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GRFC", "[", "2", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"GL", "[", 
      RowBox[{"s", ",", "x", ",", "z"}], "]"}], "]"}], ".", 
    RowBox[{
     RowBox[{"G", "[", "6", "]"}], "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GRFC", "[", "3", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"GL", "[", 
      RowBox[{"s", ",", "x", ",", "z"}], "]"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GRFC", "[", "4", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"Inverse", "[", 
    RowBox[{"\[CapitalPhi]m", "[", 
     RowBox[{"s", ",", "z"}], "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GLF", "[", 
     RowBox[{"_", ",", "_"}], "]"}], "[", 
    RowBox[{"_", ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GLF", "[", "2", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"s", ",", "z"}], "]"}], ".", 
    RowBox[{"GU", "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GLF", "[", "3", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"s", ",", "z"}], "]"}], ".", 
    RowBox[{
     RowBox[{"G", "[", "3", "]"}], "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GLF", "[", "4", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"s", ",", "z"}], "]"}], ".", 
    RowBox[{
     RowBox[{"G", "[", "4", "]"}], "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GLF", "[", "5", "]"}], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], ".", 
     RowBox[{
      RowBox[{"G", "[", "5", "]"}], "[", 
      RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
     RowBox[{"GL", "[", 
      RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"\[CapitalPhi]", "[", 
       RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GLFC", "[", "1", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{"Inverse", "[", 
    RowBox[{"\[CapitalPhi]m", "[", 
     RowBox[{"s", ",", "z"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GLFC", "[", "2", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DD", "[", "s", "]"}], ".", 
    RowBox[{"GU", "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GLFC", "[", "3", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DD", "[", "s", "]"}], ".", 
    RowBox[{"GU", "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{
     RowBox[{"G", "[", "3", "]"}], "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GLFC", "[", "4", "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "s_"}], "}"}], ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DD", "[", "s", "]"}], ".", 
    RowBox[{"GU", "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{
     RowBox[{"G", "[", "3", "]"}], "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{
     RowBox[{"G", "[", "4", "]"}], "[", 
     RowBox[{"s", ",", "x", ",", "z"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"\[CapitalPhi]", "[", 
      RowBox[{"s", ",", "z"}], "]"}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[TextData[{
 "We use a special data structure: Here\n\n",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"scs", ",", "gs", ",", "gms"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", GridBox[{
         {"z1", "z2"},
         {"sc1", "sc2"}
        }], ")"}], ",", 
      RowBox[{"(", GridBox[{
         {"f11", "f12"},
         {"f21", "g22"},
         {":", ":"}
        }], ")"}], ",", 
      RowBox[{"(", GridBox[{
         {"D1", "n1"},
         {"D2", "n2"},
         {":", ":"}
        }], ")"}]}], "}"}]}], ";"}]],
  CellChangeTimes->{{3.500866829848838*^9, 3.500866865556838*^9}, {
    3.500866950267263*^9, 3.500867031263736*^9}, {3.500867068743669*^9, 
    3.5008671091816807`*^9}, {3.50086714425734*^9, 3.500867206182543*^9}, {
    3.5008674249951563`*^9, 3.50086742518604*^9}, {3.500867502556541*^9, 
    3.500867547565939*^9}, {3.500867595455267*^9, 3.500867643156459*^9}, {
    3.5008677010492153`*^9, 3.500867736515069*^9}, {3.5008677808501377`*^9, 
    3.500867864695269*^9}, {3.500867896326025*^9, 3.500867898037743*^9}, {
    3.5008679523682423`*^9, 3.50086798544589*^9}, 3.500868675719352*^9, {
    3.5008753172904997`*^9, 3.500875326625347*^9}, {3.500875436073206*^9, 
    3.500875440488929*^9}}],
 "\n\nsays that the curve around the stationary point z1 is: \n\n\t\
{Fun[f11[s,x], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["D1", 
     RowBox[{"sc1", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "s"}], "}"}], "]"}]], "+", "z1"}], TraditionalForm]]],
 ", n1],Fun[f21[s,x], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["D1", 
     RowBox[{"sc1", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "s"}], "}"}], "]"}]], "+", "z1"}], TraditionalForm]]],
 ", n2],\[Ellipsis]},\n\t\nand the curve around z2 is:\n\n\t{Fun[f12[s,x], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["D2", 
     RowBox[{"sc1", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "s"}], "}"}], "]"}]], "+", "z2"}], TraditionalForm]]],
 ", n2],Fun[f22[s,x], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["D2", 
     RowBox[{"sc2", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "s"}], "}"}], "]"}]], "+", "z2"}], TraditionalForm]]],
 ", n2],\[Ellipsis]},\n\t\nThis way the same Cauchy matrix can be used for \
each curve."
}], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rngg", "=", 
   RowBox[{"{", 
    RowBox[{".5", ",", "2.3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rngg25", "=", 
   RowBox[{"{", 
    RowBox[{".5", ",", "3."}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"scs", ",", "gs", ",", "gms"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {".5", 
         RowBox[{"-", ".5"}]},
        {
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}], 
           RowBox[{"3", "/", "4"}]], "&"}], 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ")"}], 
            RowBox[{"3", "/", "4"}]]}], "&"}]}
       }], ")"}], ",", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"GRF", "[", "1", "]"}], 
         RowBox[{"GLF", "[", "4", "]"}]},
        {
         RowBox[{"GRF", "[", "2", "]"}], 
         RowBox[{"GLF", "[", "5", "]"}]},
        {
         RowBox[{"GRF", "[", "5", "]"}], 
         RowBox[{"GLF", "[", "2", "]"}]},
        {
         RowBox[{"GRF", "[", "6", "]"}], 
         RowBox[{"GLF", "[", "3", "]"}]},
        {
         RowBox[{"GRFC", "[", "1", "]"}], 
         RowBox[{"GLFC", "[", "4", "]"}]},
        {
         RowBox[{"GRFC", "[", "2", "]"}], 
         RowBox[{"GLFC", "[", "3", "]"}]},
        {
         RowBox[{"GRFC", "[", "3", "]"}], 
         RowBox[{"GLFC", "[", "2", "]"}]},
        {
         RowBox[{"GRFC", "[", "4", "]"}], 
         RowBox[{"GLFC", "[", "1", "]"}]}
       }], ")"}], ",", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", 
             RowBox[{"\[Pi]", "/", "4"}]}], "]"}], "rngg"}], "]"}], "n"},
        {
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"3", " ", "I", " ", 
             RowBox[{"\[Pi]", "/", "4"}]}], "]"}], "rngg25"}], "]"}], "n"},
        {
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "3"}], "I", " ", 
             RowBox[{"\[Pi]", "/", "4"}]}], "]"}], "rngg25"}], "]"}], "n"},
        {
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", " ", "I"}], " ", 
             RowBox[{"\[Pi]", "/", "4"}]}], "]"}], "rngg"}], "]"}], "n"},
        {
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"3", " ", "I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], " ", ",", 
             RowBox[{"Exp", "[", " ", 
              RowBox[{"I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], " ", "}"}], 
           RowBox[{
           "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], "n"},
        {
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", " ", 
              RowBox[{"I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], " ", ",", 
             RowBox[{"Exp", "[", " ", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], " ", "}"}], 
           RowBox[{
           "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], "n"},
        {
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", " ", "I"}], " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], " ", ",", 
             RowBox[{"Exp", "[", " ", 
              RowBox[{
               RowBox[{"-", "3"}], "I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], " ", "}"}], 
           RowBox[{
           "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], "n"},
        {
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], " ", "I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], " ", ",", 
             RowBox[{"Exp", "[", " ", 
              RowBox[{"3", "I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], " ", "}"}], 
           RowBox[{
           "rngg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], "n"}
       }], ")"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"slvr", "=", 
    RowBox[{"ScaledRHSolver", "[", 
     RowBox[{"{", 
      RowBox[{"scs", ",", "gs", ",", "gms"}], "}"}], "]"}]}], ";"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.690445`", ",", "Null"}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"slvr", "=", 
   RowBox[{"ScaledRHSolver", "[", 
    RowBox[{"{", 
     RowBox[{"scs", ",", "gs", ",", "gms"}], "}"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ScaledPainleveIINegative", "[", 
   RowBox[{"sin_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], ",", 
        RowBox[{"s", "[", "2", "]"}], ",", 
        RowBox[{"s", "[", "3", "]"}]}], "}"}], "=", "sin"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "[", "4", "]"}], ",", 
        RowBox[{"s", "[", "5", "]"}], ",", 
        RowBox[{"s", "[", "6", "]"}]}], "}"}], "=", 
      RowBox[{"-", 
       RowBox[{"Array", "[", 
        RowBox[{"s", ",", "3"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"-", "x"}], "]"}], 
      RowBox[{"slvr", "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "s"}], "}"}], "]"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScaledPainleveIINegative", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", 
     RowBox[{"1", "/", "3"}]}], "}"}], ",", 
   RowBox[{"-", "1000."}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"0.010219052820779938`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.03652874229050075`", " ", "\[ImaginaryI]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PainleveII", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", 
     RowBox[{"1", "/", "3"}]}], "}"}], ",", 
   RowBox[{"-", "1000."}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"0.010219042827865153`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.036528790841060234`", " ", "\[ImaginaryI]"}]}]], "Output"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{833, 835},
WindowMargins->{{304, Automatic}, {Automatic, 111}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
TrackCellChangeTimes->False,
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
