(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     91087,       2332]
NotebookOptionsPosition[     89818,       2288]
NotebookOutlinePosition[     90192,       2304]
CellTagsIndexPosition[     90149,       2301]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
\[Copyright] Georg Wechslberger, 2010, subject to BSD license.
  \
\>", "Text",
 CellChangeTimes->{{3.500386073922814*^9, 3.500386077776066*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"PainleveIINegative", "[", "1", "]"}], " ", "needs", " ", "to", 
     " ", "be", " ", "a", " ", "symbol", " ", "in", " ", "order", " ", "to", 
     " ", "assign", " ", "options", " ", "to", " ", "it"}], ",", " ", 
    RowBox[{
    "therefore", " ", "we", " ", "have", " ", "to", " ", "introduce", " ", 
     "PainleveIINegativeContour1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"`Private`PainleveIINegative", "[", "2", "]"}], " ", "=", 
     "`NegativeContour2`PainleveIINegativeContour2"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"`Private`ClearDatabase", "[", "Negative2", "]"}], "=", " ", 
     "`NegativeContour2`clearCachedRHSolver"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.500368949054644*^9, 3.500368981286056*^9}, 
   3.500369023229803*^9, {3.500369205720496*^9, 3.500369271244113*^9}, {
   3.500369303135931*^9, 3.5003693080750523`*^9}, {3.500375900268382*^9, 
   3.5003759016166563`*^9}, {3.500377824786626*^9, 3.500377833142667*^9}, {
   3.5003790962007303`*^9, 3.50037909755476*^9}, {3.500381024403549*^9, 
   3.500381076078937*^9}, {3.500381125092041*^9, 3.5003811350036297`*^9}, {
   3.500386130818799*^9, 3.500386135961277*^9}, {3.500386272628083*^9, 
   3.5003862730035267`*^9}, {3.5003904477597723`*^9, 3.5003904556273403`*^9}, 
   3.500390500150157*^9}],

Cell[CellGroupData[{

Cell["Negative x - Contour 2", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.494170602320895*^9, 3.494170603463461*^9}, {
  3.500386104970051*^9, 3.500386118415648*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`NegativeContour2`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"jump", "[", "_", "]"}], "[", 
    RowBox[{"_", ",", 
     RowBox[{"_", "?", "InfinityQ"}]}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"jump", "[", "M_", "]"}], "[", 
    RowBox[{"x_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M", "[", 
      RowBox[{"x", ",", "z"}], "]"}], ")"}], "/.", 
    RowBox[{
     RowBox[{"Underflow", "[", "]"}], "\[Rule]", "0"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5003688710671577`*^9, 3.500368904161265*^9}, {
  3.5003689418682528`*^9, 3.50036895567192*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"original", " ", "contour", " ", "from", " ", 
    RowBox[{"acticle", ":", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "Asymptotics", " ", "for", " ", "the", " ", "painlev\[EAcute]", " ", 
      "II", " ", "equation", "\n", 
      RowBox[{"P", ".", " ", "A", ".", " ", "Deift1"}]}]}]}], ",", " ", 
   RowBox[{
    RowBox[{"X", ".", " ", "Zhou2"}], "\[IndentingNewLine]", "Communications",
     " ", "on", " ", "Pure", " ", "and", " ", "Applied", " ", "Mathematics", 
    "\n", "Volume", " ", "48"}], ",", " ", 
   RowBox[{"Issue", " ", "3"}], ",", " ", 
   RowBox[{"pages", " ", "277", "\[Dash]337"}], ",", " ", 
   RowBox[{
    RowBox[{"1995", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{"Contour", " ", "is", " ", "on", " ", "page", " ", "285"}], 
      ")"}], "\n", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"onlinelibrary", ".", "wiley", ".", "com"}], "/", "doi"}], 
        "/", "10.1002"}], "/", "cpa"}], 
      RowBox[{
       RowBox[{".3160480304", "/", "abstract"}], "\[IndentingNewLine]", "\n", 
       "\\", 
       RowBox[{"G", "[", "3", "]"}]}]}], "           ", "|", 
     RowBox[{
      RowBox[{
       RowBox[{"G", "[", "2", "]"}], "          ", "/", 
       RowBox[{"G", "[", "1", "]"}]}], "\n", " ", "\\"}], "              ", 
     "|", "             ", 
     RowBox[{"/", "\n", "  ", "\\"}], "             ", "|", "            ", 
     RowBox[{"/", "\n", "   ", 
      RowBox[{"\\", "          ", "i"}]}], " ", "|", "           ", 
     RowBox[{
      RowBox[{"/", "\n", "    ", 
       RowBox[{"\\", "          ", 
        RowBox[{"/", 
         RowBox[{"\\", "          ", 
          RowBox[{"/", "\n", "     ", 
           RowBox[{"\\", "    ", 
            RowBox[{
             RowBox[{"G", "[", "8", "]"}], "/"}], "  ", "\\", 
            RowBox[{
             RowBox[{"G", "[", "7", "]"}], "    ", "/"}], "\n", "      ", 
            "\\", "      ", 
            RowBox[{"/", "    ", 
             RowBox[{"\\", "      ", 
              RowBox[{"/", "\n", "       ", 
               RowBox[{"\\", "    ", 
                RowBox[{"/", "      ", 
                 RowBox[{"\\", "    ", 
                  RowBox[{"/", "\n", "        ", 
                   RowBox[{"\\", "  ", 
                    RowBox[{"/", "        ", 
                    RowBox[{"\\", "  ", 
                    RowBox[{"/", "\n", "         ", 
                    RowBox[{"\\/", "_"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
      " ", "_", " ", "_", " ", "_", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"_", " ", "\\/", "\n", "      ", 
         RowBox[{"-", "1"}]}], " ", "/"}], "\\", "   ", 
       RowBox[{
        RowBox[{"G", "[", "11", "]"}], "  ", "/"}], "\\", " ", 
       RowBox[{"1", "\n", "        ", "/"}], "  ", "\\", "        ", 
       RowBox[{"/", "  ", 
        RowBox[{"\\", " ", "\n", "       ", 
         RowBox[{"/", "    ", 
          RowBox[{"\\", "      ", 
           RowBox[{"/", "    ", 
            RowBox[{"\\", " ", "\n", "      ", 
             RowBox[{"/", "      ", 
              RowBox[{"\\", "    ", 
               RowBox[{"/", "      ", 
                RowBox[{"\\", " ", "\n", "     ", 
                 RowBox[{"/", "    ", 
                  RowBox[{"G", "[", "9", "]"}]}], "\\", "  ", 
                 RowBox[{"/", 
                  RowBox[{"G", "[", "10", "]"}]}], "   ", "\\", " ", "\n", 
                 "    ", 
                 RowBox[{"/", "          ", "\\/"}], "          ", "\\", " ", 
                 "\n", "   ", 
                 RowBox[{"/", "         ", 
                  RowBox[{"-", "i"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", "|", 
     "           ", 
     RowBox[{"\\", " ", "\n", "  ", "/"}], "             ", "|", 
     "            ", 
     RowBox[{"\\", " ", "\n", " ", "/"}], "              ", "|", 
     "             ", 
     RowBox[{"\\", " ", "\n", 
      RowBox[{"/", 
       RowBox[{"G", "[", "4", "]"}]}]}], "           ", "|", 
     RowBox[{
      RowBox[{
       RowBox[{"G", "[", "5", "]"}], "          ", "\\", 
       RowBox[{"G", "[", "6", "]"}]}], "\n", "\n", "\n", "\n", "implemented", 
      " ", 
      RowBox[{"contour", ":", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"G", "[", "11", "]"}], " ", "has", " ", "been", " ", 
        "combined", " ", "symmetrically", " ", "to", " ", 
        RowBox[{"G", "[", "7", "]"}]}]}]}]}]}], ",", 
   RowBox[{"G", "[", "8", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G", "[", "9", "]"}], " ", "and", " ", 
      RowBox[{
       RowBox[{"G", "[", "10", "]"}], "\[IndentingNewLine]", "\n", "\\", 
       RowBox[{"G", "[", "3", "]"}]}]}], "           ", "|", 
     RowBox[{
      RowBox[{
       RowBox[{"G", "[", "2", "]"}], "          ", "/", 
       RowBox[{"G", "[", "1", "]"}]}], "\n", " ", "\\"}], "              ", 
     "|", "             ", 
     RowBox[{"/", "\n", "  ", "\\"}], "             ", "|", "            ", 
     RowBox[{"/", "\n", "   ", 
      RowBox[{"\\", "          ", "i"}]}], " ", "|", "           ", 
     RowBox[{"/", "\n", "    ", 
      RowBox[{"\\", "          ", 
       RowBox[{"/", 
        RowBox[{"\\", "          ", 
         RowBox[{"/", "\n", "     ", 
          RowBox[{"\\", "   ", 
           RowBox[{
            RowBox[{"G", "[", "13", "]"}], "/"}], "  ", "\\", 
           RowBox[{
            RowBox[{"G", "[", "12", "]"}], "   ", "/"}], "\n", "      ", "\\",
            "      ", 
           RowBox[{"/", "    ", 
            RowBox[{"\\", "      ", 
             RowBox[{"/", "\n", "       ", 
              RowBox[{"\\", "    ", 
               RowBox[{"/", "      ", 
                RowBox[{"\\", "    ", 
                 RowBox[{"/", "\n", "        ", 
                  RowBox[{"\\", "  ", 
                   RowBox[{"/", "        ", 
                    RowBox[{"\\", "  ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"/", "\n", "         ", "\\/"}], "          ", "\\/",
                     "\n", "      ", 
                    RowBox[{"-", "1"}]}], " ", "/"}], "\\", "          ", 
                    RowBox[{"/", 
                    RowBox[{"\\", " ", 
                    RowBox[{"1", "\n", "        ", "/"}], "  ", "\\", 
                    "        ", 
                    RowBox[{"/", "  ", 
                    RowBox[{"\\", " ", "\n", "       ", 
                    RowBox[{"/", "    ", 
                    RowBox[{"\\", "      ", 
                    RowBox[{"/", "    ", 
                    RowBox[{"\\", " ", "\n", "      ", 
                    RowBox[{"/", "      ", 
                    RowBox[{"\\", "    ", 
                    RowBox[{"/", "      ", 
                    RowBox[{"\\", " ", "\n", "     ", 
                    RowBox[{"/", "   ", 
                    RowBox[{"G", "[", "14", "]"}]}], "\\", "  ", 
                    RowBox[{"/", 
                    RowBox[{"G", "[", "15", "]"}]}], "   ", "\\", " ", "\n", 
                    "    ", 
                    RowBox[{"/", "          ", "\\/"}], "          ", "\\", 
                    " ", "\n", "   ", 
                    RowBox[{"/", "         ", 
                    RowBox[{
                    "-", "i"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}], " ", "|", "           ", 
     RowBox[{"\\", " ", "\n", "  ", "/"}], "             ", "|", 
     "            ", 
     RowBox[{"\\", " ", "\n", " ", "/"}], "              ", "|", 
     "             ", 
     RowBox[{"\\", " ", "\n", 
      RowBox[{"/", 
       RowBox[{"G", "[", "4", "]"}]}]}], "           ", "|", 
     RowBox[{
      RowBox[{
       RowBox[{"G", "[", "5", "]"}], "          ", "\\", 
       RowBox[{"G", "[", "6", "]"}]}], "\n", "\n", "with", " ", "SG"}]}], " ",
     "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"G", "[", "11", "]"}], "]"}], " ", "\n", 
      RowBox[{"G", "[", "14", "]"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"G", "[", "7", "]"}], ".", 
        RowBox[{"Inverse", "[", "SG", "]"}]}], "\n", 
       RowBox[{"G", "[", "15", "]"}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"SG", ".", 
         RowBox[{"G", "[", "8", "]"}]}], "\n", 
        RowBox[{"G", "[", "16", "]"}]}], " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Inverse", "[", "SG", "]"}], ".", 
          RowBox[{"G", "[", "9", "]"}]}], "\n", 
         RowBox[{"G", "[", "17", "]"}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{"G", "[", "10", "]"}], ".", "SG"}]}]}]}]}]}]}], "\n", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.500706654999222*^9, 3.500706754102165*^9}, {
   3.5007067851191597`*^9, 3.5007068088766127`*^9}, {3.500708021801649*^9, 
   3.500708033340475*^9}, {3.500708063971971*^9, 3.5007081052038517`*^9}, {
   3.500708199253949*^9, 3.500708203284884*^9}, {3.5007082457027283`*^9, 
   3.5007082761330757`*^9}, {3.500708309146031*^9, 3.5007083267545023`*^9}, 
   3.500708384921854*^9, {3.500708519057365*^9, 3.5007085238678207`*^9}, {
   3.500709306112669*^9, 3.500709313978874*^9}, {3.5007099438026447`*^9, 
   3.5007099461379747`*^9}, 3.500710361135194*^9, {3.500710394275922*^9, 
   3.500710410412574*^9}, {3.500714522672306*^9, 3.500714552430408*^9}, {
   3.500714695196025*^9, 3.500714712937768*^9}, {3.5007155394044867`*^9, 
   3.500715601038116*^9}, {3.500716134922076*^9, 3.500716194467959*^9}, {
   3.500716666676515*^9, 3.500716668003808*^9}, {3.500726091954015*^9, 
   3.500726100928113*^9}, {3.500757524544676*^9, 3.50075765368403*^9}},
 FormatType->"InputForm"],

Cell[BoxData[
 RowBox[{
  RowBox[{"commonS", "[", "sv_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"outer", " ", "rays"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], ",", 
        RowBox[{"s", "[", "2", "]"}], ",", 
        RowBox[{"s", "[", "3", "]"}]}], "}"}], "=", "sv"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "[", "4", "]"}], ",", 
        RowBox[{"s", "[", "5", "]"}], ",", 
        RowBox[{"s", "[", "6", "]"}]}], "}"}], "=", 
      RowBox[{"-", 
       RowBox[{"Array", "[", 
        RowBox[{"s", ",", "3"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"inner", " ", "square"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "[", "7", "]"}], ",", 
        RowBox[{"s", "[", "8", "]"}]}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s", "[", "3", "]"}], ",", 
         RowBox[{"s", "[", "1", "]"}]}], "}"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"s", "[", "1", "]"}], " ", 
          RowBox[{"s", "[", "3", "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "[", "9", "]"}], ",", 
        RowBox[{"s", "[", "10", "]"}]}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "[", "7", "]"}], ",", 
        RowBox[{"s", "[", "8", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", "[", "11", "]"}], "=", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], " ", 
        RowBox[{"s", "[", "3", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "part", " ", "11", " ", "combined", " ", "with", " ", "square"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "[", "12", "]"}], ",", 
        RowBox[{"s", "[", "13", "]"}], ",", 
        RowBox[{"s", "[", "14", "]"}], ",", 
        RowBox[{"s", "[", "15", "]"}]}], "}"}], "=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"s", "[", "11", "]"}], "]"}], " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s", "[", "7", "]"}], ",", 
         RowBox[{"s", "[", "8", "]"}], ",", 
         RowBox[{"s", "[", "9", "]"}], ",", 
         RowBox[{"s", "[", "10", "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "s", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5003863299062557`*^9, 3.500386343303252*^9}, {
  3.500716746020602*^9, 3.500716823089768*^9}, {3.5007168633470078`*^9, 
  3.5007168749674473`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rescaledG", "[", "sv_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", ",", "G", ",", "\[Theta]"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", "=", 
      RowBox[{"commonS", "[", "sv", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "[", 
       RowBox[{"x_", ",", "z_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"8", " ", "I"}], ")"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x"}], "/", "4"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"3", "/", "2"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "3"}], " ", 
          RowBox[{"z", "^", "3"}]}], "-", "z"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"G", "=", 
      RowBox[{"Range", "[", "15", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", "1", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"x", ",", "z"}], "]"}], "]"}]}], ",", "1"}], "}"}]}],
            "}"}], "//", "Evaluate"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{"s", "[", "2", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"x", ",", "z"}], "]"}]}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "//", "Evaluate"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", "3", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"x", ",", "z"}], "]"}], "]"}]}], ",", "1"}], "}"}]}],
            "}"}], "//", "Evaluate"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{"s", "[", "4", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"x", ",", "z"}], "]"}]}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "//", "Evaluate"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "5", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", "5", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"x", ",", "z"}], "]"}], "]"}]}], ",", "1"}], "}"}]}],
            "}"}], "//", "Evaluate"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "6", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{"s", "[", "6", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"x", ",", "z"}], "]"}]}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "//", "Evaluate"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "7", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{"s", "[", "7", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"x", ",", "z"}], "]"}]}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "//", "Evaluate"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "8", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{"s", "[", "8", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"x", ",", "z"}], "]"}]}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "//", "Evaluate"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "9", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", "9", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"x", ",", "z"}], "]"}], "]"}]}], ",", "1"}], "}"}]}],
            "}"}], "//", "Evaluate"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "10", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", "10", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"x", ",", "z"}], "]"}], "]"}]}], ",", "1"}], "}"}]}],
            "}"}], "//", "Evaluate"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "11", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"s", "[", "11", "]"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"1", "/", 
               RowBox[{"s", "[", "11", "]"}]}]}], "}"}]}], "}"}], "//", 
          "Evaluate"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"G", "[", 
        RowBox[{"[", "7", "]"}], "]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"G", "[", 
          RowBox[{"[", "11", "]"}], "]"}], "]"}], "]"}]}], "*)"}], 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "12", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"s", "[", "11", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"s", "[", "12", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"x", ",", "z"}], "]"}]}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"s", "[", "11", "]"}], "]"}]}], "}"}]}], "}"}], "//", 
          "Evaluate"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"G", "[", 
         RowBox[{"[", "11", "]"}], "]"}], "]"}], ".", 
       RowBox[{"G", "[", 
        RowBox[{"[", "8", "]"}], "]"}]}], "*)"}], 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "13", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"s", "[", "11", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"s", "[", "13", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"x", ",", "z"}], "]"}]}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"1", "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"s", "[", "11", "]"}], "]"}]}]}], "}"}]}], "}"}], "//",
           "Evaluate"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Inverse", "[", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"G", "[", 
          RowBox[{"[", "11", "]"}], "]"}], "]"}], "]"}], ".", 
       RowBox[{"G", "[", 
        RowBox[{"[", "9", "]"}], "]"}]}], "*)"}], 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "14", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"s", "[", "11", "]"}], "]"}]}], ",", "0"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", "14", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"x", ",", "z"}], "]"}], "]"}]}], ",", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"s", "[", "11", "]"}], "]"}]}], "}"}]}], "}"}], "//", 
          "Evaluate"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"G", "[", 
        RowBox[{"[", "10", "]"}], "]"}], ".", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"G", "[", 
         RowBox[{"[", "11", "]"}], "]"}], "]"}]}], "*)"}], 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"[", "15", "]"}], "]"}], "=", 
      RowBox[{"jump", "[", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"s", "[", "11", "]"}], "]"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", "15", "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"x", ",", "z"}], "]"}], "]"}]}], ",", 
              RowBox[{"1", "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"s", "[", "11", "]"}], "]"}]}]}], "}"}]}], "}"}], "//",
           "Evaluate"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"G", "=", 
      RowBox[{"Simplify", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "G", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4993711205448074`*^9, 3.4993711235509796`*^9}, {
  3.500716951225646*^9, 3.5007169806468353`*^9}, {3.5007258338645563`*^9, 
  3.5007258497108593`*^9}, {3.500725978023171*^9, 3.500725980981044*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"contourParameters", "[", 
    RowBox[{"sv_", ",", "x_", ",", "tol_"}], "]"}], ":=", 
   RowBox[{"contourParameters", "[", 
    RowBox[{"sv", ",", "x", ",", "tol", ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"contourParameters", "[", 
     RowBox[{"sv_", ",", "x_", ",", "tol_", ",", "xc_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "G", ",", "s", ",", "i", ",", "p", ",", "r", ",", "n", ",", "ct", ",", 
        "cutoff"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "calculates", " ", "the", " ", "contour", " ", "parameters", " ", "p", 
        " ", "and", " ", "n"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"First", " ", "determine", " ", "the", " ", "points", " ", 
         RowBox[{"p", "[", "1", "]"}]}], ",", 
        RowBox[{"p", "[", "3", "]"}], ",", 
        RowBox[{"p", "[", "4", "]"}], ",", 
        RowBox[{"p", "[", "6", "]"}], ",", 
        RowBox[{"p", "[", "7", "]"}], ",", 
        RowBox[{"p", "[", "8", "]"}], ",", 
        RowBox[{
         RowBox[{"p", "[", "9", "]"}], " ", "and", " ", 
         RowBox[{"p", "[", "10", "]"}], " ", "on", " ", "the", " ", "contour",
          " ", "parts", " ", "1"}], ",", "3", ",", "4", ",", "6", ",", "7", 
        ",", "8", ",", 
        RowBox[{
         RowBox[{
         "9", " ", "and", " ", "10", " ", "at", " ", "which", " ", "the", " ",
           "jump", " ", "matrix", " ", "becomes", " ", "numerically", " ", 
          RowBox[{"constant", ".", "\[IndentingNewLine]", "This"}], " ", 
          "means", " ", "that", " ", "the", " ", "off", " ", "diagonal", " ", 
          "elements", " ", "are", " ", "less", " ", "than", " ", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}], " ", "times", " ", "the", " ", "diagonal", 
          " ", 
          RowBox[{"entries", ".", "\[IndentingNewLine]", "The"}], " ", 
          "contour", " ", "parts", " ", "2", " ", "and", " ", "5", " ", "are",
           " ", "ommited", " ", "for", " ", "now", " ", "as", " ", "the", " ",
           "jump", " ", "matrix", " ", "will", " ", "be", " ", "numerically", 
          " ", "constant", " ", "on", " ", "these", " ", "parts", " ", "if", 
          " ", 
          RowBox[{"s", "[", "2", "]"}], " ", "is", " ", "not", " ", "VERY", 
          " ", 
          RowBox[{
          "large", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "At"}], 
          " ", "each", " ", "of", " ", "these", " ", "points", " ", 
          RowBox[{"p", "[", " ", "]"}], " ", "the", " ", "corresponding", " ",
           "contour", " ", "part", " ", "will", " ", "be", " ", "split", " ", 
          "in", " ", "two", " ", 
          RowBox[{"parts", ".", " ", "Doing"}], " ", "so", " ", "ensures", 
          " ", "that", " ", "the", " ", "number", " ", "of", " ", "nodes", 
          " ", "neccessary", " ", "to", " ", "approximate", " ", "the", " ", 
          "functions", " ", "G", " ", "upto", " ", "a", " ", "given", " ", 
          "accuracy", " ", "does", " ", "not", " ", "increase", " ", "for", 
          " ", "x"}], " ", "\[Rule]", " ", 
         RowBox[{"-", 
          RowBox[{"\\", "Infinity"}]}]}]}], "\[IndentingNewLine]", " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cutoff", "=", 
        RowBox[{
         RowBox[{"-", "16"}], " ", 
         RowBox[{"Log", "[", "10", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"commonS", "[", "sv", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Parts", " ", "7"}], ",", "8", ",", 
         RowBox[{"9", " ", "and", " ", "10"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"For", " ", "\\", 
           RowBox[{"Theta", "[", "z_", "]"}]}], ":=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"8", " ", "I"}], ")"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "xc"}], "/", "4"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"3", "/", "2"}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "3"}], " ", 
              RowBox[{"z", "^", "3"}]}], "-", "z"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Root", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"9", " ", 
                 RowBox[{"ct", "^", "2"}]}], "+", 
                RowBox[{"36", " ", 
                 RowBox[{"xc", "^", "3"}], " ", 
                 RowBox[{"#1", "^", "4"}]}], "-", 
                RowBox[{"24", " ", 
                 RowBox[{"xc", "^", "3"}], " ", 
                 RowBox[{"#1", "^", "5"}]}], "+", 
                RowBox[{"4", " ", 
                 RowBox[{"xc", "^", "3"}], " ", 
                 RowBox[{"#1", "^", "6"}]}]}], "&"}], ",", "2"}], "]"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "is", " ", "the", 
            " ", "result", " ", "of", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"Reduce", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Re", "[", 
                 RowBox[{"-", 
                  RowBox[{"\\", 
                   RowBox[{"Theta", "[", 
                    RowBox[{"1", " ", "+", " ", 
                    RowBox[{"z", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "I"}], ")"}]}]}], "]"}]}]}], 
                 "]"}], " ", "\[Equal]", " ", "ct"}], " ", 
               "\[IndentingNewLine]", "&&", " ", 
               RowBox[{"Element", "[", 
                RowBox[{"z", ",", "Reals"}], "]"}], " ", 
               "\[IndentingNewLine]", "&&", " ", 
               RowBox[{"z", ">", "0"}], "\[IndentingNewLine]", "&&", " ", 
               RowBox[{"Element", "[", 
                RowBox[{"xc", ",", "Reals"}], "]"}], " ", 
               "\[IndentingNewLine]", "&&", " ", 
               RowBox[{"xc", "<", "0"}], " ", "\[IndentingNewLine]", "&&", 
               " ", 
               RowBox[{"Element", "[", 
                RowBox[{"ct", ",", "Reals"}], "]"}]}], "\[IndentingNewLine]", 
              ",", "\[IndentingNewLine]", "z"}], "\[IndentingNewLine]", 
             "]"}]}], "//", 
           RowBox[{
           "N", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "and", " ",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Reduce", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Re", "[", 
                 RowBox[{"-", 
                  RowBox[{"\\", 
                   RowBox[{"Theta", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "I"}], ")"}]}]}], "]"}]}]}], "]"}], " ",
                 "\[Equal]", " ", "ct"}], " ", "\[IndentingNewLine]", "&&", 
               " ", 
               RowBox[{"Element", "[", 
                RowBox[{"z", ",", "Reals"}], "]"}], " ", 
               "\[IndentingNewLine]", "&&", " ", 
               RowBox[{"z", ">", "0"}], " ", "\[IndentingNewLine]", "&&", " ", 
               RowBox[{"Element", "[", 
                RowBox[{"xc", ",", "Reals"}], "]"}], " ", 
               "\[IndentingNewLine]", "&&", " ", 
               RowBox[{"xc", "<", "0"}], " ", "\[IndentingNewLine]", "&&", 
               " ", 
               RowBox[{"Element", "[", 
                RowBox[{"ct", ",", "Reals"}], "]"}]}], "\[IndentingNewLine]", 
              ",", "\[IndentingNewLine]", "z"}], "\[IndentingNewLine]", 
             "]"}]}]}], "//", "N"}]}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "[", "7", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Root", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"9", " ", 
               RowBox[{"ct", "^", "2"}]}], "+", 
              RowBox[{"36", " ", 
               RowBox[{"xc", "^", "3"}], " ", 
               RowBox[{"#1", "^", "4"}]}], "-", 
              RowBox[{"24", " ", 
               RowBox[{"xc", "^", "3"}], " ", 
               RowBox[{"#1", "^", "5"}]}], "+", 
              RowBox[{"4", " ", 
               RowBox[{"xc", "^", "3"}], " ", 
               RowBox[{"#1", "^", "6"}]}]}], "&"}], ",", "2"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"ct", "\[Rule]", 
            RowBox[{"cutoff", "-", 
             RowBox[{"Log10", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{"s", "[", "12", "]"}], "]"}], "]"}]}]}], "}"}]}], "//",
          "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "[", "8", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Root", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"9", " ", 
               RowBox[{"ct", "^", "2"}]}], "+", 
              RowBox[{"36", " ", 
               RowBox[{"xc", "^", "3"}], " ", 
               RowBox[{"#1", "^", "4"}]}], "-", 
              RowBox[{"24", " ", 
               RowBox[{"xc", "^", "3"}], " ", 
               RowBox[{"#1", "^", "5"}]}], "+", 
              RowBox[{"4", " ", 
               RowBox[{"xc", "^", "3"}], " ", 
               RowBox[{"#1", "^", "6"}]}]}], "&"}], ",", "2"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"ct", "\[Rule]", 
            RowBox[{"cutoff", "-", 
             RowBox[{"Log10", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{"s", "[", "13", "]"}], "]"}], "]"}]}]}], "}"}]}], "//",
          "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"for", " ", "small", " ", "values", " ", "of", " ", "x", " ", 
          RowBox[{"(", 
           RowBox[{"x", "~", 
            RowBox[{"-", "10"}]}], ")"}], " ", "these", " ", "values", " ", 
          "can", " ", "be", " ", "greater", " ", "than", " ", 
          RowBox[{"1", "/", "2"}]}], ",", 
         RowBox[{"or", " ", "even", " ", "greater", " ", "than", " ", "1"}], 
         ",", 
         RowBox[{
          RowBox[{"which", " ", "is", " ", "not", " ", 
           RowBox[{"allowed", ".", " ", "In"}], " ", "this", " ", "case", " ",
            "we", " ", "set", " ", "them", " ", "just", " ", "to", " ", 
           RowBox[{"1", "/", "2."}], " ", "It", " ", "would", " ", "probably",
            " ", "be", " ", "better", " ", "to", " ", "check", " ", "if", 
           "\[IndentingNewLine]", " ", 
           RowBox[{"i", "[", "7", "]"}]}], " ", "\[GreaterEqual]", " ", 
          RowBox[{"1", "  ", "or", "  ", 
           RowBox[{"i", "[", "8", "]"}]}], " ", "\[GreaterEqual]", " ", 
          RowBox[{
          "1", " ", "\[IndentingNewLine]", "and", " ", "then", " ", "just", 
           " ", "not", " ", "divide", " ", "these", " ", "parts", " ", "of", 
           " ", "the", " ", "contour", " ", "but", " ", "this", " ", "will", 
           " ", "likley", " ", "not", " ", "yield", " ", "a", " ", 
           "significant", " ", "improvment"}]}]}], "\[IndentingNewLine]", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "[", "7", "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"0", "<", 
           RowBox[{"i", "[", "7", "]"}], "<", 
           RowBox[{"1", "/", "2"}]}], ",", 
          RowBox[{"i", "[", "7", "]"}], ",", 
          RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "[", "8", "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"0", "<", 
           RowBox[{"i", "[", "8", "]"}], "<", 
           RowBox[{"1", "/", "2"}]}], ",", 
          RowBox[{"i", "[", "8", "]"}], ",", 
          RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"i", "[", "9", "]"}], " ", "and", " ", 
         RowBox[{"i", "[", "10", "]"}], " ", "follow", " ", "from", " ", 
         "symmertry"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", "9", "]"}], ",", 
          RowBox[{"i", "[", "10", "]"}]}], "}"}], "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", "7", "]"}], ",", 
          RowBox[{"i", "[", "8", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Parts", " ", "1"}], ",", "3", ",", 
         RowBox[{"4", " ", "and", " ", "6"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"For", " ", "\\", 
            RowBox[{"Theta", "[", "z_", "]"}]}], ":=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"8", " ", "I"}], ")"}], " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "xc"}], "/", "4"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"3", "/", "2"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", "3"}], " ", 
               RowBox[{"z", "^", "3"}]}], "-", "z"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Root", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"9", " ", 
                 RowBox[{"ct", "^", "2"}]}], "+", 
                RowBox[{"36", " ", 
                 RowBox[{"xc", "^", "3"}], " ", 
                 RowBox[{"#1", "^", "4"}]}], "+", 
                RowBox[{"24", " ", 
                 RowBox[{"xc", "^", "3"}], " ", 
                 RowBox[{"#1", "^", "5"}]}], "+", 
                RowBox[{"4", " ", 
                 RowBox[{"xc", "^", "3"}], " ", 
                 RowBox[{"#1", "^", "6"}]}]}], "&"}], ",", "2"}], "]"}], 
            "\[IndentingNewLine]", "for", " ", "ct"}], " ", "<", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "8"}], "/", "3"}], " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"-", 
              RowBox[{"xc", "^", "3"}]}], "]"}], " ", "and"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Root", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"9", " ", 
                  RowBox[{"ct", "^", "2"}]}], "+", 
                 RowBox[{"36", " ", 
                  RowBox[{"xc", "^", "3"}], " ", 
                  RowBox[{"#1", "^", "4"}]}], "+", 
                 RowBox[{"24", " ", 
                  RowBox[{"xc", "^", "3"}], " ", 
                  RowBox[{"#1", "^", "5"}]}], "+", 
                 RowBox[{"4", " ", 
                  RowBox[{"xc", "^", "3"}], " ", 
                  RowBox[{"#1", "^", "6"}]}]}], "&"}], ",", "4"}], "]"}], 
             "\[IndentingNewLine]", "for", " ", "ct"}], " ", ">", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "8"}], "/", "3"}], " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"-", 
               RowBox[{"xc", "^", "3"}]}], "]"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "is", " ", "the", " ", "result", " ", 
             "of", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Reduce", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Re", "[", 
                  RowBox[{"\\", 
                   RowBox[{"Theta", "[", 
                    RowBox[{"1", " ", "+", " ", 
                    RowBox[{"z", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "I"}], ")"}]}]}], "]"}]}], "]"}], " ", 
                 "\[Equal]", " ", "ct"}], " ", "\[IndentingNewLine]", "&&", 
                " ", 
                RowBox[{"Element", "[", 
                 RowBox[{"z", ",", "Reals"}], "]"}], " ", 
                "\[IndentingNewLine]", "&&", " ", 
                RowBox[{"z", ">", "0"}], " ", "\[IndentingNewLine]", "&&", 
                " ", 
                RowBox[{"Element", "[", 
                 RowBox[{"x", ",", "Reals"}], "]"}], " ", 
                "\[IndentingNewLine]", "&&", " ", 
                RowBox[{"x", "<", "0"}], " ", "\[IndentingNewLine]", "&&", 
                " ", 
                RowBox[{"Element", "[", 
                 RowBox[{"ct", ",", "Reals"}], "]"}]}], "\[IndentingNewLine]",
                ",", "\[IndentingNewLine]", "z"}], "\[IndentingNewLine]", 
              "]"}]}]}], "//", 
           RowBox[{
           "N", "\[IndentingNewLine]", "\[IndentingNewLine]", "and", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Reduce", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Re", "[", 
                 RowBox[{"-", 
                  RowBox[{"\\", 
                   RowBox[{"Theta", "[", 
                    RowBox[{"1", " ", "+", " ", 
                    RowBox[{"z", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "I"}], ")"}]}]}], "]"}]}]}], "]"}], " ",
                 "\[Equal]", " ", "ct"}], " ", "&&", "\[IndentingNewLine]", 
               RowBox[{"Element", "[", 
                RowBox[{"z", ",", "Reals"}], "]"}], " ", 
               "\[IndentingNewLine]", "&&", " ", 
               RowBox[{"z", ">", "0"}], " ", "\[IndentingNewLine]", "&&", " ", 
               RowBox[{"Element", "[", 
                RowBox[{"x", ",", "Reals"}], "]"}], " ", 
               "\[IndentingNewLine]", "&&", " ", 
               RowBox[{"x", "<", "0"}], " ", "\[IndentingNewLine]", "&&", " ", 
               RowBox[{"Element", "[", 
                RowBox[{"ct", ",", "Reals"}], "]"}]}], "\[IndentingNewLine]", 
              ",", "\[IndentingNewLine]", "z"}], "\[IndentingNewLine]", 
             "]"}]}]}], "//", "N"}]}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "[", "1", "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"cutoff", "-", 
            RowBox[{"Log10", "[", 
             RowBox[{"Abs", "[", 
              RowBox[{"s", "[", "1", "]"}], "]"}], "]"}]}], "<", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "8"}], "/", "3"}], " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"-", 
              RowBox[{"xc", "^", "3"}]}], "]"}]}]}], ",", "2", ",", "4"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "[", "3", "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"cutoff", "-", 
            RowBox[{"Log10", "[", 
             RowBox[{"Abs", "[", 
              RowBox[{"s", "[", "3", "]"}], "]"}], "]"}]}], "<", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "8"}], "/", "3"}], " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"-", 
              RowBox[{"xc", "^", "3"}]}], "]"}]}]}], ",", "2", ",", "4"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "[", "1", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Root", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"9", " ", 
               RowBox[{"ct", "^", "2"}]}], "+", 
              RowBox[{"36", " ", 
               RowBox[{"xc", "^", "3"}], " ", 
               RowBox[{"#1", "^", "4"}]}], "+", 
              RowBox[{"24", " ", 
               RowBox[{"xc", "^", "3"}], " ", 
               RowBox[{"#1", "^", "5"}]}], "+", 
              RowBox[{"4", " ", 
               RowBox[{"xc", "^", "3"}], " ", 
               RowBox[{"#1", "^", "6"}]}]}], "&"}], ",", 
            RowBox[{"r", "[", "1", "]"}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"ct", "\[Rule]", 
            RowBox[{"cutoff", "-", 
             RowBox[{"Log10", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{"s", "[", "1", "]"}], "]"}], "]"}]}]}], "}"}]}], "//", 
         "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "[", "3", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Root", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"9", " ", 
               RowBox[{"ct", "^", "2"}]}], "+", 
              RowBox[{"36", " ", 
               RowBox[{"xc", "^", "3"}], " ", 
               RowBox[{"#1", "^", "4"}]}], "+", 
              RowBox[{"24", " ", 
               RowBox[{"xc", "^", "3"}], " ", 
               RowBox[{"#1", "^", "5"}]}], "+", 
              RowBox[{"4", " ", 
               RowBox[{"xc", "^", "3"}], " ", 
               RowBox[{"#1", "^", "6"}]}]}], "&"}], ",", 
            RowBox[{"r", "[", "3", "]"}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"ct", "\[Rule]", 
            RowBox[{"cutoff", "-", 
             RowBox[{"Log10", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{"s", "[", "3", "]"}], "]"}], "]"}]}]}], "}"}]}], "//", 
         "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"i", "[", "4", "]"}], " ", "and", " ", 
         RowBox[{"i", "[", "6", "]"}], " ", "follow", " ", "from", " ", 
         "symmetry"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", "4", "]"}], ",", 
          RowBox[{"i", "[", "6", "]"}]}], "}"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", "1", "]"}], ",", 
          RowBox[{"i", "[", "3", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"p", " ", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"Null", ",", "10"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"i", "[", "1", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "I"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"i", "[", "4", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", "I"}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"i", "[", "3", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "I"}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "=", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"i", "[", "6", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "I"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "=", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"i", "[", "7", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "I"}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "8", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"i", "[", "8", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "I"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "9", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"i", "[", "9", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "I"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "10", "]"}], "]"}], "=", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"i", "[", "10", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", "I"}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "calculate", " ", "for", " ", "each", " ", "contour", " ", "part", 
         " ", "the", " ", "number", " ", "of", " ", "nodes", " ", 
         "neccessary", " ", "to", " ", "approximate", " ", "G", " ", "upto", 
         " ", "the", " ", "tolerance", " ", "tol"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"G", "=", 
        RowBox[{"rescaledG", "[", "sv", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"Null", ",", "18"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"contour", " ", "parts", " ", "1"}], ",", 
         RowBox[{"2", " ", "and", " ", "3"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "5"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{"Length", " ", "/@", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"IFun", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"G", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"p", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"InterpolationPrecision", "\[Rule]", "tol"}]}], "]"}], 
           ",", 
           RowBox[{"IFun", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"G", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"\[Infinity]", " ", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", " ", 
                   RowBox[{"(", 
                    RowBox[{"\[Pi]", "/", "4"}], ")"}]}], "]"}]}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"InterpolationPrecision", "\[Rule]", "tol"}]}], "]"}], 
           ",", 
           RowBox[{"IFun", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"G", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "I"}], ",", 
                RowBox[{"\[Infinity]", " ", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", " ", 
                   RowBox[{"(", 
                    RowBox[{"\[Pi]", " ", 
                    RowBox[{"2", "/", "4"}]}], ")"}]}], "]"}]}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"InterpolationPrecision", "\[Rule]", "tol"}]}], "]"}], 
           ",", 
           RowBox[{"IFun", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"G", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "[", 
               RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"p", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"InterpolationPrecision", "\[Rule]", "tol"}]}], "]"}], 
           ",", 
           RowBox[{"IFun", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"G", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "[", 
               RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", 
                RowBox[{"\[Infinity]", " ", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", " ", 
                   RowBox[{"(", 
                    RowBox[{"\[Pi]", " ", 
                    RowBox[{"3", "/", "4"}]}], ")"}]}], "]"}]}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"InterpolationPrecision", "\[Rule]", "tol"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "due", " ", "to", " ", "symmetry", " ", "the", " ", "number", " ", 
          "of", " ", "nodes", " ", "for", " ", "the", " ", "parts", " ", 
          "4"}], ",", 
         RowBox[{
         "5", " ", "and", " ", "6", " ", "are", " ", "the", " ", "same", " ", 
          "as", " ", "the", " ", "numbers", " ", "for", " ", "parts", " ", 
          "1"}], ",", " ", 
         RowBox[{"2", " ", "and", " ", "3"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{"[", 
          RowBox[{"6", ";;", "10"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{"n", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "5"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"contour", " ", "parts", " ", "7", " ", "and", " ", "8"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"11", ",", "13"}], "}"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{"Length", " ", "/@", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"IFun", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"G", "[", 
                RowBox[{"[", "12", "]"}], "]"}], "[", 
               RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"p", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"InterpolationPrecision", "\[Rule]", "tol"}]}], "]"}], 
           ",", 
           RowBox[{"IFun", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"G", "[", 
                RowBox[{"[", "13", "]"}], "]"}], "[", 
               RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"p", "[", 
                 RowBox[{"[", "8", "]"}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"InterpolationPrecision", "\[Rule]", "tol"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "On", " ", "the", " ", "second", " ", "subparts", " ", "of", " ", 
          "the", " ", "contour", " ", "parts", " ", "7", " ", "and", " ", "8",
           " ", "the", " ", "function", " ", "G", " ", "is", " ", "almost", 
          " ", "constant", " ", "but", " ", "the", " ", "solution", " ", "is",
           " ", "not", " ", "almost", " ", 
          RowBox[{"constant", ".", " ", "Therefore"}], " ", "we", " ", "have",
           " ", "to", " ", "use", " ", "another", " ", "method", " ", "to", 
          " ", "determine", " ", "the", " ", "number", " ", "of", " ", 
          "nodes", " ", "necessary", " ", "for", " ", "these", " ", 
          RowBox[{"parts", ".", "\[IndentingNewLine]", "For"}], " ", "now", 
          " ", "we", " ", "use", " ", "the", " ", "number", " ", "of", " ", 
          "nodes", " ", "alculated", " ", "for", " ", "the", " ", "other", 
          " ", "subpart", " ", "of", " ", "the", " ", "contour", " ", "parts",
           " ", "7", " ", "and", " ", "8", " ", "but", " ", "with", " ", 
          "x"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"xc", ".", "\[IndentingNewLine]", "THIS"}], " ", "IS", 
            " ", "NOT", " ", "OPTIMAL"}], " ", "..."}], " ", "but", " ", 
          RowBox[{"works", "."}]}]}], "\[IndentingNewLine]", " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"12", ",", "14"}], "}"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{"Length", " ", "/@", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"IFun", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"G", "[", 
                RowBox[{"[", "12", "]"}], "]"}], "[", 
               RowBox[{"xc", ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"p", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"InterpolationPrecision", "\[Rule]", "tol"}]}], "]"}], 
           ",", 
           RowBox[{"IFun", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"G", "[", 
                RowBox[{"[", "13", "]"}], "]"}], "[", 
               RowBox[{"xc", ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"p", "[", 
                 RowBox[{"[", "8", "]"}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"InterpolationPrecision", "\[Rule]", "tol"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "again", " ", "due", " ", "to", " ", "symmetry", " ", "we", " ", "do",
          " ", "not", " ", "have", " ", "to", " ", "calculate", " ", "the", 
         " ", "numbers", " ", "for", " ", "the", " ", "contour", " ", "parts",
          " ", "9", " ", "and", " ", "10"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{"[", 
          RowBox[{"15", ";;", "18"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{"n", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"12", ",", "11", ",", "14", ",", "13"}], "}"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"p", ",", "n"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"contour", "[", 
    RowBox[{"sv_", ",", "x_", ",", "p_List", ",", "n_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"G", ",", "GG"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "generate", " ", "contour", " ", "from", " ", "contour", " ", 
       "parameters", " ", "p", " ", "and", " ", "n"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{"rescaledG", "[", "sv", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"GG", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"p", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"\[Infinity]", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Pi]", "/", "4"}], ")"}]}], "]"}]}]}], "}"}], 
            "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "I"}], ",", 
              RowBox[{"\[Infinity]", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Pi]", " ", 
                   RowBox[{"2", "/", "4"}]}], ")"}]}], "]"}]}]}], "}"}], 
            "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"\[Infinity]", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Pi]", " ", 
                   RowBox[{"3", "/", "4"}]}], ")"}]}], "]"}]}]}], "}"}], 
            "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "4", "]"}], "]"}], ",", 
              RowBox[{"\[Infinity]", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Pi]", " ", 
                   RowBox[{"5", "/", "4"}]}], ")"}]}], "]"}]}]}], "}"}], 
            "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "7", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "5", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "I"}], ",", 
              RowBox[{"\[Infinity]", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Pi]", " ", 
                   RowBox[{"6", "/", "4"}]}], ")"}]}], "]"}]}]}], "}"}], 
            "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "8", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "6", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"p", "[", 
               RowBox[{"[", "6", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "9", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "6", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "6", "]"}], "]"}], ",", 
              RowBox[{"\[Infinity]", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Pi]", " ", 
                   RowBox[{"7", "/", "4"}]}], ")"}]}], "]"}]}]}], "}"}], 
            "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "10", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "12", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"p", "[", 
               RowBox[{"[", "7", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "11", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "12", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "7", "]"}], "]"}], ",", 
              RowBox[{"1", "I"}]}], "}"}], "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "12", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "13", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"[", "8", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "13", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "13", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "8", "]"}], "]"}], ",", 
              RowBox[{"1", "I"}]}], "}"}], "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "14", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "14", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "I"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"[", "9", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "15", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "14", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "9", "]"}], "]"}], ",", 
              RowBox[{"-", "1"}]}], "}"}], "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "16", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "15", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "I"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"[", "10", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "17", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"IFun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"[", "15", "]"}], "]"}], "[", 
             RowBox[{"x", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "10", "]"}], "]"}], ",", "1"}], "}"}], "]"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "18", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "GG", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4993725684296217`*^9, 3.499372580483311*^9}, {
   3.4993727473548555`*^9, 3.4993727574094305`*^9}, {3.500385208996108*^9, 
   3.500385221924312*^9}, 3.500386648332617*^9, {3.500717009865302*^9, 
   3.500717171907525*^9}, {3.500725915966416*^9, 3.5007259396250277`*^9}, {
   3.5007260125476637`*^9, 3.5007260433374243`*^9}, 3.5007260785938673`*^9, {
   3.500726233093761*^9, 3.5007262866271067`*^9}, {3.500726318525856*^9, 
   3.500726395397442*^9}, {3.50072646062204*^9, 3.500726541047042*^9}, {
   3.500726665690819*^9, 3.500726712034698*^9}, {3.5007276613472757`*^9, 
   3.500727872584736*^9}, {3.500755009676466*^9, 3.50075520517258*^9}, {
   3.500755270669587*^9, 3.5007552902183247`*^9}, {3.500755328272111*^9, 
   3.500755338290678*^9}, {3.500755640507856*^9, 3.5007559135365868`*^9}, {
   3.500756006990374*^9, 3.500756157942111*^9}, {3.500756270402605*^9, 
   3.500756318871764*^9}, {3.500756360549993*^9, 3.5007563996408033`*^9}, {
   3.5007566761847067`*^9, 3.500756979069253*^9}, {3.5007570200486183`*^9, 
   3.500757332540681*^9}, {3.500757735052403*^9, 3.500757770192059*^9}, {
   3.500792700412772*^9, 3.5007927234082403`*^9}, {3.500792789989167*^9, 
   3.500792903011779*^9}, {3.500792986858239*^9, 3.500792992968038*^9}, {
   3.500793263030279*^9, 3.5007933194523907`*^9}, {3.500793414154405*^9, 
   3.5007934884484787`*^9}, {3.500793518962326*^9, 3.500793542451961*^9}, {
   3.5007936057336073`*^9, 3.500793626851314*^9}, {3.500793738682238*^9, 
   3.500793761592882*^9}, {3.500795289220252*^9, 3.5007953221257343`*^9}, {
   3.500795404635849*^9, 3.500795408929199*^9}, {3.500802053591947*^9, 
   3.500802061596273*^9}, {3.500802162310524*^9, 3.5008022028428793`*^9}, {
   3.50080233129326*^9, 3.500802420545669*^9}, {3.5008032233457003`*^9, 
   3.500803409431027*^9}, {3.500803510906896*^9, 3.5008035248532267`*^9}, {
   3.5008036087267237`*^9, 3.50080365536646*^9}, {3.5008037027540913`*^9, 
   3.500803732506772*^9}, {3.500804064773574*^9, 3.5008041517680283`*^9}, {
   3.500804226003626*^9, 3.500804396072904*^9}, {3.500804430941584*^9, 
   3.500804536322229*^9}, {3.5008045785926*^9, 3.5008046456482067`*^9}, {
   3.5008051666543713`*^9, 3.500805170520216*^9}, {3.500813082949924*^9, 
   3.5008131221702757`*^9}, {3.500813373023041*^9, 3.500813394981759*^9}, {
   3.500813601395488*^9, 3.500813663471393*^9}, 3.500814466074699*^9, {
   3.500815000541705*^9, 3.5008150094870863`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"contour", "[", 
   RowBox[{"sv_", ",", "x_", ",", "tol_", ",", "xc_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", "n"}], "}"}], " ", "=", " ", 
      RowBox[{"contourParameters", "[", 
       RowBox[{"sv", ",", "x", ",", "tol", ",", "xc"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", " ", 
      RowBox[{"contour", "[", 
       RowBox[{"sv", ",", "x", ",", "p", ",", "n"}], "]"}], " ", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5008024316586647`*^9, 3.500802547349834*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cacheRHSolver", "[", 
    RowBox[{"contour", ",", "s_", ",", "tol_", ",", "xl_", ",", "xu_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cf", ",", "rhsol", ",", "p", ",", "n"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p", ",", "n"}], "}"}], "=", 
       RowBox[{"contourParameters", "[", 
        RowBox[{"s", ",", "xu", ",", "tol", ",", "xl"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cf", " ", "=", 
       RowBox[{"contour", "[", 
        RowBox[{"s", ",", "xu", ",", "p", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rhsol", "=", 
       RowBox[{"RHSolverTop", "[", "cf", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"cacheRHSolver", "[", 
        RowBox[{
        "rhsol", ",", "contour", ",", "s", ",", "p", ",", "n", ",", "xl", ",",
          "xu"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cacheRHSolver", "[", 
     RowBox[{
     "rhsol_RHSolverTop", ",", "contour", ",", "s_", ",", "p_", ",", "n_", 
      ",", "xl_", ",", "xu_"}], "]"}], "[", "x_", "]"}], ":=", 
   RowBox[{"rhsol", "[", 
    RowBox[{"contour", "[", 
     RowBox[{"s", ",", "x", ",", "p", ",", "n"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5003825810560102`*^9, 3.500382597627605*^9}, {
   3.500384519625739*^9, 3.500384555769011*^9}, {3.50081378632115*^9, 
   3.500813907828024*^9}, {3.5008139500663757`*^9, 3.500814026802122*^9}, {
   3.500814075355011*^9, 3.5008140934148912`*^9}, {3.500815511968647*^9, 
   3.500815512453451*^9}, 3.500820166574995*^9, {3.500820203857729*^9, 
   3.5008202053377943`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cachePiiSolver", "[", 
    RowBox[{"c_", ",", "s_", ",", "tol_", ",", "xl_", ",", "xu_"}], "]"}], ":=", 
   RowBox[{"cachePiiSolver", "[", 
    RowBox[{"cacheRHSolver", "[", 
     RowBox[{"c", ",", "s", ",", "tol", ",", "xl", ",", "xu"}], "]"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"cachePiiSolver", "[", "crhsol_cacheRHSolver", "]"}], "[", "x_", 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"\[Pi]", " ", "I"}], ")"}]}], ")"}]}], " ", 
     RowBox[{
      RowBox[{"DomainIntegrate", "[", 
       RowBox[{"crhsol", "[", "x", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"-", "x"}], "/", "4"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cachedRHSolver", "[", 
     RowBox[{"c_", ",", "s_", ",", "tol_", ",", "xl_", ",", "xu__"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"cachedRHSolver", "[", 
      RowBox[{"c", ",", "s", ",", "tol", ",", "xl", ",", "xu"}], "]"}], "=", 
     RowBox[{"cacheRHSolver", "[", 
      RowBox[{"c", ",", "s", ",", "tol", ",", "xl", ",", "xu"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cachedPiiSolver", "[", 
     RowBox[{"c_", ",", "s_", ",", "tol_", ",", "xs_", ",", "xi_"}], "]"}], 
    "[", "x_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", "xs"}], ")"}], "/", "xi"}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"cachePiiSolver", "[", 
       RowBox[{"cachedRHSolver", "[", 
        RowBox[{"c", ",", "s", ",", "tol", ",", 
         RowBox[{"xs", "+", 
          RowBox[{"k", " ", "xi"}]}], ",", 
         RowBox[{"xs", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k", "+", "1"}], ")"}], " ", "xi"}]}]}], "]"}], "]"}], 
      "[", "x", "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.500384390512433*^9, 3.500384397641572*^9}, {
   3.500384468565942*^9, 3.500384484092811*^9}, {3.500384570842218*^9, 
   3.500384575306183*^9}, 3.5008199944677563`*^9, {3.500820061295774*^9, 
   3.500820082823214*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Options", "[", "PainleveIINegativeContour2", "]"}], "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"InterpolationPrecision", "\[Rule]", 
     RowBox[{"10", "^", 
      RowBox[{"-", "7"}]}]}], ",", 
    RowBox[{"CacheIntervalLength", "\[Rule]", 
     RowBox[{"-", "10"}]}], ",", 
    RowBox[{"CacheIntervalShift", "\[Rule]", 
     RowBox[{"-", "5"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PainleveIINegativeContour2", "[", 
    RowBox[{"s_", ",", "x_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tol", "=", 
        RowBox[{"OptionValue", "[", "InterpolationPrecision", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"xs", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "CacheIntervalShift", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"xi", "=", 
        RowBox[{"OptionValue", "[", "CacheIntervalLength", "]"}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cachedPiiSolver", "[", 
       RowBox[{"contour", ",", "s", ",", "tol", ",", "xs", ",", "xi"}], "]"}],
       "[", "x", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.500371365618986*^9, 3.500371371867375*^9}, {
   3.5003714131055307`*^9, 3.500371456688835*^9}, {3.500371586823407*^9, 
   3.500371662442526*^9}, {3.500371903202846*^9, 3.500371933082992*^9}, {
   3.500372150361816*^9, 3.500372340156146*^9}, 3.50037561369556*^9, {
   3.500382264896367*^9, 3.500382266158379*^9}, 3.500382878362349*^9, {
   3.5003843542291727`*^9, 3.500384354385096*^9}, {3.500814238289722*^9, 
   3.50081423914958*^9}, {3.500818635948565*^9, 3.5008186369266357`*^9}, {
   3.5008188750503817`*^9, 3.500818876886475*^9}, {3.5008193694821577`*^9, 
   3.5008193713014793`*^9}, {3.500819560745625*^9, 3.500819561735327*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"listCachedRHSolver", "[", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"DownValues", "[", "cachedRHSolver", "]"}], "/.", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t_", "\[RuleDelayed]", "_"}], ")"}], "\[RuleDelayed]", 
        "t"}]}], "/.", 
      RowBox[{"HoldPattern", "\[Rule]", "Hold"}]}], ",", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Hold", "[", 
         RowBox[{"cachedRHSolver", "[", 
          RowBox[{"_", ",", "_List", ",", 
           RowBox[{"__", "?", "NumberQ"}]}], "]"}], "]"}]}], "]"}], "&"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"clearCachedRHSolver", "[", "]"}], ":=", 
   RowBox[{"Unset", "@@@", 
    RowBox[{"listCachedRHSolver", "[", "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.500391447660728*^9, 3.500391448689019*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.500368910882448*^9, 3.50036893066332*^9}, {
  3.500376674509932*^9, 3.50037672149925*^9}, {3.500381050278019*^9, 
  3.500381050551321*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{760, 1127},
WindowMargins->{{Automatic, 375}, {Automatic, 0}},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 155, 4, 41, "Text"],
Cell[703, 26, 1471, 30, 73, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[2199, 60, 183, 3, 67, "Section",
 InitializationCell->True],
Cell[2385, 65, 128, 3, 27, "Input",
 InitializationCell->True],
Cell[2516, 70, 836, 27, 43, "Input",
 InitializationCell->True],
Cell[3355, 99, 9856, 227, 1023, "Input",
 InitializationCell->True],
Cell[13214, 328, 2992, 84, 193, "Input",
 InitializationCell->True],
Cell[16209, 414, 14482, 414, 538, "Input",
 InitializationCell->True],
Cell[30694, 830, 50671, 1228, 2953, "Input",
 InitializationCell->True],
Cell[81368, 2060, 784, 20, 73, "Input",
 InitializationCell->True],
Cell[82155, 2082, 1887, 47, 148, "Input",
 InitializationCell->True],
Cell[84045, 2131, 2436, 69, 163, "Input",
 InitializationCell->True],
Cell[86484, 2202, 2068, 45, 163, "Input",
 InitializationCell->True],
Cell[88555, 2249, 986, 28, 88, "Input",
 InitializationCell->True],
Cell[89544, 2279, 258, 6, 27, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
